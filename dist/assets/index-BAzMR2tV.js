import{r as h,a as Zr,b as Zo,R as Qe,u as Ue,L as G,d as Oa,e as el,f as tl,h as en,O as sl,B as rl,i as nl,j as V,N as As}from"./react-vendor-CXHUhyzA.js";import{c as al,S as il,T as ol}from"./supabase-vendor-BTNrQgA4.js";import{L as Fa,R as Vt,B as Ve,E as Q,a as Oe,P as Fe,X as de,b as B,S as Ne,C as ce,c as Z,d as Ma,e as Ze,A as fe,f as Le,g as Ct,F as he,V as Js,h as tn,i as mr,j as ur,k as Ms,l as rt,m as ll,n as cl,o as dl,T as sn,p as Qt,q as ml,r as $a,G as ul,M as Ee,U as xe,s as ut,t as La,u as hl,v as Er,w as xl,x as Ar,y as fl,z as Ge,D as gl,H as rn,I as pl,K as Pr,J as yl,N as bl,O as Zt,Q as wl,W as jl,Y as Ir,Z as $s,_ as nn,$ as wt,a0 as Gn,a1 as vl,a2 as Nl,a3 as _l,a4 as Ba,a5 as kl,a6 as Cl,a7 as Sl,a8 as Vn,a9 as Ua,aa as an,ab as qa,ac as on,ad as Ye,ae as ln,af as Wa,ag as El,ah as Al,ai as Jn,aj as Pl,ak as Il,al as Rl,am as cn,an as Tl,ao as Xn,ap as Yn,aq as Dl,ar as Ls,as as Kn,at as Ol,au as Fl,av as Ml,aw as hs,ax as $l,ay as Ll,az as Bl,aA as Ul,aB as ql}from"./lucide-vendor-BK9VGmw_.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Ha={exports:{}},Xs={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wl=h,Hl=Symbol.for("react.element"),zl=Symbol.for("react.fragment"),Gl=Object.prototype.hasOwnProperty,Vl=Wl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Jl={key:!0,ref:!0,__self:!0,__source:!0};function za(s,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)Gl.call(t,n)&&!Jl.hasOwnProperty(n)&&(a[n]=t[n]);if(s&&s.defaultProps)for(n in t=s.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Hl,type:s,key:i,ref:o,props:a,_owner:Vl.current}}Xs.Fragment=zl;Xs.jsx=za;Xs.jsxs=za;Ha.exports=Xs;var e=Ha.exports,Ga,Qn=Zr;Ga=Qn.createRoot,Qn.hydrateRoot;const Xl="https://tipqicrwlccqicjgobde.supabase.co",Yl="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRpcHFpY3J3bGNjcWljamdvYmRlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk1NDM1MzMsImV4cCI6MjA1NTExOTUzM30.TjD-GY-6eydjAyFjlRFFQoUBXoNpF3fZwe47lHICRAY",R=al(Xl,Yl),Kl={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_GOOGLE_CLIENT_ID:"your-google-client-id",VITE_GOOGLE_CLIENT_SECRET:"your-google-client-secret",VITE_GOOGLE_REDIRECT_URI:"http://localhost:5173/auth/google/callback",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRpcHFpY3J3bGNjcWljamdvYmRlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk1NDM1MzMsImV4cCI6MjA1NTExOTUzM30.TjD-GY-6eydjAyFjlRFFQoUBXoNpF3fZwe47lHICRAY",VITE_SUPABASE_URL:"https://tipqicrwlccqicjgobde.supabase.co"},Zn=s=>{let t;const r=new Set,n=(g,u)=>{const p=typeof g=="function"?g(t):g;if(!Object.is(p,t)){const d=t;t=u??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(y=>y(t,d))}},a=()=>t,m={setState:n,getState:a,getInitialState:()=>c,subscribe:g=>(r.add(g),()=>r.delete(g)),destroy:()=>{(Kl?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},c=t=s(n,a,m);return m},Ql=s=>s?Zn(s):Zn;var Va={exports:{}},Ja={},Xa={exports:{}},Ya={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var St=h;function Zl(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var ec=typeof Object.is=="function"?Object.is:Zl,tc=St.useState,sc=St.useEffect,rc=St.useLayoutEffect,nc=St.useDebugValue;function ac(s,t){var r=t(),n=tc({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return rc(function(){a.value=r,a.getSnapshot=t,hr(a)&&i({inst:a})},[s,r,t]),sc(function(){return hr(a)&&i({inst:a}),s(function(){hr(a)&&i({inst:a})})},[s]),nc(r),r}function hr(s){var t=s.getSnapshot;s=s.value;try{var r=t();return!ec(s,r)}catch{return!0}}function ic(s,t){return t()}var oc=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ic:ac;Ya.useSyncExternalStore=St.useSyncExternalStore!==void 0?St.useSyncExternalStore:oc;Xa.exports=Ya;var lc=Xa.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ys=h,cc=lc;function dc(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var mc=typeof Object.is=="function"?Object.is:dc,uc=cc.useSyncExternalStore,hc=Ys.useRef,xc=Ys.useEffect,fc=Ys.useMemo,gc=Ys.useDebugValue;Ja.useSyncExternalStoreWithSelector=function(s,t,r,n,a){var i=hc(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=fc(function(){function m(d){if(!c){if(c=!0,g=d,d=n(d),a!==void 0&&o.hasValue){var y=o.value;if(a(y,d))return u=y}return u=d}if(y=u,mc(g,d))return y;var b=n(d);return a!==void 0&&a(y,b)?(g=d,y):(g=d,u=b)}var c=!1,g,u,p=r===void 0?null:r;return[function(){return m(t())},p===null?void 0:function(){return m(p())}]},[t,r,n,a]);var l=uc(s,i[0],i[1]);return xc(function(){o.hasValue=!0,o.value=l},[l]),gc(l),l};Va.exports=Ja;var pc=Va.exports;const yc=Zo(pc),Ka={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_GOOGLE_CLIENT_ID:"your-google-client-id",VITE_GOOGLE_CLIENT_SECRET:"your-google-client-secret",VITE_GOOGLE_REDIRECT_URI:"http://localhost:5173/auth/google/callback",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRpcHFpY3J3bGNjcWljamdvYmRlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk1NDM1MzMsImV4cCI6MjA1NTExOTUzM30.TjD-GY-6eydjAyFjlRFFQoUBXoNpF3fZwe47lHICRAY",VITE_SUPABASE_URL:"https://tipqicrwlccqicjgobde.supabase.co"},{useDebugValue:bc}=Qe,{useSyncExternalStoreWithSelector:wc}=yc;let ea=!1;const jc=s=>s;function vc(s,t=jc,r){(Ka?"production":void 0)!=="production"&&r&&!ea&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),ea=!0);const n=wc(s.subscribe,s.getState,s.getServerState||s.getInitialState,t,r);return bc(n),n}const ta=s=>{(Ka?"production":void 0)!=="production"&&typeof s!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof s=="function"?Ql(s):s,r=(n,a)=>vc(t,n,a);return Object.assign(r,t),r},Nc=s=>s?ta(s):ta,X=Nc(s=>({user:null,profile:null,isAdmin:!1,isSuperAdmin:!1,setUser:t=>s({user:t}),setProfile:t=>s({profile:t,isAdmin:(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin",isSuperAdmin:(t==null?void 0:t.role)==="superadmin"}),fetchProfile:async t=>{var r;try{const{data:n,error:a}=await R.from("profiles").select("*").eq("id",t).maybeSingle();if(a&&a.code!=="PGRST116"){console.error("Error fetching profile:",a);return}if(n)s({profile:n,isAdmin:n.role==="admin"||n.role==="superadmin",isSuperAdmin:n.role==="superadmin"});else{const{data:i,error:o}=await R.from("profiles").insert([{id:t,email:(r=(await R.auth.getUser()).data.user)==null?void 0:r.email,role:"user",allows_messages:!0,is_public:!0}]).select().single();if(o){console.error("Error creating profile:",o);return}i&&s({profile:i,isAdmin:!1,isSuperAdmin:!1})}}catch(n){console.error("Error in fetchProfile:",n)}},signOut:async()=>{await R.auth.signOut(),s({user:null,profile:null,isAdmin:!1,isSuperAdmin:!1})}}));function _c(){const s=Ue(),{user:t}=X();return Qe.useEffect(()=>{t&&s("/dashboard")},[t,s]),e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(Fa,{className:"h-12 w-12 text-indigo-600"})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"})]}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsx("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:e.jsx(il,{supabaseClient:R,appearance:{theme:ol},providers:["google"],redirectTo:`${window.location.origin}/dashboard`,theme:"default"})})})]})}const Rr="RFC3986",Tr={RFC1738:s=>String(s).replace(/%20/g,"+"),RFC3986:s=>String(s)},kc="RFC1738",Cc=Array.isArray,Ie=(()=>{const s=[];for(let t=0;t<256;++t)s.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return s})(),xr=1024,Sc=(s,t,r,n,a)=>{if(s.length===0)return s;let i=s;if(typeof s=="symbol"?i=Symbol.prototype.toString.call(s):typeof s!="string"&&(i=String(s)),r==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let o="";for(let l=0;l<i.length;l+=xr){const m=i.length>=xr?i.slice(l,l+xr):i,c=[];for(let g=0;g<m.length;++g){let u=m.charCodeAt(g);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||a===kc&&(u===40||u===41)){c[c.length]=m.charAt(g);continue}if(u<128){c[c.length]=Ie[u];continue}if(u<2048){c[c.length]=Ie[192|u>>6]+Ie[128|u&63];continue}if(u<55296||u>=57344){c[c.length]=Ie[224|u>>12]+Ie[128|u>>6&63]+Ie[128|u&63];continue}g+=1,u=65536+((u&1023)<<10|m.charCodeAt(g)&1023),c[c.length]=Ie[240|u>>18]+Ie[128|u>>12&63]+Ie[128|u>>6&63]+Ie[128|u&63]}o+=c.join("")}return o};function Ec(s){return!s||typeof s!="object"?!1:!!(s.constructor&&s.constructor.isBuffer&&s.constructor.isBuffer(s))}function sa(s,t){if(Cc(s)){const r=[];for(let n=0;n<s.length;n+=1)r.push(t(s[n]));return r}return t(s)}const Ac=Object.prototype.hasOwnProperty,Qa={brackets(s){return String(s)+"[]"},comma:"comma",indices(s,t){return String(s)+"["+t+"]"},repeat(s){return String(s)}},Te=Array.isArray,Pc=Array.prototype.push,Za=function(s,t){Pc.apply(s,Te(t)?t:[t])},Ic=Date.prototype.toISOString,se={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Sc,encodeValuesOnly:!1,format:Rr,formatter:Tr[Rr],indices:!1,serializeDate(s){return Ic.call(s)},skipNulls:!1,strictNullHandling:!1};function Rc(s){return typeof s=="string"||typeof s=="number"||typeof s=="boolean"||typeof s=="symbol"||typeof s=="bigint"}const fr={};function ei(s,t,r,n,a,i,o,l,m,c,g,u,p,d,y,b,x,v){let w=s,_=v,j=0,f=!1;for(;(_=_.get(fr))!==void 0&&!f;){const I=_.get(s);if(j+=1,typeof I<"u"){if(I===j)throw new RangeError("Cyclic object value");f=!0}typeof _.get(fr)>"u"&&(j=0)}if(typeof c=="function"?w=c(t,w):w instanceof Date?w=p==null?void 0:p(w):r==="comma"&&Te(w)&&(w=sa(w,function(I){return I instanceof Date?p==null?void 0:p(I):I})),w===null){if(i)return m&&!b?m(t,se.encoder,x,"key",d):t;w=""}if(Rc(w)||Ec(w)){if(m){const I=b?t:m(t,se.encoder,x,"key",d);return[(y==null?void 0:y(I))+"="+(y==null?void 0:y(m(w,se.encoder,x,"value",d)))]}return[(y==null?void 0:y(t))+"="+(y==null?void 0:y(String(w)))]}const S=[];if(typeof w>"u")return S;let N;if(r==="comma"&&Te(w))b&&m&&(w=sa(w,m)),N=[{value:w.length>0?w.join(",")||null:void 0}];else if(Te(c))N=c;else{const I=Object.keys(w);N=g?I.sort(g):I}const O=l?String(t).replace(/\./g,"%2E"):String(t),T=n&&Te(w)&&w.length===1?O+"[]":O;if(a&&Te(w)&&w.length===0)return T+"[]";for(let I=0;I<N.length;++I){const P=N[I],C=typeof P=="object"&&typeof P.value<"u"?P.value:w[P];if(o&&C===null)continue;const k=u&&l?P.replace(/\./g,"%2E"):P,E=Te(w)?typeof r=="function"?r(T,k):T:T+(u?"."+k:"["+k+"]");v.set(s,j);const A=new WeakMap;A.set(fr,v),Za(S,ei(C,E,r,n,a,i,o,l,r==="comma"&&b&&Te(w)?null:m,c,g,u,p,d,y,b,x,A))}return S}function Tc(s=se){if(typeof s.allowEmptyArrays<"u"&&typeof s.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof s.encodeDotInKeys<"u"&&typeof s.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(s.encoder!==null&&typeof s.encoder<"u"&&typeof s.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=s.charset||se.charset;if(typeof s.charset<"u"&&s.charset!=="utf-8"&&s.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let r=Rr;if(typeof s.format<"u"){if(!Ac.call(Tr,s.format))throw new TypeError("Unknown format option provided.");r=s.format}const n=Tr[r];let a=se.filter;(typeof s.filter=="function"||Te(s.filter))&&(a=s.filter);let i;if(s.arrayFormat&&s.arrayFormat in Qa?i=s.arrayFormat:"indices"in s?i=s.indices?"indices":"repeat":i=se.arrayFormat,"commaRoundTrip"in s&&typeof s.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof s.allowDots>"u"?s.encodeDotInKeys?!0:se.allowDots:!!s.allowDots;return{addQueryPrefix:typeof s.addQueryPrefix=="boolean"?s.addQueryPrefix:se.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof s.allowEmptyArrays=="boolean"?!!s.allowEmptyArrays:se.allowEmptyArrays,arrayFormat:i,charset:t,charsetSentinel:typeof s.charsetSentinel=="boolean"?s.charsetSentinel:se.charsetSentinel,commaRoundTrip:!!s.commaRoundTrip,delimiter:typeof s.delimiter>"u"?se.delimiter:s.delimiter,encode:typeof s.encode=="boolean"?s.encode:se.encode,encodeDotInKeys:typeof s.encodeDotInKeys=="boolean"?s.encodeDotInKeys:se.encodeDotInKeys,encoder:typeof s.encoder=="function"?s.encoder:se.encoder,encodeValuesOnly:typeof s.encodeValuesOnly=="boolean"?s.encodeValuesOnly:se.encodeValuesOnly,filter:a,format:r,formatter:n,serializeDate:typeof s.serializeDate=="function"?s.serializeDate:se.serializeDate,skipNulls:typeof s.skipNulls=="boolean"?s.skipNulls:se.skipNulls,sort:typeof s.sort=="function"?s.sort:null,strictNullHandling:typeof s.strictNullHandling=="boolean"?s.strictNullHandling:se.strictNullHandling}}function Dc(s,t={}){let r=s;const n=Tc(t);let a,i;typeof n.filter=="function"?(i=n.filter,r=i("",r)):Te(n.filter)&&(i=n.filter,a=i);const o=[];if(typeof r!="object"||r===null)return"";const l=Qa[n.arrayFormat],m=l==="comma"&&n.commaRoundTrip;a||(a=Object.keys(r)),n.sort&&a.sort(n.sort);const c=new WeakMap;for(let p=0;p<a.length;++p){const d=a[p];n.skipNulls&&r[d]===null||Za(o,ei(r[d],d,l,m,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,c))}const g=o.join(n.delimiter);let u=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),g.length>0?u+g:""}const pt="4.85.1";let ra=!1,zt,ti,si,Dr,ri,ni,ai,ii,oi;function Oc(s,t={auto:!1}){if(ra)throw new Error(`you must \`import 'openai/shims/${s.kind}'\` before importing anything else from openai`);if(zt)throw new Error(`can't \`import 'openai/shims/${s.kind}'\` after \`import 'openai/shims/${zt}'\``);ra=t.auto,zt=s.kind,ti=s.fetch,si=s.FormData,Dr=s.File,ri=s.ReadableStream,ni=s.getMultipartRequestOptions,ai=s.getDefaultAgent,ii=s.fileFromPath,oi=s.isFsReadStream}class Fc{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}function Mc({manuallyImported:s}={}){const t=s?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let r,n,a,i;try{r=fetch,n=Request,a=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${t}`)}return{kind:"web",fetch:r,Request:n,Response:a,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new Fc(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}zt||Oc(Mc(),{auto:!0});class W extends Error{}class oe extends W{constructor(t,r,n,a){super(`${oe.makeMessage(t,r,n)}`),this.status=t,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=r;const i=r;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(t,r,n){const a=r!=null&&r.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,r,n,a){if(!t||!a)return new Ks({message:n,cause:Fr(r)});const i=r==null?void 0:r.error;return t===400?new li(t,i,n,a):t===401?new ci(t,i,n,a):t===403?new di(t,i,n,a):t===404?new mi(t,i,n,a):t===409?new ui(t,i,n,a):t===422?new hi(t,i,n,a):t===429?new xi(t,i,n,a):t>=500?new fi(t,i,n,a):new oe(t,i,n,a)}}class Ce extends oe{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class Ks extends oe{constructor({message:t,cause:r}){super(void 0,void 0,t||"Connection error.",void 0),r&&(this.cause=r)}}class dn extends Ks{constructor({message:t}={}){super({message:t??"Request timed out."})}}class li extends oe{}class ci extends oe{}class di extends oe{}class mi extends oe{}class ui extends oe{}class hi extends oe{}class xi extends oe{}class fi extends oe{}class gi extends W{constructor(){super("Could not parse response content as the length limit was reached")}}class pi extends W{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var xs=function(s,t,r,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?s!==t||!a:!t.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(s,r):a?a.value=r:t.set(s,r),r},ot=function(s,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?s!==t||!n:!t.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(s):n?n.value:t.get(s)},pe;class Qs{constructor(){pe.set(this,void 0),this.buffer=new Uint8Array,xs(this,pe,null,"f")}decode(t){if(t==null)return[];const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let n=new Uint8Array(this.buffer.length+r.length);n.set(this.buffer),n.set(r,this.buffer.length),this.buffer=n;const a=[];let i;for(;(i=$c(this.buffer,ot(this,pe,"f")))!=null;){if(i.carriage&&ot(this,pe,"f")==null){xs(this,pe,i.index,"f");continue}if(ot(this,pe,"f")!=null&&(i.index!==ot(this,pe,"f")+1||i.carriage)){a.push(this.decodeText(this.buffer.slice(0,ot(this,pe,"f")-1))),this.buffer=this.buffer.slice(ot(this,pe,"f")),xs(this,pe,null,"f");continue}const o=ot(this,pe,"f")!==null?i.preceding-1:i.preceding,l=this.decodeText(this.buffer.slice(0,o));a.push(l),this.buffer=this.buffer.slice(i.index),xs(this,pe,null,"f")}return a}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof Buffer<"u"){if(t instanceof Buffer)return t.toString();if(t instanceof Uint8Array)return Buffer.from(t).toString();throw new W(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new W(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new W("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}pe=new WeakMap;Qs.NEWLINE_CHARS=new Set([`
`,"\r"]);Qs.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function $c(s,t){for(let a=t??0;a<s.length;a++){if(s[a]===10)return{preceding:a,index:a+1,carriage:!1};if(s[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function yi(s){if(s[Symbol.asyncIterator])return s;const t=s.getReader();return{async next(){try{const r=await t.read();return r!=null&&r.done&&t.releaseLock(),r}catch(r){throw t.releaseLock(),r}},async return(){const r=t.cancel();return t.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class Me{constructor(t,r){this.iterator=t,this.controller=r}static fromSSEResponse(t,r){let n=!1;async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const o of Lc(t,r))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null){let l;try{l=JSON.parse(o.data)}catch(m){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),m}if(l&&l.error)throw new oe(void 0,l.error,void 0,void 0);yield l}else{let l;try{l=JSON.parse(o.data)}catch(m){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),m}if(o.event=="error")throw new oe(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||r.abort()}}return new Me(a,r)}static fromReadableStream(t,r){let n=!1;async function*a(){const o=new Qs,l=yi(t);for await(const m of l)for(const c of o.decode(m))yield c;for(const m of o.flush())yield m}async function*i(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let o=!1;try{for await(const l of a())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||r.abort()}}return new Me(i,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],r=[],n=this.iterator(),a=i=>({next:()=>{if(i.length===0){const o=n.next();t.push(o),r.push(o)}return i.shift()}});return[new Me(()=>a(t),this.controller),new Me(()=>a(r),this.controller)]}toReadableStream(){const t=this;let r;const n=new TextEncoder;return new ri({async start(){r=t[Symbol.asyncIterator]()},async pull(a){try{const{value:i,done:o}=await r.next();if(o)return a.close();const l=n.encode(JSON.stringify(i)+`
`);a.enqueue(l)}catch(i){a.error(i)}},async cancel(){var a;await((a=r.return)==null?void 0:a.call(r))}})}}async function*Lc(s,t){if(!s.body)throw t.abort(),new W("Attempted to iterate over a response with no body");const r=new qc,n=new Qs,a=yi(s.body);for await(const i of Bc(a))for(const o of n.decode(i)){const l=r.decode(o);l&&(yield l)}for(const i of n.flush()){const o=r.decode(i);o&&(yield o)}}async function*Bc(s){let t=new Uint8Array;for await(const r of s){if(r==null)continue;const n=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r;let a=new Uint8Array(t.length+n.length);a.set(t),a.set(n,t.length),t=a;let i;for(;(i=Uc(t))!==-1;)yield t.slice(0,i),t=t.slice(i)}t.length>0&&(yield t)}function Uc(s){for(let n=0;n<s.length-2;n++){if(s[n]===10&&s[n+1]===10||s[n]===13&&s[n+1]===13)return n+2;if(s[n]===13&&s[n+1]===10&&n+3<s.length&&s[n+2]===13&&s[n+3]===10)return n+4}return-1}class qc{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(t),t.startsWith(":"))return null;let[r,n,a]=Wc(t,":");return a.startsWith(" ")&&(a=a.substring(1)),r==="event"?this.event=a:r==="data"&&this.data.push(a),null}}function Wc(s,t){const r=s.indexOf(t);return r!==-1?[s.substring(0,r),t,s.substring(r+t.length)]:[s,"",""]}const bi=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function",wi=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&Zs(s),Zs=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",Hc=s=>wi(s)||bi(s)||oi(s);async function ji(s,t,r){var a;if(s=await s,wi(s))return s;if(bi(s)){const i=await s.blob();t||(t=new URL(s.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=Zs(i)?[await i.arrayBuffer()]:[i];return new Dr(o,t,r)}const n=await zc(s);if(t||(t=Vc(s)??"unknown_file"),!(r!=null&&r.type)){const i=(a=n[0])==null?void 0:a.type;typeof i=="string"&&(r={...r,type:i})}return new Dr(n,t,r)}async function zc(s){var r;let t=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)t.push(s);else if(Zs(s))t.push(await s.arrayBuffer());else if(Jc(s))for await(const n of s)t.push(n);else throw new Error(`Unexpected data type: ${typeof s}; constructor: ${(r=s==null?void 0:s.constructor)==null?void 0:r.name}; props: ${Gc(s)}`);return t}function Gc(s){return`[${Object.getOwnPropertyNames(s).map(r=>`"${r}"`).join(", ")}]`}function Vc(s){var t;return gr(s.name)||gr(s.filename)||((t=gr(s.path))==null?void 0:t.split(/[\\/]/).pop())}const gr=s=>{if(typeof s=="string")return s;if(typeof Buffer<"u"&&s instanceof Buffer)return String(s)},Jc=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function",na=s=>s&&typeof s=="object"&&s.body&&s[Symbol.toStringTag]==="MultipartBody",Et=async s=>{const t=await Xc(s.body);return ni(t,s)},Xc=async s=>{const t=new si;return await Promise.all(Object.entries(s||{}).map(([r,n])=>Or(t,r,n))),t},Or=async(s,t,r)=>{if(r!==void 0){if(r==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")s.append(t,String(r));else if(Hc(r)){const n=await ji(r);s.append(t,n)}else if(Array.isArray(r))await Promise.all(r.map(n=>Or(s,t+"[]",n)));else if(typeof r=="object")await Promise.all(Object.entries(r).map(([n,a])=>Or(s,`${t}[${n}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};var jt={},Yc=function(s,t,r,n,a){if(typeof t=="function"?s!==t||!a:!t.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(s,r),r},Kc=function(s,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?s!==t||!n:!t.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(s):n?n.value:t.get(s)},fs;async function vi(s){const{response:t}=s;if(s.options.stream)return vt("response",t.status,t.url,t.headers,t.body),s.options.__streamClass?s.options.__streamClass.fromSSEResponse(t,s.controller):Me.fromSSEResponse(t,s.controller);if(t.status===204)return null;if(s.options.__binaryResponse)return t;const r=t.headers.get("content-type");if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.includes("application/vnd.api+json"))){const i=await t.json();return vt("response",t.status,t.url,t.headers,i),Ni(i,t)}const a=await t.text();return vt("response",t.status,t.url,t.headers,a),a}function Ni(s,t){return!s||typeof s!="object"||Array.isArray(s)?s:Object.defineProperty(s,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class er extends Promise{constructor(t,r=vi){super(n=>{n(null)}),this.responsePromise=t,this.parseResponse=r}_thenUnwrap(t){return new er(this.responsePromise,async r=>Ni(t(await this.parseResponse(r),r),r.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:r,request_id:r.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,r){return this.parse().then(t,r)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class Qc{constructor({baseURL:t,maxRetries:r=2,timeout:n=6e5,httpAgent:a,fetch:i}){this.baseURL=t,this.maxRetries=pr("maxRetries",r),this.timeout=pr("timeout",n),this.httpAgent=a,this.fetch=i??ti}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...nd(),...this.authHeaders(t)}}validateHeaders(t,r){}defaultIdempotencyKey(){return`stainless-node-retry-${ld()}`}get(t,r){return this.methodRequest("get",t,r)}post(t,r){return this.methodRequest("post",t,r)}patch(t,r){return this.methodRequest("patch",t,r)}put(t,r){return this.methodRequest("put",t,r)}delete(t,r){return this.methodRequest("delete",t,r)}methodRequest(t,r,n){return this.request(Promise.resolve(n).then(async a=>{const i=a&&Zs(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:t,path:r,...a,body:i}}))}getAPIList(t,r,n){return this.requestAPIList(r,{method:"get",path:t,...n})}calculateContentLength(t){if(typeof t=="string"){if(typeof Buffer<"u")return Buffer.byteLength(t,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t,{retryCount:r=0}={}){var y;t={...t};const{method:n,path:a,query:i,headers:o={}}=t,l=ArrayBuffer.isView(t.body)||t.__binaryRequest&&typeof t.body=="string"?t.body:na(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,m=this.calculateContentLength(l),c=this.buildURL(a,i);"timeout"in t&&pr("timeout",t.timeout),t.timeout=t.timeout??this.timeout;const g=t.httpAgent??this.httpAgent??ai(c),u=t.timeout+1e3;typeof((y=g==null?void 0:g.options)==null?void 0:y.timeout)=="number"&&u>(g.options.timeout??0)&&(g.options.timeout=u),this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey);const p=this.buildHeaders({options:t,headers:o,contentLength:m,retryCount:r});return{req:{method:n,...l&&{body:l},headers:p,...g&&{agent:g},signal:t.signal??null},url:c,timeout:t.timeout}}buildHeaders({options:t,headers:r,contentLength:n,retryCount:a}){const i={};n&&(i["content-length"]=n);const o=this.defaultHeaders(t);return la(i,o),la(i,r),na(t.body)&&zt!=="node"&&delete i["content-type"],ps(o,"x-stainless-retry-count")===void 0&&ps(r,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(a)),ps(o,"x-stainless-timeout")===void 0&&ps(r,"x-stainless-timeout")===void 0&&t.timeout&&(i["x-stainless-timeout"]=String(t.timeout)),this.validateHeaders(i,r),i}async prepareOptions(t){}async prepareRequest(t,{url:r,options:n}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map(r=>[...r])):{...t}:{}}makeStatusError(t,r,n,a){return oe.generate(t,r,n,a)}request(t,r=null){return new er(this.makeRequest(t,r))}async makeRequest(t,r){var u,p;const n=await t,a=n.maxRetries??this.maxRetries;r==null&&(r=a),await this.prepareOptions(n);const{req:i,url:o,timeout:l}=this.buildRequest(n,{retryCount:a-r});if(await this.prepareRequest(i,{url:o,options:n}),vt("request",o,n,i.headers),(u=n.signal)!=null&&u.aborted)throw new Ce;const m=new AbortController,c=await this.fetchWithTimeout(o,i,l,m).catch(Fr);if(c instanceof Error){if((p=n.signal)!=null&&p.aborted)throw new Ce;if(r)return this.retryRequest(n,r);throw c.name==="AbortError"?new dn:new Ks({cause:c})}const g=ed(c.headers);if(!c.ok){if(r&&this.shouldRetry(c)){const w=`retrying, ${r} attempts remaining`;return vt(`response (error; ${w})`,c.status,o,g),this.retryRequest(n,r,g)}const d=await c.text().catch(w=>Fr(w).message),y=ad(d),b=y?void 0:d;throw vt(`response (error; ${r?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,g,b),this.makeStatusError(c.status,y,b,g)}return{response:c,options:n,controller:m}}requestAPIList(t,r){const n=this.makeRequest(r,null);return new Zc(this,n,t)}buildURL(t,r){const n=od(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),a=this.defaultQuery();return ki(a)||(r={...a,...r}),typeof r=="object"&&r&&!Array.isArray(r)&&(n.search=this.stringifyQuery(r)),n.toString()}stringifyQuery(t){return Object.entries(t).filter(([r,n])=>typeof n<"u").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new W(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(t,r,n,a){const{signal:i,...o}=r||{};i&&i.addEventListener("abort",()=>a.abort());const l=setTimeout(()=>a.abort(),n),m={signal:a.signal,...o};return m.method&&(m.method=m.method.toUpperCase()),this.fetch.call(void 0,t,m).finally(()=>{clearTimeout(l)})}shouldRetry(t){const r=t.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,r,n){let a;const i=n==null?void 0:n["retry-after-ms"];if(i){const l=parseFloat(i);Number.isNaN(l)||(a=l)}const o=n==null?void 0:n["retry-after"];if(o&&!a){const l=parseFloat(o);Number.isNaN(l)?a=Date.parse(o)-Date.now():a=l*1e3}if(!(a&&0<=a&&a<60*1e3)){const l=t.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(r,l)}return await es(a),this.makeRequest(t,r-1)}calculateDefaultRetryTimeoutMillis(t,r){const i=r-t,o=Math.min(.5*Math.pow(2,i),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${pt}`}}class _i{constructor(t,r,n,a){fs.set(this,void 0),Yc(this,fs,t),this.options=a,this.response=r,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new W("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const r={...this.options};if("params"in t&&typeof r.query=="object")r.query={...r.query,...t.params};else if("url"in t){const n=[...Object.entries(r.query||{}),...t.url.searchParams.entries()];for(const[a,i]of n)t.url.searchParams.set(a,i);r.query=void 0,r.path=t.url.toString()}return await Kc(this,fs,"f").requestAPIList(this.constructor,r)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(fs=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const r of t.getPaginatedItems())yield r}}class Zc extends er{constructor(t,r,n){super(r,async a=>new n(t,a.response,await vi(a),a.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const r of t)yield r}}const ed=s=>new Proxy(Object.fromEntries(s.entries()),{get(t,r){const n=r.toString();return t[n.toLowerCase()]||t[n]}}),td={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},me=s=>typeof s=="object"&&s!==null&&!ki(s)&&Object.keys(s).every(t=>Ci(td,t)),sd=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pt,"X-Stainless-OS":ia(Deno.build.os),"X-Stainless-Arch":aa(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pt,"X-Stainless-OS":ia(process.platform),"X-Stainless-Arch":aa(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const s=rd();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function rd(){if(typeof navigator>"u"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:r}of s){const n=r.exec(navigator.userAgent);if(n){const a=n[1]||0,i=n[2]||0,o=n[3]||0;return{browser:t,version:`${a}.${i}.${o}`}}}return null}const aa=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",ia=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let oa;const nd=()=>oa??(oa=sd()),ad=s=>{try{return JSON.parse(s)}catch{return}},id=/^[a-z][a-z0-9+.-]*:/i,od=s=>id.test(s),es=s=>new Promise(t=>setTimeout(t,s)),pr=(s,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new W(`${s} must be an integer`);if(t<0)throw new W(`${s} must be a positive integer`);return t},Fr=s=>{if(s instanceof Error)return s;if(typeof s=="object"&&s!==null)try{return new Error(JSON.stringify(s))}catch{}return new Error(s)},gs=s=>{var t,r,n,a;if(typeof process<"u")return((t=jt==null?void 0:jt[s])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(n=(r=Deno.env)==null?void 0:r.get)==null?void 0:n.call(r,s))==null?void 0:a.trim()};function ki(s){if(!s)return!0;for(const t in s)return!1;return!0}function Ci(s,t){return Object.prototype.hasOwnProperty.call(s,t)}function la(s,t){for(const r in t){if(!Ci(t,r))continue;const n=r.toLowerCase();if(!n)continue;const a=t[r];a===null?delete s[n]:a!==void 0&&(s[n]=a)}}const ca=new Set(["authorization","api-key"]);function vt(s,...t){if(typeof process<"u"&&(jt==null?void 0:jt.DEBUG)==="true"){const r=t.map(n=>{if(!n)return n;if(n.headers){const i={...n,headers:{...n.headers}};for(const o in n.headers)ca.has(o.toLowerCase())&&(i.headers[o]="REDACTED");return i}let a=null;for(const i in n)ca.has(i.toLowerCase())&&(a??(a={...n}),a[i]="REDACTED");return a??n});console.log(`OpenAI:DEBUG:${s}`,...r)}}const ld=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const t=Math.random()*16|0;return(s==="x"?t:t&3|8).toString(16)}),cd=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",dd=s=>typeof(s==null?void 0:s.get)=="function",ps=(s,t)=>{var n;const r=t.toLowerCase();if(dd(s)){const a=((n=t[0])==null?void 0:n.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,(i,o,l)=>o+l.toUpperCase());for(const i of[t,r,t.toUpperCase(),a]){const o=s.get(i);if(o)return o}}for(const[a,i]of Object.entries(s))if(a.toLowerCase()===r)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${t} header, using the first entry.`),i[0]):i};function yr(s){return s!=null&&typeof s=="object"&&!Array.isArray(s)}class md extends _i{constructor(t,r,n,a){super(t,r,n,a),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class je extends _i{constructor(t,r,n,a){super(t,r,n,a),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const r=Object.fromEntries(t.url.searchParams);return Object.keys(r).length?r:null}nextPageInfo(){var n;const t=this.getPaginatedItems();if(!t.length)return null;const r=(n=t[t.length-1])==null?void 0:n.id;return r?{params:{after:r}}:null}}class H{constructor(t){this._client=t}}let Si=class extends H{list(t,r={},n){return me(r)?this.list(t,{},r):this._client.getAPIList(`/chat/completions/${t}/messages`,ud,{query:r,...n})}},tr=class extends H{constructor(){super(...arguments),this.messages=new Si(this._client)}create(t,r){return this._client.post("/chat/completions",{body:t,...r,stream:t.stream??!1})}retrieve(t,r){return this._client.get(`/chat/completions/${t}`,r)}update(t,r,n){return this._client.post(`/chat/completions/${t}`,{body:r,...n})}list(t={},r){return me(t)?this.list({},t):this._client.getAPIList("/chat/completions",sr,{query:t,...r})}del(t,r){return this._client.delete(`/chat/completions/${t}`,r)}};class sr extends je{}class ud extends je{}tr.ChatCompletionsPage=sr;tr.Messages=Si;let rr=class extends H{constructor(){super(...arguments),this.completions=new tr(this._client)}};rr.Completions=tr;rr.ChatCompletionsPage=sr;class Ei extends H{create(t,r){return this._client.post("/audio/speech",{body:t,...r,headers:{Accept:"application/octet-stream",...r==null?void 0:r.headers},__binaryResponse:!0})}}class Ai extends H{create(t,r){return this._client.post("/audio/transcriptions",Et({body:t,...r,__metadata:{model:t.model}}))}}class Pi extends H{create(t,r){return this._client.post("/audio/translations",Et({body:t,...r,__metadata:{model:t.model}}))}}class ts extends H{constructor(){super(...arguments),this.transcriptions=new Ai(this._client),this.translations=new Pi(this._client),this.speech=new Ei(this._client)}}ts.Transcriptions=Ai;ts.Translations=Pi;ts.Speech=Ei;class mn extends H{create(t,r){return this._client.post("/batches",{body:t,...r})}retrieve(t,r){return this._client.get(`/batches/${t}`,r)}list(t={},r){return me(t)?this.list({},t):this._client.getAPIList("/batches",un,{query:t,...r})}cancel(t,r){return this._client.post(`/batches/${t}/cancel`,r)}}class un extends je{}mn.BatchesPage=un;class hn extends H{create(t,r){return this._client.post("/assistants",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,r){return this._client.get(`/assistants/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,r,n){return this._client.post(`/assistants/${t}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(t={},r){return me(t)?this.list({},t):this._client.getAPIList("/assistants",xn,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,r){return this._client.delete(`/assistants/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class xn extends je{}hn.AssistantsPage=xn;function da(s){return typeof s.parse=="function"}const Nt=s=>(s==null?void 0:s.role)==="assistant",Ii=s=>(s==null?void 0:s.role)==="function",Ri=s=>(s==null?void 0:s.role)==="tool";var _e=function(s,t,r,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?s!==t||!a:!t.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(s,r):a?a.value=r:t.set(s,r),r},K=function(s,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?s!==t||!n:!t.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(s):n?n.value:t.get(s)},Mr,Ps,Is,Lt,Bt,Rs,Ut,He,qt,Bs,Us,yt,Ti;class Di{constructor(){Mr.add(this),this.controller=new AbortController,Ps.set(this,void 0),Is.set(this,()=>{}),Lt.set(this,()=>{}),Bt.set(this,void 0),Rs.set(this,()=>{}),Ut.set(this,()=>{}),He.set(this,{}),qt.set(this,!1),Bs.set(this,!1),Us.set(this,!1),yt.set(this,!1),_e(this,Ps,new Promise((t,r)=>{_e(this,Is,t,"f"),_e(this,Lt,r,"f")}),"f"),_e(this,Bt,new Promise((t,r)=>{_e(this,Rs,t,"f"),_e(this,Ut,r,"f")}),"f"),K(this,Ps,"f").catch(()=>{}),K(this,Bt,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},K(this,Mr,"m",Ti).bind(this))},0)}_connected(){this.ended||(K(this,Is,"f").call(this),this._emit("connect"))}get ended(){return K(this,qt,"f")}get errored(){return K(this,Bs,"f")}get aborted(){return K(this,Us,"f")}abort(){this.controller.abort()}on(t,r){return(K(this,He,"f")[t]||(K(this,He,"f")[t]=[])).push({listener:r}),this}off(t,r){const n=K(this,He,"f")[t];if(!n)return this;const a=n.findIndex(i=>i.listener===r);return a>=0&&n.splice(a,1),this}once(t,r){return(K(this,He,"f")[t]||(K(this,He,"f")[t]=[])).push({listener:r,once:!0}),this}emitted(t){return new Promise((r,n)=>{_e(this,yt,!0,"f"),t!=="error"&&this.once("error",n),this.once(t,r)})}async done(){_e(this,yt,!0,"f"),await K(this,Bt,"f")}_emit(t,...r){if(K(this,qt,"f"))return;t==="end"&&(_e(this,qt,!0,"f"),K(this,Rs,"f").call(this));const n=K(this,He,"f")[t];if(n&&(K(this,He,"f")[t]=n.filter(a=>!a.once),n.forEach(({listener:a})=>a(...r))),t==="abort"){const a=r[0];!K(this,yt,"f")&&!(n!=null&&n.length)&&Promise.reject(a),K(this,Lt,"f").call(this,a),K(this,Ut,"f").call(this,a),this._emit("end");return}if(t==="error"){const a=r[0];!K(this,yt,"f")&&!(n!=null&&n.length)&&Promise.reject(a),K(this,Lt,"f").call(this,a),K(this,Ut,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Ps=new WeakMap,Is=new WeakMap,Lt=new WeakMap,Bt=new WeakMap,Rs=new WeakMap,Ut=new WeakMap,He=new WeakMap,qt=new WeakMap,Bs=new WeakMap,Us=new WeakMap,yt=new WeakMap,Mr=new WeakSet,Ti=function(t){if(_e(this,Bs,!0,"f"),t instanceof Error&&t.name==="AbortError"&&(t=new Ce),t instanceof Ce)return _e(this,Us,!0,"f"),this._emit("abort",t);if(t instanceof W)return this._emit("error",t);if(t instanceof Error){const r=new W(t.message);return r.cause=t,this._emit("error",r)}return this._emit("error",new W(String(t)))};function Oi(s){return(s==null?void 0:s.$brand)==="auto-parseable-response-format"}function ss(s){return(s==null?void 0:s.$brand)==="auto-parseable-tool"}function hd(s,t){return!t||!Fi(t)?{...s,choices:s.choices.map(r=>({...r,message:{...r.message,parsed:null,tool_calls:r.message.tool_calls??[]}}))}:fn(s,t)}function fn(s,t){const r=s.choices.map(n=>{var a;if(n.finish_reason==="length")throw new gi;if(n.finish_reason==="content_filter")throw new pi;return{...n,message:{...n.message,tool_calls:((a=n.message.tool_calls)==null?void 0:a.map(i=>fd(t,i)))??[],parsed:n.message.content&&!n.message.refusal?xd(t,n.message.content):null}}});return{...s,choices:r}}function xd(s,t){var r,n;return((r=s.response_format)==null?void 0:r.type)!=="json_schema"?null:((n=s.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in s.response_format?s.response_format.$parseRaw(t):JSON.parse(t):null}function fd(s,t){var n;const r=(n=s.tools)==null?void 0:n.find(a=>{var i;return((i=a.function)==null?void 0:i.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:ss(r)?r.$parseRaw(t.function.arguments):r!=null&&r.function.strict?JSON.parse(t.function.arguments):null}}}function gd(s,t){var n;if(!s)return!1;const r=(n=s.tools)==null?void 0:n.find(a=>{var i;return((i=a.function)==null?void 0:i.name)===t.function.name});return ss(r)||(r==null?void 0:r.function.strict)||!1}function Fi(s){var t;return Oi(s.response_format)?!0:((t=s.tools)==null?void 0:t.some(r=>ss(r)||r.type==="function"&&r.function.strict===!0))??!1}function pd(s){for(const t of s??[]){if(t.type!=="function")throw new W(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new W(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var ue=function(s,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?s!==t||!n:!t.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(s):n?n.value:t.get(s)},le,$r,qs,Lr,Br,Ur,Mi,qr;const ma=10;class $i extends Di{constructor(){super(...arguments),le.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var n;this._chatCompletions.push(t),this._emit("chatCompletion",t);const r=(n=t.choices[0])==null?void 0:n.message;return r&&this._addMessage(r),t}_addMessage(t,r=!0){if("content"in t||(t.content=null),this.messages.push(t),r){if(this._emit("message",t),(Ii(t)||Ri(t))&&t.content)this._emit("functionCallResult",t.content);else if(Nt(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(Nt(t)&&t.tool_calls)for(const n of t.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new W("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),ue(this,le,"m",$r).call(this)}async finalMessage(){return await this.done(),ue(this,le,"m",qs).call(this)}async finalFunctionCall(){return await this.done(),ue(this,le,"m",Lr).call(this)}async finalFunctionCallResult(){return await this.done(),ue(this,le,"m",Br).call(this)}async totalUsage(){return await this.done(),ue(this,le,"m",Ur).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const r=ue(this,le,"m",qs).call(this);r&&this._emit("finalMessage",r);const n=ue(this,le,"m",$r).call(this);n&&this._emit("finalContent",n);const a=ue(this,le,"m",Lr).call(this);a&&this._emit("finalFunctionCall",a);const i=ue(this,le,"m",Br).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",ue(this,le,"m",Ur).call(this))}async _createChatCompletion(t,r,n){const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),ue(this,le,"m",Mi).call(this,r);const i=await t.chat.completions.create({...r,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(fn(i,r))}async _runChatCompletion(t,r,n){for(const a of r.messages)this._addMessage(a,!1);return await this._createChatCompletion(t,r,n)}async _runFunctions(t,r,n){var p;const a="function",{function_call:i="auto",stream:o,...l}=r,m=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:c=ma}=n||{},g={};for(const d of r.functions)g[d.name||d.function.name]=d;const u=r.functions.map(d=>({name:d.name||d.function.name,parameters:d.parameters,description:d.description}));for(const d of r.messages)this._addMessage(d,!1);for(let d=0;d<c;++d){const b=(p=(await this._createChatCompletion(t,{...l,function_call:i,functions:u,messages:[...this.messages]},n)).choices[0])==null?void 0:p.message;if(!b)throw new W("missing message in ChatCompletion response");if(!b.function_call)return;const{name:x,arguments:v}=b.function_call,w=g[x];if(w){if(m&&m!==x){const S=`Invalid function_call: ${JSON.stringify(x)}. ${JSON.stringify(m)} requested. Please try again`;this._addMessage({role:a,name:x,content:S});continue}}else{const S=`Invalid function_call: ${JSON.stringify(x)}. Available options are: ${u.map(N=>JSON.stringify(N.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:x,content:S});continue}let _;try{_=da(w)?await w.parse(v):v}catch(S){this._addMessage({role:a,name:x,content:S instanceof Error?S.message:String(S)});continue}const j=await w.function(_,this),f=ue(this,le,"m",qr).call(this,j);if(this._addMessage({role:a,name:x,content:f}),m)return}}async _runTools(t,r,n){var d,y,b;const a="tool",{tool_choice:i="auto",stream:o,...l}=r,m=typeof i!="string"&&((d=i==null?void 0:i.function)==null?void 0:d.name),{maxChatCompletions:c=ma}=n||{},g=r.tools.map(x=>{if(ss(x)){if(!x.$callback)throw new W("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:x.$callback,name:x.function.name,description:x.function.description||"",parameters:x.function.parameters,parse:x.$parseRaw,strict:!0}}}return x}),u={};for(const x of g)x.type==="function"&&(u[x.function.name||x.function.function.name]=x.function);const p="tools"in r?g.map(x=>x.type==="function"?{type:"function",function:{name:x.function.name||x.function.function.name,parameters:x.function.parameters,description:x.function.description,strict:x.function.strict}}:x):void 0;for(const x of r.messages)this._addMessage(x,!1);for(let x=0;x<c;++x){const w=(y=(await this._createChatCompletion(t,{...l,tool_choice:i,tools:p,messages:[...this.messages]},n)).choices[0])==null?void 0:y.message;if(!w)throw new W("missing message in ChatCompletion response");if(!((b=w.tool_calls)!=null&&b.length))return;for(const _ of w.tool_calls){if(_.type!=="function")continue;const j=_.id,{name:f,arguments:S}=_.function,N=u[f];if(N){if(m&&m!==f){const P=`Invalid tool_call: ${JSON.stringify(f)}. ${JSON.stringify(m)} requested. Please try again`;this._addMessage({role:a,tool_call_id:j,content:P});continue}}else{const P=`Invalid tool_call: ${JSON.stringify(f)}. Available options are: ${Object.keys(u).map(C=>JSON.stringify(C)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:j,content:P});continue}let O;try{O=da(N)?await N.parse(S):S}catch(P){const C=P instanceof Error?P.message:String(P);this._addMessage({role:a,tool_call_id:j,content:C});continue}const T=await N.function(O,this),I=ue(this,le,"m",qr).call(this,T);if(this._addMessage({role:a,tool_call_id:j,content:I}),m)return}}}}le=new WeakSet,$r=function(){return ue(this,le,"m",qs).call(this).content??null},qs=function(){let t=this.messages.length;for(;t-- >0;){const r=this.messages[t];if(Nt(r)){const{function_call:n,...a}=r,i={...a,content:r.content??null,refusal:r.refusal??null};return n&&(i.function_call=n),i}}throw new W("stream ended without producing a ChatCompletionMessage with role=assistant")},Lr=function(){var t,r;for(let n=this.messages.length-1;n>=0;n--){const a=this.messages[n];if(Nt(a)&&(a!=null&&a.function_call))return a.function_call;if(Nt(a)&&((t=a==null?void 0:a.tool_calls)!=null&&t.length))return(r=a.tool_calls.at(-1))==null?void 0:r.function}},Br=function(){for(let t=this.messages.length-1;t>=0;t--){const r=this.messages[t];if(Ii(r)&&r.content!=null||Ri(r)&&r.content!=null&&typeof r.content=="string"&&this.messages.some(n=>{var a;return n.role==="assistant"&&((a=n.tool_calls)==null?void 0:a.some(i=>i.type==="function"&&i.id===r.tool_call_id))}))return r.content}},Ur=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:r}of this._chatCompletions)r&&(t.completion_tokens+=r.completion_tokens,t.prompt_tokens+=r.prompt_tokens,t.total_tokens+=r.total_tokens);return t},Mi=function(t){if(t.n!=null&&t.n>1)throw new W("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},qr=function(t){return typeof t=="string"?t:t===void 0?"undefined":JSON.stringify(t)};class Jt extends $i{static runFunctions(t,r,n){const a=new Jt,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,r,i)),a}static runTools(t,r,n){const a=new Jt,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,r,i)),a}_addMessage(t,r=!0){super._addMessage(t,r),Nt(t)&&t.content&&this._emit("content",t.content)}}const Li=1,Bi=2,Ui=4,qi=8,Wi=16,Hi=32,zi=64,Gi=128,Vi=256,Ji=Gi|Vi,Xi=Wi|Hi|Ji|zi,Yi=Li|Bi|Xi,Ki=Ui|qi,yd=Yi|Ki,ae={STR:Li,NUM:Bi,ARR:Ui,OBJ:qi,NULL:Wi,BOOL:Hi,NAN:zi,INFINITY:Gi,MINUS_INFINITY:Vi,INF:Ji,SPECIAL:Xi,ATOM:Yi,COLLECTION:Ki,ALL:yd};class bd extends Error{}class wd extends Error{}function jd(s,t=ae.ALL){if(typeof s!="string")throw new TypeError(`expecting str, got ${typeof s}`);if(!s.trim())throw new Error(`${s} is empty`);return vd(s.trim(),t)}const vd=(s,t)=>{const r=s.length;let n=0;const a=p=>{throw new bd(`${p} at position ${n}`)},i=p=>{throw new wd(`${p} at position ${n}`)},o=()=>(u(),n>=r&&a("Unexpected end of input"),s[n]==='"'?l():s[n]==="{"?m():s[n]==="["?c():s.substring(n,n+4)==="null"||ae.NULL&t&&r-n<4&&"null".startsWith(s.substring(n))?(n+=4,null):s.substring(n,n+4)==="true"||ae.BOOL&t&&r-n<4&&"true".startsWith(s.substring(n))?(n+=4,!0):s.substring(n,n+5)==="false"||ae.BOOL&t&&r-n<5&&"false".startsWith(s.substring(n))?(n+=5,!1):s.substring(n,n+8)==="Infinity"||ae.INFINITY&t&&r-n<8&&"Infinity".startsWith(s.substring(n))?(n+=8,1/0):s.substring(n,n+9)==="-Infinity"||ae.MINUS_INFINITY&t&&1<r-n&&r-n<9&&"-Infinity".startsWith(s.substring(n))?(n+=9,-1/0):s.substring(n,n+3)==="NaN"||ae.NAN&t&&r-n<3&&"NaN".startsWith(s.substring(n))?(n+=3,NaN):g()),l=()=>{const p=n;let d=!1;for(n++;n<r&&(s[n]!=='"'||d&&s[n-1]==="\\");)d=s[n]==="\\"?!d:!1,n++;if(s.charAt(n)=='"')try{return JSON.parse(s.substring(p,++n-Number(d)))}catch(y){i(String(y))}else if(ae.STR&t)try{return JSON.parse(s.substring(p,n-Number(d))+'"')}catch{return JSON.parse(s.substring(p,s.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},m=()=>{n++,u();const p={};try{for(;s[n]!=="}";){if(u(),n>=r&&ae.OBJ&t)return p;const d=l();u(),n++;try{const y=o();Object.defineProperty(p,d,{value:y,writable:!0,enumerable:!0,configurable:!0})}catch(y){if(ae.OBJ&t)return p;throw y}u(),s[n]===","&&n++}}catch{if(ae.OBJ&t)return p;a("Expected '}' at end of object")}return n++,p},c=()=>{n++;const p=[];try{for(;s[n]!=="]";)p.push(o()),u(),s[n]===","&&n++}catch{if(ae.ARR&t)return p;a("Expected ']' at end of array")}return n++,p},g=()=>{if(n===0){s==="-"&&ae.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(s)}catch(d){if(ae.NUM&t)try{return s[s.length-1]==="."?JSON.parse(s.substring(0,s.lastIndexOf("."))):JSON.parse(s.substring(0,s.lastIndexOf("e")))}catch{}i(String(d))}}const p=n;for(s[n]==="-"&&n++;s[n]&&!",]}".includes(s[n]);)n++;n==r&&!(ae.NUM&t)&&a("Unterminated number literal");try{return JSON.parse(s.substring(p,n))}catch{s.substring(p,n)==="-"&&ae.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(s.substring(p,s.lastIndexOf("e")))}catch(y){i(String(y))}}},u=()=>{for(;n<r&&` 
\r	`.includes(s[n]);)n++};return o()},ua=s=>jd(s,ae.ALL^ae.NUM);var ft=function(s,t,r,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?s!==t||!a:!t.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(s,r):a?a.value=r:t.set(s,r),r},J=function(s,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?s!==t||!n:!t.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(s):n?n.value:t.get(s)},te,We,gt,Ke,br,ys,wr,jr,vr,bs,Nr,ha;class Xt extends $i{constructor(t){super(),te.add(this),We.set(this,void 0),gt.set(this,void 0),Ke.set(this,void 0),ft(this,We,t,"f"),ft(this,gt,[],"f")}get currentChatCompletionSnapshot(){return J(this,Ke,"f")}static fromReadableStream(t){const r=new Xt(null);return r._run(()=>r._fromReadableStream(t)),r}static createChatCompletion(t,r,n){const a=new Xt(r);return a._run(()=>a._runChatCompletion(t,{...r,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(t,r,n){var o;super._createChatCompletion;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),J(this,te,"m",br).call(this);const i=await t.chat.completions.create({...r,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const l of i)J(this,te,"m",wr).call(this,l);if((o=i.controller.signal)!=null&&o.aborted)throw new Ce;return this._addChatCompletion(J(this,te,"m",bs).call(this))}async _fromReadableStream(t,r){var o;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),J(this,te,"m",br).call(this),this._connected();const a=Me.fromReadableStream(t,this.controller);let i;for await(const l of a)i&&i!==l.id&&this._addChatCompletion(J(this,te,"m",bs).call(this)),J(this,te,"m",wr).call(this,l),i=l.id;if((o=a.controller.signal)!=null&&o.aborted)throw new Ce;return this._addChatCompletion(J(this,te,"m",bs).call(this))}[(We=new WeakMap,gt=new WeakMap,Ke=new WeakMap,te=new WeakSet,br=function(){this.ended||ft(this,Ke,void 0,"f")},ys=function(r){let n=J(this,gt,"f")[r.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},J(this,gt,"f")[r.index]=n,n)},wr=function(r){var a,i,o,l,m,c,g,u,p,d,y,b,x,v,w;if(this.ended)return;const n=J(this,te,"m",ha).call(this,r);this._emit("chunk",r,n);for(const _ of r.choices){const j=n.choices[_.index];_.delta.content!=null&&((a=j.message)==null?void 0:a.role)==="assistant"&&((i=j.message)!=null&&i.content)&&(this._emit("content",_.delta.content,j.message.content),this._emit("content.delta",{delta:_.delta.content,snapshot:j.message.content,parsed:j.message.parsed})),_.delta.refusal!=null&&((o=j.message)==null?void 0:o.role)==="assistant"&&((l=j.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:_.delta.refusal,snapshot:j.message.refusal}),((m=_.logprobs)==null?void 0:m.content)!=null&&((c=j.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(g=_.logprobs)==null?void 0:g.content,snapshot:((u=j.logprobs)==null?void 0:u.content)??[]}),((p=_.logprobs)==null?void 0:p.refusal)!=null&&((d=j.message)==null?void 0:d.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(y=_.logprobs)==null?void 0:y.refusal,snapshot:((b=j.logprobs)==null?void 0:b.refusal)??[]});const f=J(this,te,"m",ys).call(this,j);j.finish_reason&&(J(this,te,"m",vr).call(this,j),f.current_tool_call_index!=null&&J(this,te,"m",jr).call(this,j,f.current_tool_call_index));for(const S of _.delta.tool_calls??[])f.current_tool_call_index!==S.index&&(J(this,te,"m",vr).call(this,j),f.current_tool_call_index!=null&&J(this,te,"m",jr).call(this,j,f.current_tool_call_index)),f.current_tool_call_index=S.index;for(const S of _.delta.tool_calls??[]){const N=(x=j.message.tool_calls)==null?void 0:x[S.index];N!=null&&N.type&&((N==null?void 0:N.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=N.function)==null?void 0:v.name,index:S.index,arguments:N.function.arguments,parsed_arguments:N.function.parsed_arguments,arguments_delta:((w=S.function)==null?void 0:w.arguments)??""}):(N==null||N.type,void 0))}}},jr=function(r,n){var o,l,m;if(J(this,te,"m",ys).call(this,r).done_tool_calls.has(n))return;const i=(o=r.message.tool_calls)==null?void 0:o[n];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const c=(m=(l=J(this,We,"f"))==null?void 0:l.tools)==null?void 0:m.find(g=>g.type==="function"&&g.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:n,arguments:i.function.arguments,parsed_arguments:ss(c)?c.$parseRaw(i.function.arguments):c!=null&&c.function.strict?JSON.parse(i.function.arguments):null})}else i.type},vr=function(r){var a,i;const n=J(this,te,"m",ys).call(this,r);if(r.message.content&&!n.content_done){n.content_done=!0;const o=J(this,te,"m",Nr).call(this);this._emit("content.done",{content:r.message.content,parsed:o?o.$parseRaw(r.message.content):null})}r.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:r.message.refusal})),(a=r.logprobs)!=null&&a.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:r.logprobs.content})),(i=r.logprobs)!=null&&i.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:r.logprobs.refusal}))},bs=function(){if(this.ended)throw new W("stream has ended, this shouldn't happen");const r=J(this,Ke,"f");if(!r)throw new W("request ended without sending any chunks");return ft(this,Ke,void 0,"f"),ft(this,gt,[],"f"),Nd(r,J(this,We,"f"))},Nr=function(){var n;const r=(n=J(this,We,"f"))==null?void 0:n.response_format;return Oi(r)?r:null},ha=function(r){var n,a,i,o;let l=J(this,Ke,"f");const{choices:m,...c}=r;l?Object.assign(l,c):l=ft(this,Ke,{...c,choices:[]},"f");for(const{delta:g,finish_reason:u,index:p,logprobs:d=null,...y}of r.choices){let b=l.choices[p];if(b||(b=l.choices[p]={finish_reason:u,index:p,message:{},logprobs:d,...y}),d)if(!b.logprobs)b.logprobs=Object.assign({},d);else{const{content:S,refusal:N,...O}=d;Object.assign(b.logprobs,O),S&&((n=b.logprobs).content??(n.content=[]),b.logprobs.content.push(...S)),N&&((a=b.logprobs).refusal??(a.refusal=[]),b.logprobs.refusal.push(...N))}if(u&&(b.finish_reason=u,J(this,We,"f")&&Fi(J(this,We,"f")))){if(u==="length")throw new gi;if(u==="content_filter")throw new pi}if(Object.assign(b,y),!g)continue;const{content:x,refusal:v,function_call:w,role:_,tool_calls:j,...f}=g;if(Object.assign(b.message,f),v&&(b.message.refusal=(b.message.refusal||"")+v),_&&(b.message.role=_),w&&(b.message.function_call?(w.name&&(b.message.function_call.name=w.name),w.arguments&&((i=b.message.function_call).arguments??(i.arguments=""),b.message.function_call.arguments+=w.arguments)):b.message.function_call=w),x&&(b.message.content=(b.message.content||"")+x,!b.message.refusal&&J(this,te,"m",Nr).call(this)&&(b.message.parsed=ua(b.message.content))),j){b.message.tool_calls||(b.message.tool_calls=[]);for(const{index:S,id:N,type:O,function:T,...I}of j){const P=(o=b.message.tool_calls)[S]??(o[S]={});Object.assign(P,I),N&&(P.id=N),O&&(P.type=O),T&&(P.function??(P.function={name:T.name??"",arguments:""})),T!=null&&T.name&&(P.function.name=T.name),T!=null&&T.arguments&&(P.function.arguments+=T.arguments,gd(J(this,We,"f"),P)&&(P.function.parsed_arguments=ua(P.function.arguments)))}}}return l},Symbol.asyncIterator)](){const t=[],r=[];let n=!1;return this.on("chunk",a=>{const i=r.shift();i?i.resolve(a):t.push(a)}),this.on("end",()=>{n=!0;for(const a of r)a.resolve(void 0);r.length=0}),this.on("abort",a=>{n=!0;for(const i of r)i.reject(a);r.length=0}),this.on("error",a=>{n=!0;for(const i of r)i.reject(a);r.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,o)=>r.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Me(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Nd(s,t){const{id:r,choices:n,created:a,model:i,system_fingerprint:o,...l}=s,m={...l,id:r,choices:n.map(({message:c,finish_reason:g,index:u,logprobs:p,...d})=>{if(!g)throw new W(`missing finish_reason for choice ${u}`);const{content:y=null,function_call:b,tool_calls:x,...v}=c,w=c.role;if(!w)throw new W(`missing role for choice ${u}`);if(b){const{arguments:_,name:j}=b;if(_==null)throw new W(`missing function_call.arguments for choice ${u}`);if(!j)throw new W(`missing function_call.name for choice ${u}`);return{...d,message:{content:y,function_call:{arguments:_,name:j},role:w,refusal:c.refusal??null},finish_reason:g,index:u,logprobs:p}}return x?{...d,index:u,finish_reason:g,logprobs:p,message:{...v,role:w,content:y,refusal:c.refusal??null,tool_calls:x.map((_,j)=>{const{function:f,type:S,id:N,...O}=_,{arguments:T,name:I,...P}=f||{};if(N==null)throw new W(`missing choices[${u}].tool_calls[${j}].id
${ws(s)}`);if(S==null)throw new W(`missing choices[${u}].tool_calls[${j}].type
${ws(s)}`);if(I==null)throw new W(`missing choices[${u}].tool_calls[${j}].function.name
${ws(s)}`);if(T==null)throw new W(`missing choices[${u}].tool_calls[${j}].function.arguments
${ws(s)}`);return{...O,id:N,type:S,function:{...P,name:I,arguments:T}}})}}:{...d,message:{...v,content:y,role:w,refusal:c.refusal??null},finish_reason:g,index:u,logprobs:p}}),created:a,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return hd(m,t)}function ws(s){return JSON.stringify(s)}class _t extends Xt{static fromReadableStream(t){const r=new _t(null);return r._run(()=>r._fromReadableStream(t)),r}static runFunctions(t,r,n){const a=new _t(null),i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,r,i)),a}static runTools(t,r,n){const a=new _t(r),i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,r,i)),a}}let Qi=class extends H{parse(t,r){return pd(t.tools),this._client.chat.completions.create(t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>fn(n,t))}runFunctions(t,r){return t.stream?_t.runFunctions(this._client,t,r):Jt.runFunctions(this._client,t,r)}runTools(t,r){return t.stream?_t.runTools(this._client,t,r):Jt.runTools(this._client,t,r)}stream(t,r){return Xt.createChatCompletion(this._client,t,r)}};class Wr extends H{constructor(){super(...arguments),this.completions=new Qi(this._client)}}(function(s){s.Completions=Qi})(Wr||(Wr={}));class Zi extends H{create(t,r){return this._client.post("/realtime/sessions",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class gn extends H{constructor(){super(...arguments),this.sessions=new Zi(this._client)}}gn.Sessions=Zi;var M=function(s,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?s!==t||!n:!t.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(s):n?n.value:t.get(s)},ge=function(s,t,r,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?s!==t||!a:!t.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(s,r):a?a.value=r:t.set(s,r),r},ie,Hr,De,Ts,ke,ct,bt,lt,Ws,ye,Ds,Os,Gt,Wt,Ht,xa,fa,ga,pa,ya,ba,wa;class Se extends Di{constructor(){super(...arguments),ie.add(this),Hr.set(this,[]),De.set(this,{}),Ts.set(this,{}),ke.set(this,void 0),ct.set(this,void 0),bt.set(this,void 0),lt.set(this,void 0),Ws.set(this,void 0),ye.set(this,void 0),Ds.set(this,void 0),Os.set(this,void 0),Gt.set(this,void 0)}[(Hr=new WeakMap,De=new WeakMap,Ts=new WeakMap,ke=new WeakMap,ct=new WeakMap,bt=new WeakMap,lt=new WeakMap,Ws=new WeakMap,ye=new WeakMap,Ds=new WeakMap,Os=new WeakMap,Gt=new WeakMap,ie=new WeakSet,Symbol.asyncIterator)](){const t=[],r=[];let n=!1;return this.on("event",a=>{const i=r.shift();i?i.resolve(a):t.push(a)}),this.on("end",()=>{n=!0;for(const a of r)a.resolve(void 0);r.length=0}),this.on("abort",a=>{n=!0;for(const i of r)i.reject(a);r.length=0}),this.on("error",a=>{n=!0;for(const i of r)i.reject(a);r.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,o)=>r.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const r=new Se;return r._run(()=>r._fromReadableStream(t)),r}async _fromReadableStream(t,r){var i;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=Me.fromReadableStream(t,this.controller);for await(const o of a)M(this,ie,"m",Wt).call(this,o);if((i=a.controller.signal)!=null&&i.aborted)throw new Ce;return this._addRun(M(this,ie,"m",Ht).call(this))}toReadableStream(){return new Me(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,r,n,a,i){const o=new Se;return o._run(()=>o._runToolAssistantStream(t,r,n,a,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(t,r,n,a,i){var c;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...a,stream:!0},m=await t.submitToolOutputs(r,n,l,{...i,signal:this.controller.signal});this._connected();for await(const g of m)M(this,ie,"m",Wt).call(this,g);if((c=m.controller.signal)!=null&&c.aborted)throw new Ce;return this._addRun(M(this,ie,"m",Ht).call(this))}static createThreadAssistantStream(t,r,n){const a=new Se;return a._run(()=>a._threadAssistantStream(t,r,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(t,r,n,a){const i=new Se;return i._run(()=>i._runAssistantStream(t,r,n,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return M(this,Ds,"f")}currentRun(){return M(this,Os,"f")}currentMessageSnapshot(){return M(this,ke,"f")}currentRunStepSnapshot(){return M(this,Gt,"f")}async finalRunSteps(){return await this.done(),Object.values(M(this,De,"f"))}async finalMessages(){return await this.done(),Object.values(M(this,Ts,"f"))}async finalRun(){if(await this.done(),!M(this,ct,"f"))throw Error("Final run was not received.");return M(this,ct,"f")}async _createThreadAssistantStream(t,r,n){var l;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},o=await t.createAndRun(i,{...n,signal:this.controller.signal});this._connected();for await(const m of o)M(this,ie,"m",Wt).call(this,m);if((l=o.controller.signal)!=null&&l.aborted)throw new Ce;return this._addRun(M(this,ie,"m",Ht).call(this))}async _createAssistantStream(t,r,n,a){var m;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},l=await t.create(r,o,{...a,signal:this.controller.signal});this._connected();for await(const c of l)M(this,ie,"m",Wt).call(this,c);if((m=l.controller.signal)!=null&&m.aborted)throw new Ce;return this._addRun(M(this,ie,"m",Ht).call(this))}static accumulateDelta(t,r){for(const[n,a]of Object.entries(r)){if(!t.hasOwnProperty(n)){t[n]=a;continue}let i=t[n];if(i==null){t[n]=a;continue}if(n==="index"||n==="type"){t[n]=a;continue}if(typeof i=="string"&&typeof a=="string")i+=a;else if(typeof i=="number"&&typeof a=="number")i+=a;else if(yr(i)&&yr(a))i=this.accumulateDelta(i,a);else if(Array.isArray(i)&&Array.isArray(a)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...a);continue}for(const o of a){if(!yr(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const l=o.index;if(l==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const m=i[l];m==null?i.push(o):i[l]=this.accumulateDelta(m,o)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${a}, accValue: ${i}`);t[n]=i}return t}_addRun(t){return t}async _threadAssistantStream(t,r,n){return await this._createThreadAssistantStream(r,t,n)}async _runAssistantStream(t,r,n,a){return await this._createAssistantStream(r,t,n,a)}async _runToolAssistantStream(t,r,n,a,i){return await this._createToolAssistantStream(n,t,r,a,i)}}Wt=function(t){if(!this.ended)switch(ge(this,Ds,t,"f"),M(this,ie,"m",ga).call(this,t),t.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":M(this,ie,"m",wa).call(this,t);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":M(this,ie,"m",fa).call(this,t);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":M(this,ie,"m",xa).call(this,t);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Ht=function(){if(this.ended)throw new W("stream has ended, this shouldn't happen");if(!M(this,ct,"f"))throw Error("Final run has not been received");return M(this,ct,"f")},xa=function(t){const[r,n]=M(this,ie,"m",ya).call(this,t,M(this,ke,"f"));ge(this,ke,r,"f"),M(this,Ts,"f")[r.id]=r;for(const a of n){const i=r.content[a.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(t.event){case"thread.message.created":this._emit("messageCreated",t.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",t.data.delta,r),t.data.delta.content)for(const a of t.data.delta.content){if(a.type=="text"&&a.text){let i=a.text,o=r.content[a.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=M(this,bt,"f")){if(M(this,lt,"f"))switch(M(this,lt,"f").type){case"text":this._emit("textDone",M(this,lt,"f").text,M(this,ke,"f"));break;case"image_file":this._emit("imageFileDone",M(this,lt,"f").image_file,M(this,ke,"f"));break}ge(this,bt,a.index,"f")}ge(this,lt,r.content[a.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(M(this,bt,"f")!==void 0){const a=t.data.content[M(this,bt,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,M(this,ke,"f"));break;case"text":this._emit("textDone",a.text,M(this,ke,"f"));break}}M(this,ke,"f")&&this._emit("messageDone",t.data),ge(this,ke,void 0,"f")}},fa=function(t){const r=M(this,ie,"m",pa).call(this,t);switch(ge(this,Gt,r,"f"),t.event){case"thread.run.step.created":this._emit("runStepCreated",t.data);break;case"thread.run.step.delta":const n=t.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&r.step_details.type=="tool_calls")for(const i of n.step_details.tool_calls)i.index==M(this,Ws,"f")?this._emit("toolCallDelta",i,r.step_details.tool_calls[i.index]):(M(this,ye,"f")&&this._emit("toolCallDone",M(this,ye,"f")),ge(this,Ws,i.index,"f"),ge(this,ye,r.step_details.tool_calls[i.index],"f"),M(this,ye,"f")&&this._emit("toolCallCreated",M(this,ye,"f")));this._emit("runStepDelta",t.data.delta,r);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ge(this,Gt,void 0,"f"),t.data.step_details.type=="tool_calls"&&M(this,ye,"f")&&(this._emit("toolCallDone",M(this,ye,"f")),ge(this,ye,void 0,"f")),this._emit("runStepDone",t.data,r);break}},ga=function(t){M(this,Hr,"f").push(t),this._emit("event",t)},pa=function(t){switch(t.event){case"thread.run.step.created":return M(this,De,"f")[t.data.id]=t.data,t.data;case"thread.run.step.delta":let r=M(this,De,"f")[t.data.id];if(!r)throw Error("Received a RunStepDelta before creation of a snapshot");let n=t.data;if(n.delta){const a=Se.accumulateDelta(r,n.delta);M(this,De,"f")[t.data.id]=a}return M(this,De,"f")[t.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":M(this,De,"f")[t.data.id]=t.data;break}if(M(this,De,"f")[t.data.id])return M(this,De,"f")[t.data.id];throw new Error("No snapshot available")},ya=function(t,r){let n=[];switch(t.event){case"thread.message.created":return[t.data,n];case"thread.message.delta":if(!r)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=t.data;if(a.delta.content)for(const i of a.delta.content)if(i.index in r.content){let o=r.content[i.index];r.content[i.index]=M(this,ie,"m",ba).call(this,i,o)}else r.content[i.index]=i,n.push(i);return[r,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(r)return[r,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},ba=function(t,r){return Se.accumulateDelta(r,t)},wa=function(t){switch(ge(this,Os,t.data,"f"),t.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ge(this,ct,t.data,"f"),M(this,ye,"f")&&(this._emit("toolCallDone",M(this,ye,"f")),ge(this,ye,void 0,"f"));break}};let pn=class extends H{create(t,r,n){return this._client.post(`/threads/${t}/messages`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,r,n){return this._client.get(`/threads/${t}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,r,n,a){return this._client.post(`/threads/${t}/messages/${r}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,r={},n){return me(r)?this.list(t,{},r):this._client.getAPIList(`/threads/${t}/messages`,yn,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,r,n){return this._client.delete(`/threads/${t}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}};class yn extends je{}pn.MessagesPage=yn;class bn extends H{retrieve(t,r,n,a={},i){return me(a)?this.retrieve(t,r,n,{},a):this._client.get(`/threads/${t}/runs/${r}/steps/${n}`,{query:a,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(t,r,n={},a){return me(n)?this.list(t,r,{},n):this._client.getAPIList(`/threads/${t}/runs/${r}/steps`,wn,{query:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class wn extends je{}bn.RunStepsPage=wn;class rs extends H{constructor(){super(...arguments),this.steps=new bn(this._client)}create(t,r,n){const{include:a,...i}=r;return this._client.post(`/threads/${t}/runs`,{query:{include:a},body:i,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:r.stream??!1})}retrieve(t,r,n){return this._client.get(`/threads/${t}/runs/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,r,n,a){return this._client.post(`/threads/${t}/runs/${r}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,r={},n){return me(r)?this.list(t,{},r):this._client.getAPIList(`/threads/${t}/runs`,jn,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(t,r,n){return this._client.post(`/threads/${t}/runs/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(t,r,n){const a=await this.create(t,r,n);return await this.poll(t,a.id,n)}createAndStream(t,r,n){return Se.createAssistantStream(t,this._client.beta.threads.runs,r,n)}async poll(t,r,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(t,r,{...n,headers:{...n==null?void 0:n.headers,...a}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(n!=null&&n.pollIntervalMs)l=n.pollIntervalMs;else{const m=o.headers.get("openai-poll-after-ms");if(m){const c=parseInt(m);isNaN(c)||(l=c)}}await es(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(t,r,n){return Se.createAssistantStream(t,this._client.beta.threads.runs,r,n)}submitToolOutputs(t,r,n,a){return this._client.post(`/threads/${t}/runs/${r}/submit_tool_outputs`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(t,r,n,a){const i=await this.submitToolOutputs(t,r,n,a);return await this.poll(t,i.id,a)}submitToolOutputsStream(t,r,n,a){return Se.createToolAssistantStream(t,r,this._client.beta.threads.runs,n,a)}}class jn extends je{}rs.RunsPage=jn;rs.Steps=bn;rs.RunStepsPage=wn;class It extends H{constructor(){super(...arguments),this.runs=new rs(this._client),this.messages=new pn(this._client)}create(t={},r){return me(t)?this.create({},t):this._client.post("/threads",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,r){return this._client.get(`/threads/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,r,n){return this._client.post(`/threads/${t}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,r){return this._client.delete(`/threads/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}createAndRun(t,r){return this._client.post("/threads/runs",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:t.stream??!1})}async createAndRunPoll(t,r){const n=await this.createAndRun(t,r);return await this.runs.poll(n.thread_id,n.id,r)}createAndRunStream(t,r){return Se.createThreadAssistantStream(t,this._client.beta.threads,r)}}It.Runs=rs;It.RunsPage=jn;It.Messages=pn;It.MessagesPage=yn;const _d=async s=>{const t=await Promise.allSettled(s),r=t.filter(a=>a.status==="rejected");if(r.length){for(const a of r)console.error(a.reason);throw new Error(`${r.length} promise(s) failed - see the above errors`)}const n=[];for(const a of t)a.status==="fulfilled"&&n.push(a.value);return n};let vn=class extends H{create(t,r,n){return this._client.post(`/vector_stores/${t}/files`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,r,n){return this._client.get(`/vector_stores/${t}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(t,r={},n){return me(r)?this.list(t,{},r):this._client.getAPIList(`/vector_stores/${t}/files`,nr,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,r,n){return this._client.delete(`/vector_stores/${t}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(t,r,n){const a=await this.create(t,r,n);return await this.poll(t,a.id,n)}async poll(t,r,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const i=await this.retrieve(t,r,{...n,headers:a}).withResponse(),o=i.data;switch(o.status){case"in_progress":let l=5e3;if(n!=null&&n.pollIntervalMs)l=n.pollIntervalMs;else{const m=i.response.headers.get("openai-poll-after-ms");if(m){const c=parseInt(m);isNaN(c)||(l=c)}}await es(l);break;case"failed":case"completed":return o}}}async upload(t,r,n){const a=await this._client.files.create({file:r,purpose:"assistants"},n);return this.create(t,{file_id:a.id},n)}async uploadAndPoll(t,r,n){const a=await this.upload(t,r,n);return await this.poll(t,a.id,n)}};class nr extends je{}vn.VectorStoreFilesPage=nr;class eo extends H{create(t,r,n){return this._client.post(`/vector_stores/${t}/file_batches`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,r,n){return this._client.get(`/vector_stores/${t}/file_batches/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(t,r,n){return this._client.post(`/vector_stores/${t}/file_batches/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(t,r,n){const a=await this.create(t,r);return await this.poll(t,a.id,n)}listFiles(t,r,n={},a){return me(n)?this.listFiles(t,r,{},n):this._client.getAPIList(`/vector_stores/${t}/file_batches/${r}/files`,nr,{query:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(t,r,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(t,r,{...n,headers:a}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(n!=null&&n.pollIntervalMs)l=n.pollIntervalMs;else{const m=o.headers.get("openai-poll-after-ms");if(m){const c=parseInt(m);isNaN(c)||(l=c)}}await es(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(t,{files:r,fileIds:n=[]},a){if(r==null||r.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(a==null?void 0:a.maxConcurrency)??5,o=Math.min(i,r.length),l=this._client,m=r.values(),c=[...n];async function g(p){for(let d of p){const y=await l.files.create({file:d,purpose:"assistants"},a);c.push(y.id)}}const u=Array(o).fill(m).map(g);return await _d(u),await this.createAndPoll(t,{file_ids:c})}}class Rt extends H{constructor(){super(...arguments),this.files=new vn(this._client),this.fileBatches=new eo(this._client)}create(t,r){return this._client.post("/vector_stores",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,r){return this._client.get(`/vector_stores/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,r,n){return this._client.post(`/vector_stores/${t}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(t={},r){return me(t)?this.list({},t):this._client.getAPIList("/vector_stores",Nn,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,r){return this._client.delete(`/vector_stores/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Nn extends je{}Rt.VectorStoresPage=Nn;Rt.Files=vn;Rt.VectorStoreFilesPage=nr;Rt.FileBatches=eo;class nt extends H{constructor(){super(...arguments),this.realtime=new gn(this._client),this.vectorStores=new Rt(this._client),this.chat=new Wr(this._client),this.assistants=new hn(this._client),this.threads=new It(this._client)}}nt.Realtime=gn;nt.VectorStores=Rt;nt.VectorStoresPage=Nn;nt.Assistants=hn;nt.AssistantsPage=xn;nt.Threads=It;class to extends H{create(t,r){return this._client.post("/completions",{body:t,...r,stream:t.stream??!1})}}class so extends H{create(t,r){return this._client.post("/embeddings",{body:t,...r})}}class _n extends H{create(t,r){return this._client.post("/files",Et({body:t,...r}))}retrieve(t,r){return this._client.get(`/files/${t}`,r)}list(t={},r){return me(t)?this.list({},t):this._client.getAPIList("/files",kn,{query:t,...r})}del(t,r){return this._client.delete(`/files/${t}`,r)}content(t,r){return this._client.get(`/files/${t}/content`,{...r,headers:{Accept:"application/binary",...r==null?void 0:r.headers},__binaryResponse:!0})}retrieveContent(t,r){return this._client.get(`/files/${t}/content`,r)}async waitForProcessing(t,{pollInterval:r=5e3,maxWait:n=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(t);for(;!o.status||!a.has(o.status);)if(await es(r),o=await this.retrieve(t),Date.now()-i>n)throw new dn({message:`Giving up on waiting for file ${t} to finish processing after ${n} milliseconds.`});return o}}class kn extends je{}_n.FileObjectsPage=kn;class Cn extends H{list(t,r={},n){return me(r)?this.list(t,{},r):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,Sn,{query:r,...n})}}class Sn extends je{}Cn.FineTuningJobCheckpointsPage=Sn;class Tt extends H{constructor(){super(...arguments),this.checkpoints=new Cn(this._client)}create(t,r){return this._client.post("/fine_tuning/jobs",{body:t,...r})}retrieve(t,r){return this._client.get(`/fine_tuning/jobs/${t}`,r)}list(t={},r){return me(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",En,{query:t,...r})}cancel(t,r){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,r)}listEvents(t,r={},n){return me(r)?this.listEvents(t,{},r):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,An,{query:r,...n})}}class En extends je{}class An extends je{}Tt.FineTuningJobsPage=En;Tt.FineTuningJobEventsPage=An;Tt.Checkpoints=Cn;Tt.FineTuningJobCheckpointsPage=Sn;class ns extends H{constructor(){super(...arguments),this.jobs=new Tt(this._client)}}ns.Jobs=Tt;ns.FineTuningJobsPage=En;ns.FineTuningJobEventsPage=An;class ro extends H{createVariation(t,r){return this._client.post("/images/variations",Et({body:t,...r}))}edit(t,r){return this._client.post("/images/edits",Et({body:t,...r}))}generate(t,r){return this._client.post("/images/generations",{body:t,...r})}}class Pn extends H{retrieve(t,r){return this._client.get(`/models/${t}`,r)}list(t){return this._client.getAPIList("/models",In,t)}del(t,r){return this._client.delete(`/models/${t}`,r)}}class In extends md{}Pn.ModelsPage=In;class no extends H{create(t,r){return this._client.post("/moderations",{body:t,...r})}}class ao extends H{create(t,r,n){return this._client.post(`/uploads/${t}/parts`,Et({body:r,...n}))}}class Rn extends H{constructor(){super(...arguments),this.parts=new ao(this._client)}create(t,r){return this._client.post("/uploads",{body:t,...r})}cancel(t,r){return this._client.post(`/uploads/${t}/cancel`,r)}complete(t,r,n){return this._client.post(`/uploads/${t}/complete`,{body:r,...n})}}Rn.Parts=ao;var io;class q extends Qc{constructor({baseURL:t=gs("OPENAI_BASE_URL"),apiKey:r=gs("OPENAI_API_KEY"),organization:n=gs("OPENAI_ORG_ID")??null,project:a=gs("OPENAI_PROJECT_ID")??null,...i}={}){if(r===void 0)throw new W("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:r,organization:n,project:a,...i,baseURL:t||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&cd())throw new W(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new to(this),this.chat=new rr(this),this.embeddings=new so(this),this.files=new _n(this),this.images=new ro(this),this.audio=new ts(this),this.moderations=new no(this),this.models=new Pn(this),this.fineTuning=new ns(this),this.beta=new nt(this),this.batches=new mn(this),this.uploads=new Rn(this),this._options=o,this.apiKey=r,this.organization=n,this.project=a}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(t){return Dc(t,{arrayFormat:"brackets"})}}io=q;q.OpenAI=io;q.DEFAULT_TIMEOUT=6e5;q.OpenAIError=W;q.APIError=oe;q.APIConnectionError=Ks;q.APIConnectionTimeoutError=dn;q.APIUserAbortError=Ce;q.NotFoundError=mi;q.ConflictError=ui;q.RateLimitError=xi;q.BadRequestError=li;q.AuthenticationError=ci;q.InternalServerError=fi;q.PermissionDeniedError=di;q.UnprocessableEntityError=hi;q.toFile=ji;q.fileFromPath=ii;q.Completions=to;q.Chat=rr;q.ChatCompletionsPage=sr;q.Embeddings=so;q.Files=_n;q.FileObjectsPage=kn;q.Images=ro;q.Audio=ts;q.Moderations=no;q.Models=Pn;q.ModelsPage=In;q.FineTuning=ns;q.Beta=nt;q.Batches=mn;q.BatchesPage=un;q.Uploads=Rn;async function kd(){var t,r;const{data:s}=await R.from("profiles").select("settings").eq("role","superadmin").limit(1).single();if(!((r=(t=s==null?void 0:s.settings)==null?void 0:t.openai)!=null&&r.api_key))throw new Error("OpenAI API key not configured. Please contact an administrator.");return{client:new q({apiKey:s.settings.openai.api_key,dangerouslyAllowBrowser:!0}),model:s.settings.openai.model||"gpt-4"}}const as=async(s,t)=>{try{const{client:r,model:n}=await kd(),i=(await r.chat.completions.create({model:n,messages:[{role:"system",content:`You are an experienced co-founder providing feedback and guidance. Your tone should be:
          - Supportive but direct
          - Focused on growth and execution
          - Pushing for excellence while being realistic
          - Asking probing questions to drive clarity
          
          Stay focused on the current topic - don't jump between sections.
          
          For accomplishments:
          - Celebrate wins but probe for learnings
          - Look for patterns of success
          - Connect accomplishments to larger goals
          
          For current work:
          - Focus on execution and removing blockers
          - Look for efficiency opportunities
          - Push for clear priorities
          
          For challenges:
          - Take a solution-focused approach
          - Break down problems into actionable steps
          - Share relevant experience/patterns
          
          For goals:
          - Push for clarity and measurability
          - Connect to company vision
          - Focus on execution planning`},{role:"user",content:`Generate feedback based on this update:

          Accomplished: ${s.accomplished}
          Working On: ${s.working_on}
          Blockers: ${s.blockers}
          Goals: ${s.goals}`}],temperature:.7,max_tokens:2e3})).choices[0].message.content;if(!i)throw new Error("No feedback generated");return{feedback:i,tasks:[]}}catch(r){throw console.error("Error generating tasks:",r),new Error(r.message||"Failed to generate tasks")}},Cd=({task:s,onUpdateTask:t,onRemoveTask:r,onAddTask:n,isExpanded:a,onToggleExpand:i,expandedSections:o,onToggleSection:l,suggestedTask:m=!1})=>{var j,f,S,N,O,T,I,P,C,k;const[c,g]=h.useState(!1),[u,p]=h.useState(!1),[d,y]=h.useState(s),b=async()=>{p(!0);try{const{tasks:E}=await as({accomplished:"",working_on:d.description,blockers:"",goals:d.title},"");if(E&&E.length>0){const A=E[0];y(D=>({...D,implementation_tips:A.implementation_tips||[],potential_challenges:A.potential_challenges||[],success_metrics:A.success_metrics||[],resources:A.resources||[],learning_resources:A.learning_resources||[],tools:A.tools||[]}))}}catch(E){console.error("Error generating AI suggestions:",E)}finally{p(!1)}},x=()=>{m&&n?n(d):t&&t(s.id,d),g(!1)},v=E=>{switch(E){case"completed":return e.jsx(Ct,{className:"h-5 w-5 text-green-500"});case"in_progress":return e.jsx(Le,{className:"h-5 w-5 text-yellow-500"});default:return e.jsx(fe,{className:"h-5 w-5 text-gray-400"})}},w=E=>{switch(E){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},_=E=>{switch(E){case"article":return e.jsx(he,{className:"h-4 w-4"});case"video":return e.jsx(Js,{className:"h-4 w-4"});case"tool":return e.jsx(Fe,{className:"h-4 w-4"});case"template":return e.jsx(he,{className:"h-4 w-4"});case"guide":return e.jsx(Oe,{className:"h-4 w-4"});default:return e.jsx(Q,{className:"h-4 w-4"})}};return c?e.jsx("div",{className:"bg-white shadow rounded-lg p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx("input",{type:"text",value:d.title,onChange:E=>y({...d,title:E.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{value:d.description,onChange:E=>y({...d,description:E.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Priority"}),e.jsxs("select",{value:d.priority,onChange:E=>y({...d,priority:E.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Due Date"}),e.jsx("input",{type:"date",value:d.due_date,onChange:E=>y({...d,due_date:E.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"AI Suggestions"}),e.jsx("button",{onClick:b,disabled:u,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:u?e.jsxs(e.Fragment,{children:[e.jsx(Vt,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Generate Suggestions"]})})]}),((j=d.implementation_tips)==null?void 0:j.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Implementation Tips"}),e.jsx("ul",{className:"space-y-1",children:d.implementation_tips.map((E,A)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("span",{className:"mr-2",children:"•"}),E]},A))})]}),((f=d.potential_challenges)==null?void 0:f.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Potential Challenges"}),e.jsx("ul",{className:"space-y-1",children:d.potential_challenges.map((E,A)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("span",{className:"mr-2",children:"•"}),E]},A))})]}),((S=d.success_metrics)==null?void 0:S.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Success Metrics"}),e.jsx("ul",{className:"space-y-1",children:d.success_metrics.map((E,A)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("span",{className:"mr-2",children:"•"}),E]},A))})]}),((N=d.resources)==null?void 0:N.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Resources"}),e.jsx("div",{className:"space-y-2",children:d.resources.map((E,A)=>e.jsx("div",{className:"flex items-center justify-between bg-white p-2 rounded border border-gray-200",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("a",{href:E.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[_(E.type),e.jsx("span",{className:"ml-2",children:E.title}),e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:E.description})]})},A))})]}),((O=d.learning_resources)==null?void 0:O.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Learning Resources"}),e.jsx("div",{className:"space-y-2",children:d.learning_resources.map((E,A)=>e.jsx("div",{className:"flex items-center justify-between bg-white p-2 rounded border border-gray-200",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("a",{href:E.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),E.title,e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsxs("p",{className:"text-xs text-gray-500 ml-6",children:[E.platform," • ",E.description]})]})},A))})]}),((T=d.tools)==null?void 0:T.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recommended Tools"}),e.jsx("div",{className:"space-y-2",children:d.tools.map((E,A)=>e.jsx("div",{className:"flex items-center justify-between bg-white p-2 rounded border border-gray-200",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("a",{href:E.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),E.name,e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",E.category,")"]}),e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:E.description})]})},A))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs("button",{onClick:()=>{y(s),g(!1)},className:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsx("button",{onClick:x,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:m?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Task"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})]})}):e.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:i,className:"flex items-center text-left flex-1",children:[a?e.jsx(ce,{className:"h-5 w-5 text-gray-400"}):e.jsx(Z,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{className:"ml-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.title}),!a&&e.jsxs("div",{className:"mt-1 flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{children:["Type: ",s.task_type]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Due: ",new Date(s.due_date).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w(s.priority)}`,children:s.priority}),m&&n&&e.jsxs("button",{onClick:()=>n(s),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-3 w-3 mr-1"}),"Add"]}),e.jsx("button",{onClick:()=>g(!0),className:"p-1 text-gray-400 hover:text-gray-500",children:e.jsx(Ma,{className:"h-4 w-4"})}),!m&&r&&e.jsx("button",{onClick:()=>r(s),className:"p-1 text-gray-400 hover:text-gray-500",children:e.jsx(de,{className:"h-4 w-4"})}),!m&&v(s.status)]})]}),a&&e.jsxs("div",{className:"mt-4 ml-7 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-900",children:s.description}),e.jsxs("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{children:["Type: ",s.task_type]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Category: ",s.category]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Estimated: ",s.estimated_hours,"h"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Due: ",new Date(s.due_date).toLocaleDateString()]})]})]}),((I=s.implementation_tips)==null?void 0:I.length)>0&&e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>l("tips"),className:"flex items-center text-sm font-medium text-gray-900",children:[e.jsx(Ze,{className:"h-4 w-4 mr-2"}),"Implementation Tips",o.tips?e.jsx(ce,{className:"h-4 w-4 ml-2"}):e.jsx(Z,{className:"h-4 w-4 ml-2"})]}),o.tips&&e.jsx("ul",{className:"mt-2 space-y-1 ml-6",children:s.implementation_tips.map((E,A)=>e.jsxs("li",{className:"text-sm text-gray-600",children:["• ",E]},A))})]}),((P=s.resources)==null?void 0:P.length)>0&&e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>l("resources"),className:"flex items-center text-sm font-medium text-gray-900",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Helpful Resources",o.resources?e.jsx(ce,{className:"h-4 w-4 ml-2"}):e.jsx(Z,{className:"h-4 w-4 ml-2"})]}),o.resources&&e.jsx("div",{className:"mt-2 space-y-2 ml-6",children:s.resources.map((E,A)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("a",{href:E.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[_(E.type),e.jsx("span",{className:"ml-2",children:E.title}),e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:E.description})]},A))})]}),((C=s.learning_resources)==null?void 0:C.length)>0&&e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>l("learning"),className:"flex items-center text-sm font-medium text-gray-900",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Learning Resources",o.learning?e.jsx(ce,{className:"h-4 w-4 ml-2"}):e.jsx(Z,{className:"h-4 w-4 ml-2"})]}),o.learning&&e.jsx("div",{className:"mt-2 space-y-3 ml-6",children:s.learning_resources.map((E,A)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("a",{href:E.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[_(E.type),e.jsx("span",{className:"ml-2",children:E.title}),e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsxs("p",{className:"text-xs text-gray-500 ml-6",children:[E.platform," • ",E.description]})]},A))})]}),((k=s.tools)==null?void 0:k.length)>0&&e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>l("tools"),className:"flex items-center text-sm font-medium text-gray-900",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Recommended Tools",o.tools?e.jsx(ce,{className:"h-4 w-4 ml-2"}):e.jsx(Z,{className:"h-4 w-4 ml-2"})]}),o.tools&&e.jsx("div",{className:"mt-2 space-y-3 ml-6",children:s.tools.map((E,A)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("a",{href:E.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),E.name,e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",E.category,")"]}),e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:E.description})]},A))})]}),!m&&t&&e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("select",{value:s.status,onChange:E=>t(s.id,{status:E.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"})]})})]})]})})})},Sd=({tasks:s,onUpdateTask:t,onAddTask:r,onRemoveTask:n,suggestedTasks:a=!1})=>{const[i,o]=h.useState({}),[l,m]=h.useState({}),c=u=>{o(p=>({...p,[u]:!p[u]}))},g=(u,p)=>{m(d=>{var y;return{...d,[u]:{...d[u]||{},[p]:!((y=d[u])!=null&&y[p])}}})};return e.jsx("div",{className:"space-y-4",children:s.map(u=>e.jsx(Cd,{task:u,onUpdateTask:t,onRemoveTask:n,onAddTask:r,isExpanded:i[u.id]||!1,onToggleExpand:()=>c(u.id),expandedSections:l[u.id]||{},onToggleSection:p=>g(u.id,p),suggestedTask:a},u.id))})},Ed={title:"",description:"",priority:"medium",status:"pending",category:"personal",task_type:"Other",estimated_hours:1,due_date:new Date().toISOString().split("T")[0],implementation_tips:[],potential_challenges:[],success_metrics:[],resources:[],learning_resources:[],tools:[]},Ad=({task:s,onSubmit:t,onCancel:r})=>{var g,u,p,d,y,b;const[n,a]=h.useState({...Ed,...s}),[i,o]=h.useState(!1),l=async()=>{if(!(!n.title||!n.description)){o(!0);try{const{tasks:x}=await as({accomplished:"",working_on:n.description,blockers:"",goals:n.title},"");if(x&&x.length>0){const v=x[0];a(w=>({...w,implementation_tips:v.implementation_tips||[],potential_challenges:v.potential_challenges||[],success_metrics:v.success_metrics||[],resources:v.resources||[],learning_resources:v.learning_resources||[],tools:v.tools||[]}))}}catch(x){console.error("Error generating AI suggestions:",x)}finally{o(!1)}}},m=x=>{x.preventDefault(),t(n)},c=x=>{switch(x){case"article":return e.jsx(he,{className:"h-4 w-4"});case"video":return e.jsx(Js,{className:"h-4 w-4"});case"tool":return e.jsx(Fe,{className:"h-4 w-4"});case"template":return e.jsx(he,{className:"h-4 w-4"});case"guide":return e.jsx(Oe,{className:"h-4 w-4"});default:return e.jsx(Q,{className:"h-4 w-4"})}};return e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx("input",{type:"text",id:"title",value:n.title,onChange:x=>a({...n,title:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{id:"description",value:n.description,onChange:x=>a({...n,description:x.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700",children:"Priority"}),e.jsxs("select",{id:"priority",value:n.priority,onChange:x=>a({...n,priority:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"task_type",className:"block text-sm font-medium text-gray-700",children:"Task Type"}),e.jsxs("select",{id:"task_type",value:n.task_type,onChange:x=>a({...n,task_type:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"Feature Development",children:"Feature Development"}),e.jsx("option",{value:"Bug Fix",children:"Bug Fix"}),e.jsx("option",{value:"Documentation",children:"Documentation"}),e.jsx("option",{value:"Research",children:"Research"}),e.jsx("option",{value:"Design",children:"Design"}),e.jsx("option",{value:"Planning",children:"Planning"}),e.jsx("option",{value:"Marketing",children:"Marketing"}),e.jsx("option",{value:"Sales",children:"Sales"}),e.jsx("option",{value:"Customer Support",children:"Customer Support"}),e.jsx("option",{value:"Infrastructure",children:"Infrastructure"}),e.jsx("option",{value:"Testing",children:"Testing"}),e.jsx("option",{value:"Analytics",children:"Analytics"}),e.jsx("option",{value:"Process Improvement",children:"Process Improvement"}),e.jsx("option",{value:"Team Coordination",children:"Team Coordination"}),e.jsx("option",{value:"Other",children:"Other"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"estimated_hours",className:"block text-sm font-medium text-gray-700",children:"Estimated Hours"}),e.jsx("input",{type:"number",id:"estimated_hours",value:n.estimated_hours,onChange:x=>a({...n,estimated_hours:parseFloat(x.target.value)}),min:"0.5",step:"0.5",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"due_date",className:"block text-sm font-medium text-gray-700",children:"Due Date"}),e.jsx("input",{type:"date",id:"due_date",value:n.due_date,onChange:x=>a({...n,due_date:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"AI Suggestions"}),e.jsx("button",{type:"button",onClick:l,disabled:i||!n.title||!n.description,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:i?e.jsxs(e.Fragment,{children:[e.jsx(Vt,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Generate Suggestions"]})})]}),((g=n.implementation_tips)==null?void 0:g.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Implementation Tips"}),e.jsx("ul",{className:"space-y-1",children:n.implementation_tips.map((x,v)=>e.jsxs("li",{className:"text-sm text-gray-600",children:["• ",x]},v))})]}),((u=n.potential_challenges)==null?void 0:u.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Potential Challenges"}),e.jsx("ul",{className:"space-y-1",children:n.potential_challenges.map((x,v)=>e.jsxs("li",{className:"text-sm text-gray-600",children:["• ",x]},v))})]}),((p=n.success_metrics)==null?void 0:p.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Success Metrics"}),e.jsx("ul",{className:"space-y-1",children:n.success_metrics.map((x,v)=>e.jsxs("li",{className:"text-sm text-gray-600",children:["• ",x]},v))})]}),((d=n.resources)==null?void 0:d.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Resources"}),e.jsx("div",{className:"space-y-2",children:n.resources.map((x,v)=>e.jsx("div",{className:"flex items-center justify-between bg-white p-2 rounded border border-gray-200",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[c(x.type),e.jsx("span",{className:"ml-2",children:x.title}),e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:x.description})]})},v))})]}),((y=n.learning_resources)==null?void 0:y.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Learning Resources"}),e.jsx("div",{className:"space-y-2",children:n.learning_resources.map((x,v)=>e.jsx("div",{className:"flex items-center justify-between bg-white p-2 rounded border border-gray-200",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),x.title,e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsxs("p",{className:"text-xs text-gray-500 ml-6",children:[x.platform," • ",x.description]})]})},v))})]}),((b=n.tools)==null?void 0:b.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recommended Tools"}),e.jsx("div",{className:"space-y-2",children:n.tools.map((x,v)=>e.jsx("div",{className:"flex items-center justify-between bg-white p-2 rounded border border-gray-200",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),x.name,e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",x.category,")"]}),e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:x.description})]})},v))})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs("button",{type:"button",onClick:r,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Save Task"]})]})]})},Pd=({isOpen:s,onClose:t,onTaskCreated:r,category:n="personal"})=>{if(!s)return null;const a=i=>{r({...i,category:n}),t()};return e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:t}),e.jsx("div",{className:"relative w-full max-w-2xl bg-white rounded-lg shadow-xl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Task"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:e.jsx(de,{className:"h-5 w-5"})})]}),e.jsx(Ad,{onSubmit:a,onCancel:t})]})})]})})},zr=({category:s="personal",showCompleted:t=!1})=>{const[r,n]=h.useState([]),[a,i]=h.useState([]),[o,l]=h.useState({total:0,completed:0,inProgress:0,pending:0,overdue:0,highPriority:0,estimatedHours:0,completedHours:0}),[m,c]=h.useState(!1),[g,u]=h.useState("due_date"),[p,d]=h.useState("asc"),[y,b]=h.useState(!1),[x,v]=h.useState({status:[],priority:[],type:[]}),[w,_]=h.useState(!0),[j,f]=h.useState(!1);h.useEffect(()=>{S()},[s]),h.useEffect(()=>{O()},[r,x,g,p,t]);const S=async()=>{try{let k=R.from("standup_tasks").select("*").order("created_at",{ascending:!1});s&&(k=k.eq("category",s));const{data:E,error:A}=await k;if(A)throw A;n(E||[])}catch(k){console.error("Error loading tasks:",k)}finally{_(!1)}},N=k=>{const E=new Date,A={total:k.length,completed:k.filter(D=>D.status==="completed").length,inProgress:k.filter(D=>D.status==="in_progress").length,pending:k.filter(D=>D.status==="pending").length,overdue:k.filter(D=>D.status!=="completed"&&new Date(D.due_date)<E).length,highPriority:k.filter(D=>D.priority==="high").length,estimatedHours:k.reduce((D,$)=>D+($.estimated_hours||0),0),completedHours:k.filter(D=>D.status==="completed").reduce((D,$)=>D+($.estimated_hours||0),0)};l(A)},O=()=>{let k=[...r];t||(k=k.filter(E=>E.status!=="completed")),x.status.length>0&&(k=k.filter(E=>x.status.includes(E.status))),x.priority.length>0&&(k=k.filter(E=>x.priority.includes(E.priority))),x.type.length>0&&(k=k.filter(E=>x.type.includes(E.task_type))),k.sort((E,A)=>{let D=0;return g==="due_date"?D=new Date(E[g]).getTime()-new Date(A[g]).getTime():D=String(E[g]).localeCompare(String(A[g])),p==="asc"?D:-D}),i(k),N(k)},T=async(k,E)=>{try{const{error:A}=await R.from("standup_tasks").update(E).eq("id",k);if(A)throw A;n(D=>D.map($=>$.id===k?{...$,...E}:$))}catch(A){console.error("Error updating task:",A)}},I=async k=>{try{const{data:E,error:A}=await R.from("standup_tasks").insert([{...k,category:s,implementation_tips:k.implementation_tips||[],potential_challenges:k.potential_challenges||[],success_metrics:k.success_metrics||[],resources:k.resources||[],learning_resources:k.learning_resources||[],tools:k.tools||[]}]).select().single();if(A)throw A;E&&n(D=>[E,...D])}catch(E){console.error("Error creating task:",E)}},P=k=>{g===k?d(E=>E==="asc"?"desc":"asc"):(u(k),d("asc"))},C=(k,E)=>{v(A=>({...A,[k]:A[k].includes(E)?A[k].filter(D=>D!==E):[...A[k],E]}))};return w?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading tasks..."})]}):e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>c(!m),className:"flex items-center text-lg font-medium text-gray-900",children:[m?e.jsx(ce,{className:"h-5 w-5 mr-2"}):e.jsx(Z,{className:"h-5 w-5 mr-2"}),"Tasks"]}),!m&&e.jsxs("div",{className:"ml-6 flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"h-4 w-4 text-yellow-500 mr-1.5"}),e.jsx("span",{className:"text-sm text-gray-600",children:o.inProgress})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(fe,{className:"h-4 w-4 text-red-500 mr-1.5"}),e.jsx("span",{className:"text-sm text-gray-600",children:o.overdue})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ct,{className:"h-4 w-4 text-green-500 mr-1.5"}),e.jsx("span",{className:"text-sm text-gray-600",children:o.completed})]})]}),e.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Create Task"]})]}),m&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-4 grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-blue-800",children:"Total Tasks"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-blue-900",children:o.total})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-green-800",children:"Completed"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-green-900",children:o.completed})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-yellow-800",children:"In Progress"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-yellow-900",children:o.inProgress})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-red-800",children:"Overdue"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-red-900",children:o.overdue})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsxs("button",{onClick:()=>b(!y),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(tn,{className:"h-4 w-4 mr-2"}),"Filters"]})}),y&&e.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Status"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["pending","in_progress","completed"].map(k=>e.jsxs("button",{onClick:()=>C("status",k),className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium ${x.status.includes(k)?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-800"}`,children:[k==="completed"&&e.jsx(Ct,{className:"h-4 w-4 mr-1"}),k==="in_progress"&&e.jsx(Le,{className:"h-4 w-4 mr-1"}),k==="pending"&&e.jsx(fe,{className:"h-4 w-4 mr-1"}),k.charAt(0).toUpperCase()+k.slice(1)]},k))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Priority"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["low","medium","high"].map(k=>e.jsx("button",{onClick:()=>C("priority",k),className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium ${x.priority.includes(k)?k==="high"?"bg-red-100 text-red-800":k==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:k.charAt(0).toUpperCase()+k.slice(1)},k))})]})]})})]})]}),m&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4 flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>P("due_date"),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:["Due Date",g==="due_date"&&(p==="asc"?e.jsx(mr,{className:"h-4 w-4 ml-1"}):e.jsx(ur,{className:"h-4 w-4 ml-1"}))]}),e.jsxs("button",{onClick:()=>P("priority"),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:["Priority",g==="priority"&&(p==="asc"?e.jsx(mr,{className:"h-4 w-4 ml-1"}):e.jsx(ur,{className:"h-4 w-4 ml-1"}))]}),e.jsxs("button",{onClick:()=>P("status"),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:["Status",g==="status"&&(p==="asc"?e.jsx(mr,{className:"h-4 w-4 ml-1"}):e.jsx(ur,{className:"h-4 w-4 ml-1"}))]})]}),e.jsx(Sd,{tasks:a,onUpdateTask:T})]}),e.jsx(Pd,{isOpen:j,onClose:()=>f(!1),onTaskCreated:I,category:s})]})},Id=({entries:s})=>{const[t,r]=h.useState(!1),[n,a]=h.useState({}),[i,o]=h.useState(""),[l,m]=h.useState("date"),[c,g]=h.useState("desc"),[u,p]=h.useState({hasBlockers:!1,dateRange:"all"}),[d,y]=h.useState(!1),[b,x]=h.useState(s);h.useEffect(()=>{_()},[s,i,l,c,u]);const v=j=>{a(f=>({...f,[j]:!f[j]}))},w=j=>{l===j?g(f=>f==="asc"?"desc":"asc"):(m(j),g("desc"))},_=()=>{let j=[...s];if(i){const f=i.toLowerCase();j=j.filter(S=>{var N;return S.accomplished.toLowerCase().includes(f)||S.working_on.toLowerCase().includes(f)||((N=S.blockers)==null?void 0:N.toLowerCase().includes(f))||S.goals.toLowerCase().includes(f)})}if(u.hasBlockers&&(j=j.filter(f=>f.blockers&&f.blockers.trim().length>0)),u.dateRange!=="all"){const f=new Date,S=new Date;switch(u.dateRange){case"week":S.setDate(f.getDate()-7);break;case"month":S.setMonth(f.getMonth()-1);break;case"quarter":S.setMonth(f.getMonth()-3);break}j=j.filter(N=>new Date(N.date)>=S)}j.sort((f,S)=>{let N=0;switch(l){case"date":N=new Date(S.date).getTime()-new Date(f.date).getTime();break;default:N=S[l].localeCompare(f[l])}return c==="asc"?-N:N}),x(j)};return s.length?e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("button",{onClick:()=>r(!t),className:"flex items-center text-lg font-medium text-gray-900",children:[e.jsx(Ms,{className:"h-5 w-5 mr-2 text-gray-400"}),"Recent Standups",t?e.jsx(ce,{className:"h-5 w-5 ml-2 text-gray-400"}):e.jsx(Z,{className:"h-5 w-5 ml-2 text-gray-400"})]})})}),t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(rt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"search",value:i,onChange:j=>o(j.target.value),placeholder:"Search standups...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})}),e.jsxs("button",{onClick:()=>y(!d),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(tn,{className:"h-4 w-4 mr-2"}),"Filters"]})]}),d&&e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.hasBlockers,onChange:j=>p(f=>({...f,hasBlockers:j.target.checked})),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Has Blockers"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Date Range:"}),e.jsxs("select",{value:u.dateRange,onChange:j=>p(f=>({...f,dateRange:j.target.value})),className:"rounded-md border-gray-300 text-sm focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"quarter",children:"Past Quarter"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Sort By:"}),e.jsxs("select",{value:l,onChange:j=>w(j.target.value),className:"rounded-md border-gray-300 text-sm focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"accomplished",children:"Accomplishments"}),e.jsx("option",{value:"working_on",children:"Current Work"}),e.jsx("option",{value:"goals",children:"Goals"})]}),e.jsx("button",{onClick:()=>g(j=>j==="asc"?"desc":"asc"),className:"p-1 rounded-md hover:bg-gray-100",children:c==="asc"?e.jsx(ll,{className:"h-4 w-4 text-gray-400"}):e.jsx(cl,{className:"h-4 w-4 text-gray-400"})})]})]})]}),e.jsx("div",{className:"divide-y divide-gray-200",children:b.map(j=>e.jsxs("div",{className:"p-6",children:[e.jsxs("button",{onClick:()=>v(j.id),className:"w-full flex items-center justify-between text-left",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:new Date(j.date).toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),!n[j.id]&&e.jsx("p",{className:"mt-1 text-sm text-gray-500 line-clamp-2",children:j.working_on})]}),n[j.id]?e.jsx(ce,{className:"h-5 w-5 text-gray-400"}):e.jsx(Z,{className:"h-5 w-5 text-gray-400"})]}),n[j.id]&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-900 flex items-center",children:[e.jsx(dl,{className:"h-4 w-4 mr-2 text-gray-400"}),"Accomplished"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:j.accomplished})]}),e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-900 flex items-center",children:[e.jsx(Le,{className:"h-4 w-4 mr-2 text-gray-400"}),"Working On"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:j.working_on})]}),j.blockers&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-900 flex items-center",children:[e.jsx(fe,{className:"h-4 w-4 mr-2 text-gray-400"}),"Blockers"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:j.blockers})]}),e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-900 flex items-center",children:[e.jsx(sn,{className:"h-4 w-4 mr-2 text-gray-400"}),"Goals"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:j.goals})]}),j.feedback&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900",children:"AI Analysis"}),e.jsx("div",{className:"mt-1 text-sm text-gray-500 whitespace-pre-wrap rounded-lg bg-gray-50 p-4",children:(()=>{try{const S=JSON.parse(j.feedback).insights;return`🎯 Key Insights

${S.strengths.length>0?`Strengths:
${S.strengths.map(N=>`• ${N}`).join(`
`)}

`:""}${S.areas_for_improvement.length>0?`Areas for Improvement:
${S.areas_for_improvement.map(N=>`• ${N}`).join(`
`)}

`:""}${S.opportunities.length>0?`Opportunities:
${S.opportunities.map(N=>`• ${N}`).join(`
`)}

`:""}${S.risks.length>0?`Risks:
${S.risks.map(N=>`• ${N}`).join(`
`)}

`:""}${S.strategic_recommendations.length>0?`Strategic Recommendations:
${S.strategic_recommendations.map(N=>`• ${N}`).join(`
`)}`:""}`}catch{return""}})()})]})]})]},j.id))})]})]}):e.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ms,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No standup history"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Start your day by sharing your progress and goals."}),e.jsx("div",{className:"mt-6",children:e.jsx(G,{to:"/idea-hub/cofounder-bot",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:"Start Daily Standup"})})]})})};function Rd({isOpen:s,onClose:t,onSuccess:r}){const[n,a]=h.useState(""),[i,o]=h.useState(!1),[l,m]=h.useState("");if(!s)return null;const c=async g=>{if(g.preventDefault(),!!n.trim()){o(!0),m("");try{const{data:u,error:p}=await R.rpc("join_company_by_code",{code:n.trim()});if(p)throw p;r(),t()}catch(u){console.error("Error joining company:",u),m(u.message)}finally{o(!1)}}};return e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:t}),e.jsx("div",{className:"relative w-full max-w-md rounded-lg bg-white shadow-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Join Company"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:e.jsx(de,{className:"h-5 w-5"})})]}),l&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 rounded-md",children:e.jsx("p",{className:"text-sm text-red-700",children:l})}),e.jsxs("form",{onSubmit:c,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-700",children:"Invitation Code"}),e.jsx("input",{type:"text",id:"code",value:n,onChange:g=>a(g.target.value.toUpperCase()),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter company invitation code",required:!0})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:t,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:i||!n.trim(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:[e.jsx(Fa,{className:"h-4 w-4 mr-2"}),i?"Joining...":"Join Company"]})]})]})]})})]})})}function Td(){var x;const{profile:s}=X(),[t,r]=h.useState(!1),[n,a]=h.useState([]),[i,o]=h.useState(!1),[l,m]=h.useState(!0),[c,g]=h.useState("");h.useEffect(()=>{s&&(u(),p())},[s]);const u=async()=>{if(s)try{m(!0),g("");const{data:v,error:w}=await R.from("companies").select("id").eq("owner_id",s.id);if(w)throw w;if(v&&v.length>0){r(!0);return}const{data:_,error:j}=await R.from("company_members").select("company_id").eq("user_id",s.id);if(j)throw j;r(_&&_.length>0)}catch(v){console.error("Error checking company access:",v),g(v.message)}finally{m(!1)}},p=async()=>{if(s)try{const{data:v}=await R.from("standup_entries").select(`
          *,
          tasks:standup_tasks(*)
        `).eq("user_id",s.id).order("date",{ascending:!1}).limit(5);v&&a(v)}catch(v){console.error("Error loading standup entries:",v)}},d=[{title:"Technical Docs",description:"API guides & documentation",icon:ml,action:"View Docs",link:"#"},{title:"Startup Guides",description:"Best practices & tutorials",icon:$a,action:"Explore Guides",link:"#"},{title:"Templates",description:"Ready-to-use documents",icon:he,action:"Browse Templates",link:"#"},{title:"Learning Paths",description:"Structured courses",icon:ul,action:"Start Learning",link:"#"}],y=[{type:"message",title:"New message from Advisor",description:"John Davis shared feedback on your pitch deck",time:"2 hours ago",icon:Ee},{type:"document",title:"Document update",description:"Business plan template has been updated",time:"4 hours ago",icon:he},{type:"connection",title:"New connection request",description:"Sarah Miller wants to connect",time:"6 hours ago",icon:xe}],b=[{category:"Community & Network",items:[{title:"Founder Meetup",description:"Tomorrow at 2:00 PM",icon:xe},{title:"Active Discussions",description:"12 new topics",icon:Ee}]},{category:"Marketplace Updates",items:[{title:"Legal Consultation",description:"New service provider added",icon:ut},{title:"Analytics Dashboard",description:"Recommended tool",icon:La}]}];return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900",children:["Welcome back, ",((x=s==null?void 0:s.full_name)==null?void 0:x.split(" ")[0])||"User"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Here's what's happening in your founder journey"})]}),e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg shadow-lg overflow-hidden",children:e.jsx("div",{className:"px-6 py-8 sm:p-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Qt,{className:"h-8 w-8 text-white"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"AI Co-founder"}),e.jsx("p",{className:"text-indigo-100",children:"Your personal startup advisor"})]})]}),e.jsx(G,{to:"/idea-hub/cofounder-bot",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-indigo-600 bg-white hover:bg-indigo-50",children:"Start Daily Standup"})]})})})}),!t&&e.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Set Up Your Company"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Create your company profile or join an existing one."})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Join Company"}),e.jsx(G,{to:"/company/setup",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:"Set Up Company"})]})]})}),e.jsx("div",{className:"mb-8",children:e.jsx(zr,{showCompleted:!1})}),e.jsx("div",{className:"mb-8",children:e.jsx(Id,{entries:n})}),e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4 mb-8",children:d.map((v,w)=>e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(v.icon,{className:"h-6 w-6 text-indigo-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:v.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:v.description})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("a",{href:v.link,className:"inline-flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-900",children:[v.action,e.jsx(Z,{className:"ml-1 h-4 w-4"})]})})]})},w))}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Recent Activities"}),e.jsx("a",{href:"#",className:"text-sm text-indigo-600 hover:text-indigo-900",children:"View all"})]}),e.jsx("div",{className:"bg-white shadow rounded-lg divide-y divide-gray-200",children:y.map((v,w)=>e.jsx("div",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(v.icon,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:v.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:v.description})]}),e.jsx("div",{className:"ml-3 flex-shrink-0",children:e.jsx("p",{className:"text-sm text-gray-500",children:v.time})})]})},w))})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:b.map((v,w)=>e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:v.category}),e.jsx("div",{className:"space-y-4",children:v.items.map((_,j)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(_.icon,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:_.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:_.description})]})]},j))})]})},w))}),e.jsx(Rd,{isOpen:i,onClose:()=>o(!1),onSuccess:()=>{o(!1),window.location.href="/company/dashboard"}})]})})}async function oo(s){var r,n;const{data:t}=await R.from("profiles").select("cloud_storage").eq("id",(r=(await R.auth.getUser()).data.user)==null?void 0:r.id).single();return(n=t==null?void 0:t.cloud_storage)!=null&&n[s]?t.cloud_storage[s]:null}async function Dd(){var s,t;try{const r=await oo("google");if(!r){const{data:n}=await R.from("profiles").select("settings").eq("role","superadmin").single();if(!((t=(s=n==null?void 0:n.settings)==null?void 0:s.app_credentials)!=null&&t.google))throw new Error("Google OAuth credentials not configured. Please contact an administrator.");const{client_id:a}=n.settings.app_credentials.google;if(!a)throw new Error("Google Client ID not configured. Please contact an administrator.");const i=["https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/presentations"],o=600,l=600,m=window.screenX+(window.outerWidth-o)/2,c=window.screenY+(window.outerHeight-l)/2,u=`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({client_id:a,redirect_uri:`${window.location.origin}/auth/google/callback`,response_type:"code",scope:i.join(" "),access_type:"offline",prompt:"consent"}).toString()}`,p=window.open(u,"Google OAuth",`width=${o},height=${l},left=${m},top=${c},popup=1`);if(!p)throw new Error("Failed to open popup window. Please allow popups for this site.");return new Promise((d,y)=>{let b,x;const v=async _=>{var j,f;try{if(_.origin!==window.location.origin)return;if(((j=_.data)==null?void 0:j.type)==="oauth_callback"&&((f=_.data)==null?void 0:f.provider)==="google"){if(w(),_.data.error)throw new Error(_.data.error);if(!_.data.code)throw new Error("No authorization code received");const S=await Fd("google",_.data.code);d(S)}}catch(S){w(),y(S)}},w=()=>{clearTimeout(b),clearInterval(x),window.removeEventListener("message",v),p&&!p.closed&&p.close()};window.addEventListener("message",v),x=window.setInterval(()=>{p.closed&&(w(),y(new Error("Authentication cancelled")))},1e3),b=window.setTimeout(()=>{w(),y(new Error("Authentication timed out"))},12e4)})}return r}catch(r){throw console.error("Error connecting to google:",r),new Error(r.message||"Failed to connect to Google. Please try again.")}}async function Od(s,t){var a,i;const{data:r}=await R.from("profiles").select("cloud_storage").eq("id",(a=(await R.auth.getUser()).data.user)==null?void 0:a.id).single(),n={...r==null?void 0:r.cloud_storage,[s]:{provider:s,...t}};await R.from("profiles").update({cloud_storage:n}).eq("id",(i=(await R.auth.getUser()).data.user)==null?void 0:i.id)}async function Fd(s,t){var r,n;try{const{data:a}=await R.from("profiles").select("settings").eq("role","superadmin").single();if(!((n=(r=a==null?void 0:a.settings)==null?void 0:r.app_credentials)!=null&&n[s]))throw new Error(`${s} OAuth credentials not configured. Please contact an administrator.`);const{client_id:i,client_secret:o}=a.settings.app_credentials[s];if(!i||!o)throw new Error(`Missing required ${s} OAuth configuration. Please contact an administrator.`);const l=new URLSearchParams({code:t,client_id:i,client_secret:o,redirect_uri:`${window.location.origin}/auth/google/callback`,grant_type:"authorization_code"}),m=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toString()});if(!m.ok){const u=await m.json();throw new Error(u.error_description||"Failed to exchange authorization code for tokens")}const c=await m.json(),g={provider:s,access_token:c.access_token,refresh_token:c.refresh_token,expires_at:Date.now()+c.expires_in*1e3,scopes:["drive","slides"]};return await Od(s,g),g}catch(a){throw console.error("Error in handleOAuthCallback:",a),new Error(a.message||"Failed to complete authentication")}}function lo({companyId:s,onComplete:t}){const[r,n]=h.useState(!1),[a,i]=h.useState(!0),[o,l]=h.useState(""),[m,c]=h.useState("");h.useEffect(()=>{g()},[]);const g=async()=>{try{const p=await oo("google");n(!!p)}catch(p){console.error("Error checking cloud connections:",p),l("Failed to check cloud storage connections")}finally{i(!1)}},u=async p=>{try{l(""),c(""),await Dd()&&(n(!0),c("Successfully connected to Google Drive!"),t==null||t())}catch(d){console.error(`Error connecting to ${p}:`,d),l(d.message||`Failed to connect to ${p}`)}};return a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Checking cloud storage connections..."})]}):e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(hl,{className:"h-5 w-5 mr-2"}),"Cloud Storage Setup"]})}),o&&e.jsx("div",{className:"px-6 py-4 bg-red-50",children:e.jsxs("div",{className:"flex",children:[e.jsx(fe,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:o})})]})}),m&&e.jsx("div",{className:"px-6 py-4 bg-green-50",children:e.jsxs("div",{className:"flex",children:[e.jsx(Er,{className:"h-5 w-5 text-green-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-green-700",children:m})})]})}),e.jsxs("div",{className:"px-6 py-5 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(xl,{className:"h-8 w-8 text-gray-400"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Google Drive"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Connect to access your documents and slides"})]})]}),r?e.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium bg-green-100 text-green-800",children:[e.jsx(Er,{className:"h-4 w-4 mr-1"}),"Connected"]}):e.jsx("button",{onClick:()=>u("google"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:"Connect"})]}),e.jsxs("div",{className:"mt-6 bg-gray-50 p-4 rounded-md",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900",children:"Why connect cloud storage?"}),e.jsxs("ul",{className:"mt-2 text-sm text-gray-500 space-y-1",children:[e.jsx("li",{children:"• Access and edit your documents directly in the platform"}),e.jsx("li",{children:"• Automatically sync pitch decks with Google Slides"}),e.jsx("li",{children:"• Collaborate with team members in real-time"}),e.jsx("li",{children:"• Keep all your startup documents organized in one place"})]})]})]})]})}function Md(){const{profile:s,setProfile:t}=X(),[r,n]=h.useState(!(s!=null&&s.full_name)),[a,i]=h.useState(!1),[o,l]=h.useState({full_name:(s==null?void 0:s.full_name)||"",is_public:(s==null?void 0:s.is_public)||!1,allows_messages:(s==null?void 0:s.allows_messages)||!1,avatar_url:(s==null?void 0:s.avatar_url)||"",professional_background:(s==null?void 0:s.professional_background)||"",social_links:(s==null?void 0:s.social_links)||{linkedin:"",twitter:"",github:"",website:""}}),[m,c]=h.useState((s==null?void 0:s.dashboard_layout)||{widgets:[{id:"tasks",name:"Tasks",enabled:!0,position:[0,0],size:[6,4],category:"core"},{id:"standup",name:"Standup History",enabled:!0,position:[6,0],size:[6,4],category:"core"},{id:"activities",name:"Recent Activities",enabled:!0,position:[0,6],size:[6,4],category:"core"},{id:"updates",name:"Updates",enabled:!0,position:[6,6],size:[6,4],category:"core"},{id:"idea_canvas",name:"Idea Canvas",enabled:!1,position:[0,8],size:[6,4],category:"idea-hub"},{id:"market_research",name:"Market Research",enabled:!1,position:[6,8],size:[6,4],category:"idea-hub"},{id:"business_model",name:"Business Model",enabled:!1,position:[0,12],size:[6,4],category:"idea-hub"},{id:"pitch_deck",name:"Pitch Deck",enabled:!1,position:[6,12],size:[6,4],category:"idea-hub"},{id:"resources",name:"Resource Library",enabled:!0,position:[0,4],size:[12,2],category:"idea-hub"},{id:"community_feed",name:"Community Feed",enabled:!1,position:[0,16],size:[6,4],category:"community"},{id:"community_events",name:"Upcoming Events",enabled:!1,position:[6,16],size:[6,4],category:"community"},{id:"company_metrics",name:"Company Metrics",enabled:!1,position:[0,20],size:[6,4],category:"company"},{id:"team_updates",name:"Team Updates",enabled:!1,position:[6,20],size:[6,4],category:"company"},{id:"documents",name:"Documents",enabled:!1,position:[0,24],size:[12,4],category:"company"}]}),g=b=>{const{name:x,value:v,type:w}=b.target;l(_=>({..._,[x]:w==="checkbox"?b.target.checked:v}))},u=(b,x)=>{l(v=>({...v,social_links:{...v.social_links,[b]:x}}))},p=async b=>{var v;const x=(v=b.target.files)==null?void 0:v[0];if(!(!x||!s))try{i(!0);const w=x.name.split(".").pop(),_=`${s.id}-${Math.random()}.${w}`,{error:j}=await R.storage.from("avatars").upload(_,x);if(j)throw j;const{data:{publicUrl:f}}=R.storage.from("avatars").getPublicUrl(_);l(S=>({...S,avatar_url:f}))}catch(w){console.error("Error uploading avatar:",w)}finally{i(!1)}},d=async b=>{b.preventDefault(),i(!0);try{const{data:x,error:v}=await R.from("profiles").update({...o,dashboard_layout:m,updated_at:new Date().toISOString()}).eq("id",s==null?void 0:s.id).select().single();if(v)throw v;x&&(t(x),n(!1))}catch(x){console.error("Error updating profile:",x)}finally{i(!1)}},y=b=>{c(x=>({...x,widgets:x.widgets.map(v=>v.id===b?{...v,enabled:!v.enabled}:v)}))};return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Ar,{className:"h-6 w-6"}),r?"Complete Your Profile":"Profile Settings"]}),e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("form",{onSubmit:d,className:"divide-y divide-gray-200",children:[e.jsx("div",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-32 w-32 rounded-full overflow-hidden bg-gray-100 border-4 border-white shadow-lg",children:o.avatar_url?e.jsx("img",{src:o.avatar_url,alt:"Profile",className:"h-full w-full object-cover"}):e.jsx(Ar,{className:"h-full w-full p-4 text-gray-400"})}),r&&e.jsxs("label",{htmlFor:"avatar",className:"mt-4 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 cursor-pointer",children:[e.jsx(fl,{className:"h-4 w-4 mr-2"}),"Upload Photo",e.jsx("input",{type:"file",id:"avatar",accept:"image/*",onChange:p,className:"sr-only",disabled:!r})]})]})}),e.jsxs("div",{className:"px-6 py-5",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Basic Information"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("input",{type:"text",id:"full_name",name:"full_name",value:o.full_name,onChange:g,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",disabled:!r,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"professional_background",className:"block text-sm font-medium text-gray-700",children:"Professional Background"}),e.jsx("textarea",{id:"professional_background",name:"professional_background",rows:4,value:o.professional_background,onChange:g,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",disabled:!r,placeholder:"Tell us about your professional experience..."})]})]})]}),e.jsxs("div",{className:"px-6 py-5",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Social Links"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"linkedin",className:"block text-sm text-gray-500",children:"LinkedIn"}),e.jsx("input",{type:"url",id:"linkedin",value:o.social_links.linkedin,onChange:b=>u("linkedin",b.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",disabled:!r,placeholder:"https://linkedin.com/in/..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"twitter",className:"block text-sm text-gray-500",children:"Twitter"}),e.jsx("input",{type:"url",id:"twitter",value:o.social_links.twitter,onChange:b=>u("twitter",b.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",disabled:!r,placeholder:"https://twitter.com/..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"github",className:"block text-sm text-gray-500",children:"GitHub"}),e.jsx("input",{type:"url",id:"github",value:o.social_links.github,onChange:b=>u("github",b.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",disabled:!r,placeholder:"https://github.com/..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"website",className:"block text-sm text-gray-500",children:"Personal Website"}),e.jsx("input",{type:"url",id:"website",value:o.social_links.website,onChange:b=>u("website",b.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",disabled:!r,placeholder:"https://..."})]})]})]}),e.jsxs("div",{className:"px-6 py-5",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Privacy Settings"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_public",name:"is_public",checked:o.is_public,onChange:g,className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",disabled:!r}),e.jsx("label",{htmlFor:"is_public",className:"ml-2 block text-sm text-gray-900",children:"Make profile public"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"allows_messages",name:"allows_messages",checked:o.allows_messages,onChange:g,className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",disabled:!r}),e.jsx("label",{htmlFor:"allows_messages",className:"ml-2 block text-sm text-gray-900",children:"Allow other users to send me messages"})]})]})]}),e.jsxs("div",{className:"px-6 py-5",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cloud Storage"}),e.jsx(lo,{})]}),e.jsxs("div",{className:"px-6 py-5",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Dashboard Layout"}),e.jsxs("div",{className:"mt-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Core Features"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.widgets.filter(b=>b.category==="core").map(b=>e.jsxs("button",{type:"button",onClick:()=>y(b.id),className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium ${b.enabled?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-800"}`,children:[b.enabled?e.jsx(Ge,{className:"h-4 w-4 mr-1"}):e.jsx(B,{className:"h-4 w-4 mr-1"}),b.name]},b.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Idea Hub"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.widgets.filter(b=>b.category==="idea-hub").map(b=>e.jsxs("button",{type:"button",onClick:()=>y(b.id),className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium ${b.enabled?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-800"}`,children:[b.enabled?e.jsx(Ge,{className:"h-4 w-4 mr-1"}):e.jsx(B,{className:"h-4 w-4 mr-1"}),b.name]},b.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Community"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.widgets.filter(b=>b.category==="community").map(b=>e.jsxs("button",{type:"button",onClick:()=>y(b.id),className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium ${b.enabled?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-800"}`,children:[b.enabled?e.jsx(Ge,{className:"h-4 w-4 mr-1"}):e.jsx(B,{className:"h-4 w-4 mr-1"}),b.name]},b.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Company"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.widgets.filter(b=>b.category==="company").map(b=>e.jsxs("button",{type:"button",onClick:()=>y(b.id),className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium ${b.enabled?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-800"}`,children:[b.enabled?e.jsx(Ge,{className:"h-4 w-4 mr-1"}):e.jsx(B,{className:"h-4 w-4 mr-1"}),b.name]},b.id))})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Select which widgets you want to see on your dashboard. Changes will be applied after saving."})]})]}),e.jsx("div",{className:"px-6 py-5",children:e.jsx("div",{className:"flex justify-end space-x-3",children:r?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>{n(!1),l({full_name:(s==null?void 0:s.full_name)||"",is_public:(s==null?void 0:s.is_public)||!1,allows_messages:(s==null?void 0:s.allows_messages)||!1,avatar_url:(s==null?void 0:s.avatar_url)||"",professional_background:(s==null?void 0:s.professional_background)||"",social_links:(s==null?void 0:s.social_links)||{linkedin:"",twitter:"",github:"",website:""}}),c((s==null?void 0:s.dashboard_layout)||{widgets:defaultWidgets})},className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:a,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]}):e.jsx("button",{type:"button",onClick:()=>n(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Edit Profile"})})})]})})})]})})}function $d(){const[s,t]=h.useState(""),[r,n]=h.useState([]),[a,i]=h.useState(!1),[o,l]=h.useState([]),[m,c]=h.useState([]),[g,u]=h.useState([]),[p,d]=h.useState(!1),y=[{value:"mentoring",label:"Mentoring"},{value:"investing",label:"Investing"},{value:"advising",label:"Advising"},{value:"cofounding",label:"Co-founding"}];h.useEffect(()=>{b()},[s,o,m,g]);const b=async()=>{i(!0);try{const{data:x,error:v}=await R.rpc("search_profiles",{search_query:s?s.replace(/\s+/g," & "):null,filter_skills:o.length>0?o:null,filter_interests:m.length>0?m:null,filter_available_for:g.length>0?g:null});if(v)throw v;n(x||[])}catch(x){console.error("Error searching profiles:",x)}finally{i(!1)}};return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center",children:[e.jsx(xe,{className:"h-6 w-6 mr-2"}),"Directory"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Connect with founders, mentors, and advisors"})]}),e.jsxs("button",{onClick:()=>d(!p),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(tn,{className:"h-4 w-4 mr-2"}),"Filters"]})]}),e.jsxs("div",{className:"mb-8 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(rt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"search",value:s,onChange:x=>t(x.target.value),placeholder:"Search by name, skills, or interests...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),p&&e.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Skills"}),e.jsx("input",{type:"text",placeholder:"Add skills...",onKeyDown:x=>{if(x.key==="Enter"){const v=x.target,w=v.value.trim();w&&!o.includes(w)&&(l([...o,w]),v.value="")}},className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:o.map(x=>e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:[x,e.jsx("button",{type:"button",onClick:()=>l(o.filter(v=>v!==x)),className:"ml-1 inline-flex items-center p-0.5 rounded-full text-indigo-400 hover:bg-indigo-200 hover:text-indigo-500",children:e.jsx(de,{className:"h-3 w-3"})})]},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Interests"}),e.jsx("input",{type:"text",placeholder:"Add interests...",onKeyDown:x=>{if(x.key==="Enter"){const v=x.target,w=v.value.trim();w&&!m.includes(w)&&(c([...m,w]),v.value="")}},className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:m.map(x=>e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[x,e.jsx("button",{type:"button",onClick:()=>c(m.filter(v=>v!==x)),className:"ml-1 inline-flex items-center p-0.5 rounded-full text-green-400 hover:bg-green-200 hover:text-green-500",children:e.jsx(de,{className:"h-3 w-3"})})]},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Available For"}),e.jsx("div",{className:"space-y-2",children:y.map(x=>e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"checkbox",checked:g.includes(x.value),onChange:v=>{v.target.checked?u([...g,x.value]):u(g.filter(w=>w!==x.value))},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:x.label})]},x.value))})]})]})})]}),a?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"inline-flex items-center px-4 py-2 font-semibold leading-6 text-sm text-indigo-600",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-indigo-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Searching..."]})}):e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:r.map(x=>e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{className:"h-16 w-16 rounded-full",src:x.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(x.full_name)}&size=64`,alt:x.full_name}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:x.full_name}),x.headline&&e.jsx("p",{className:"text-sm text-gray-500",children:x.headline})]})]}),x.bio&&e.jsx("p",{className:"mt-4 text-sm text-gray-500 line-clamp-3",children:x.bio}),x.location&&e.jsxs("p",{className:"mt-4 text-sm text-gray-500 flex items-center",children:[e.jsx(gl,{className:"h-4 w-4 mr-1"}),x.location]}),x.website&&e.jsxs("p",{className:"mt-2 text-sm text-gray-500 flex items-center",children:[e.jsx(rn,{className:"h-4 w-4 mr-1"}),e.jsx("a",{href:x.website,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-900",children:new URL(x.website).hostname})]}),x.skills&&x.skills.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Skills"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:x.skills.map(v=>e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:v},v))})]}),x.available_for&&Object.entries(x.available_for).some(([v,w])=>w)&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Available for"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Object.entries(x.available_for).map(([v,w])=>w&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(pl,{className:"h-3 w-3 mr-1"}),v.charAt(0).toUpperCase()+v.slice(1)]},v))})]}),x.social_links&&Object.values(x.social_links).some(v=>v)&&e.jsxs("div",{className:"mt-4 flex space-x-4",children:[x.social_links.linkedin&&e.jsxs("a",{href:x.social_links.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"sr-only",children:"LinkedIn"}),e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.338 16.338H13.67V12.16c0-.995-.017-2.277-1.387-2.277-1.39 0-1.601 1.086-1.601 2.207v4.248H8.014v-8.59h2.559v1.174h.037c.356-.675 1.227-1.387 2.526-1.387 2.703 0 3.203 1.778 3.203 4.092v4.711zM5.005 6.575a1.548 1.548 0 11-.003-3.096 1.548 1.548 0 01.003 3.096zm-1.337 9.763H6.34v-8.59H3.667v8.59zM17.668 1H2.328C1.595 1 1 1.581 1 2.298v15.403C1 18.418 1.595 19 2.328 19h15.34c.734 0 1.332-.582 1.332-1.299V2.298C19 1.581 18.402 1 17.668 1z",clipRule:"evenodd"})})]}),x.social_links.twitter&&e.jsxs("a",{href:x.social_links.twitter,target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"sr-only",children:"Twitter"}),e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M6.29 18.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0020 3.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.073 4.073 0 01.8 7.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 010 16.407a11.616 11.616 0 006.29 1.84"})})]}),x.social_links.github&&e.jsxs("a",{href:x.social_links.github,target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"sr-only",children:"GitHub"}),e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})]})]})]})},x.id))})]})})}const _r={google:{client_id:"",client_secret:"",redirect_uri:`${window.location.origin}/auth/google/callback`,project_id:"",auth_uri:"https://accounts.google.com/o/oauth2/auth",token_uri:"https://oauth2.googleapis.com/token",auth_provider_x509_cert_url:"https://www.googleapis.com/oauth2/v1/certs",javascript_origins:[window.location.origin]}};function Ld(){const[s,t]=h.useState(!1),[r,n]=h.useState(""),[a,i]=h.useState(""),[o,l]=h.useState(!1),[m,c]=h.useState(_r);h.useEffect(()=>{g()},[]);const g=async()=>{var p;try{const{data:d,error:y}=await R.from("profiles").select("settings").eq("role","superadmin").single();if(y)throw y;(p=d==null?void 0:d.settings)!=null&&p.app_credentials&&c({..._r,...d.settings.app_credentials,google:{..._r.google,...d.settings.app_credentials.google||{},redirect_uri:`${window.location.origin}/auth/google/callback`,javascript_origins:[window.location.origin]}})}catch(d){console.error("Error loading credentials:",d),n("Failed to load existing credentials")}},u=async()=>{t(!0),n(""),i("");try{if(!m.google.client_id||!m.google.client_secret)throw new Error("Google credentials are required");const{data:p,error:d}=await R.from("profiles").select("settings").eq("role","superadmin").single();if(d)throw d;const y={...p==null?void 0:p.settings,app_credentials:m},{error:b}=await R.from("profiles").update({settings:y}).eq("role","superadmin");if(b)throw b;i("Credentials saved successfully!")}catch(p){console.error("Error saving credentials:",p),n(p.message||"Failed to save credentials")}finally{t(!1)}};return e.jsxs("div",{className:"bg-white shadow sm:rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900 flex items-center",children:[e.jsx(Pr,{className:"h-5 w-5 mr-2"}),"App Credentials"]}),e.jsx("button",{onClick:()=>l(!o),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:o?e.jsxs(e.Fragment,{children:[e.jsx(yl,{className:"h-4 w-4 mr-2"}),"Hide Secrets"]}):e.jsxs(e.Fragment,{children:[e.jsx(bl,{className:"h-4 w-4 mr-2"}),"Show Secrets"]})})]}),r&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx(fe,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:r})})]})}),a&&e.jsx("div",{className:"mb-4 p-4 bg-green-50 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx(Er,{className:"h-5 w-5 text-green-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-green-700",children:a})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Google OAuth"}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-md",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:"Setup Instructions"}),e.jsxs("ol",{className:"list-decimal list-inside text-sm text-gray-600 space-y-2",children:[e.jsxs("li",{children:["Go to the ",e.jsxs("a",{href:"https://console.cloud.google.com",target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-900 inline-flex items-center",children:["Google Cloud Console ",e.jsx(Q,{className:"h-3 w-3 ml-0.5"})]})]}),e.jsx("li",{children:"Create a new project or select an existing one"}),e.jsxs("li",{children:["Enable the following APIs:",e.jsxs("ul",{className:"list-disc list-inside ml-4 mt-1",children:[e.jsx("li",{children:"Google Drive API"}),e.jsx("li",{children:"Google Slides API"})]})]}),e.jsxs("li",{children:['Go to "OAuth consent screen" and configure:',e.jsxs("ul",{className:"list-disc list-inside ml-4 mt-1",children:[e.jsx("li",{children:"User Type: External"}),e.jsx("li",{children:"Add scopes: Google Drive and Google Slides"}),e.jsx("li",{children:"Add test users (your email)"})]})]}),e.jsxs("li",{children:['Go to "Credentials" and create an OAuth 2.0 Client ID:',e.jsxs("ul",{className:"list-disc list-inside ml-4 mt-1",children:[e.jsx("li",{children:"Application type: Web application"}),e.jsx("li",{children:"Name: Your app name"}),e.jsx("li",{children:"Add Authorized JavaScript origins:"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded font-mono text-sm break-all",children:window.location.origin}),e.jsx("li",{children:"Add Authorized redirect URI:"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded font-mono text-sm break-all",children:m.google.redirect_uri})]})]}),e.jsx("li",{children:"Copy the Client ID and Client Secret below"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"google_project_id",className:"block text-sm font-medium text-gray-700",children:["Project ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"google_project_id",value:m.google.project_id,onChange:p=>c({...m,google:{...m.google,project_id:p.target.value}}),required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"your-project-id"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"google_client_id",className:"block text-sm font-medium text-gray-700",children:["Client ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:o?"text":"password",id:"google_client_id",value:m.google.client_id,onChange:p=>c({...m,google:{...m.google,client_id:p.target.value}}),required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter your Google Client ID"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"google_client_secret",className:"block text-sm font-medium text-gray-700",children:["Client Secret ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:o?"text":"password",id:"google_client_secret",value:m.google.client_secret,onChange:p=>c({...m,google:{...m.google,client_secret:p.target.value}}),required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter your Google Client Secret"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"google_redirect_uri",className:"block text-sm font-medium text-gray-700",children:"Redirect URI"}),e.jsx("input",{type:"text",id:"google_redirect_uri",value:m.google.redirect_uri,readOnly:!0,className:"mt-1 block w-full rounded-md border-gray-300 bg-gray-50 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Add this URI to your Google OAuth consent screen"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"google_javascript_origins",className:"block text-sm font-medium text-gray-700",children:"JavaScript Origins"}),e.jsx("input",{type:"text",id:"google_javascript_origins",value:m.google.javascript_origins[0],readOnly:!0,className:"mt-1 block w-full rounded-md border-gray-300 bg-gray-50 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Add this origin to your Google OAuth consent screen"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:u,disabled:s,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),s?"Saving...":"Save Credentials"]})})]})]})}function Bd(){const{profile:s}=X(),[t,r]=h.useState([]),[n,a]=h.useState({workspace_id:"",bot_token:""}),[i,o]=h.useState({api_key:"",model:"gpt-4"}),[l,m]=h.useState([]),[c,g]=h.useState("users"),[u,p]=h.useState(!1),[d,y]=h.useState({email:"",password:"",role:"user",full_name:""}),[b,x]=h.useState(""),[v,w]=h.useState(""),[_,j]=h.useState(!1);h.useEffect(()=>{f(),S(),N(),O()},[]);const f=async()=>{const{data:k,error:E}=await R.from("profiles").select("*").order("created_at",{ascending:!1});k&&r(k)},S=async()=>{const{data:k,error:E}=await R.from("slack_settings").select("*").limit(1).single();k&&a(k)},N=async()=>{var A;const{data:k,error:E}=await R.from("profiles").select("settings").eq("role","superadmin").limit(1).single();(A=k==null?void 0:k.settings)!=null&&A.openai&&o(k.settings.openai)},O=async()=>{const{data:k,error:E}=await R.from("communities").select("*").order("created_at",{ascending:!1});k&&m(k)},T=async(k,E)=>{const{error:A}=await R.from("profiles").update({role:E}).eq("id",k);A||f()},I=async k=>{k.preventDefault(),x(""),w("");try{const{data:E,error:A}=await R.auth.signUp({email:d.email,password:d.password,options:{data:{full_name:d.full_name}}});if(A)throw A;if(E.user){const{error:D}=await R.from("profiles").insert([{id:E.user.id,email:d.email,full_name:d.full_name,role:d.role,allows_messages:!0,is_public:!0}]);if(D)throw D;w("User created successfully"),y({email:"",password:"",role:"user",full_name:""}),p(!1),f()}}catch(E){x(E.message||"Failed to create user")}},P=async()=>{j(!0);try{const{error:k}=await R.from("slack_settings").upsert([n]);if(k)throw k;w("Slack settings saved successfully")}catch(k){x(k.message||"Failed to save Slack settings")}finally{j(!1)}},C=async()=>{j(!0);try{if(!(await new q({apiKey:i.api_key,dangerouslyAllowBrowser:!0}).chat.completions.create({model:i.model,messages:[{role:"user",content:"Test connection"}]})).choices[0].message.content)throw new Error("Failed to test OpenAI connection");const{error:A}=await R.from("profiles").update({settings:{openai:i}}).eq("role","superadmin");if(A)throw A;w("OpenAI settings saved successfully")}catch(k){x(k.message||"Failed to save OpenAI settings")}finally{j(!1)}};return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Zt,{className:"h-6 w-6"}),"Admin Panel"]}),e.jsx("div",{className:"mt-4 border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{onClick:()=>g("users"),className:`${c==="users"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,children:[e.jsx(xe,{className:"h-5 w-5 mr-2"}),"Users"]}),e.jsxs("button",{onClick:()=>g("credentials"),className:`${c==="credentials"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,children:[e.jsx(Pr,{className:"h-5 w-5 mr-2"}),"App Credentials"]}),e.jsxs("button",{onClick:()=>g("slack"),className:`${c==="slack"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,children:[e.jsx(wl,{className:"h-5 w-5 mr-2"}),"Slack Settings"]}),e.jsxs("button",{onClick:()=>g("openai"),className:`${c==="openai"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,children:[e.jsx(Qt,{className:"h-5 w-5 mr-2"}),"OpenAI Settings"]}),e.jsxs("button",{onClick:()=>g("communities"),className:`${c==="communities"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,children:[e.jsx(Ee,{className:"h-5 w-5 mr-2"}),"Communities"]})]})}),e.jsxs("div",{className:"mt-6",children:[b&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 rounded-md flex items-center text-red-800",children:[e.jsx(fe,{className:"h-5 w-5 mr-2"}),b]}),v&&e.jsx("div",{className:"mb-4 p-4 bg-green-50 rounded-md text-green-800",children:v}),c==="users"&&e.jsxs("div",{className:"bg-white shadow-sm rounded-lg",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"User Management"}),e.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),u&&e.jsx("div",{className:"mt-4",children:e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("input",{type:"text",value:d.full_name,onChange:k=>y({...d,full_name:k.target.value}),required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(jl,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",value:d.email,onChange:k=>y({...d,email:k.target.value}),required:!0,className:"block w-full pl-10 rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Pr,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",value:d.password,onChange:k=>y({...d,password:k.target.value}),required:!0,minLength:6,className:"block w-full pl-10 rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),e.jsxs("select",{value:d.role,onChange:k=>y({...d,role:k.target.value}),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),(s==null?void 0:s.role)==="superadmin"&&e.jsx("option",{value:"superadmin",children:"Super Admin"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{p(!1),x(""),w("")},className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:"Create User"})]})]})})]}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(k=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:k.full_name||"No name"}),e.jsx("div",{className:"text-sm text-gray-500",children:k.email})]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("select",{value:k.role,onChange:E=>T(k.id,E.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",disabled:k.id===(s==null?void 0:s.id),children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),(s==null?void 0:s.role)==="superadmin"&&e.jsx("option",{value:"superadmin",children:"Super Admin"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${k.allows_messages?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:k.allows_messages?"Active":"Inactive"})})]},k.id))})]})]}),c==="credentials"&&e.jsx(Ld,{}),c==="slack"&&e.jsxs("div",{className:"bg-white shadow sm:rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Slack Integration"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"workspace_id",className:"block text-sm font-medium text-gray-700",children:"Workspace ID"}),e.jsx("input",{type:"text",name:"workspace_id",id:"workspace_id",value:n.workspace_id,onChange:k=>a({...n,workspace_id:k.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bot_token",className:"block text-sm font-medium text-gray-700",children:"Bot Token"}),e.jsx("input",{type:"password",name:"bot_token",id:"bot_token",value:n.bot_token,onChange:k=>a({...n,bot_token:k.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:P,disabled:_,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:_?"Saving...":"Save Settings"})})]})]}),c==="openai"&&e.jsxs("div",{className:"bg-white shadow sm:rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"OpenAI Settings"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"api_key",className:"block text-sm font-medium text-gray-700",children:"API Key"}),e.jsxs("div",{className:"mt-1 flex rounded-md shadow-sm",children:[e.jsx("input",{type:"password",name:"api_key",id:"api_key",value:i.api_key,onChange:k=>o({...i,api_key:k.target.value}),className:"flex-1 min-w-0 block w-full rounded-none rounded-l-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"sk-..."}),e.jsx("button",{onClick:async()=>{try{j(!0),(await new q({apiKey:i.api_key,dangerouslyAllowBrowser:!0}).chat.completions.create({model:i.model,messages:[{role:"user",content:"Test connection"}]})).choices[0].message.content&&w("OpenAI connection successful!")}catch(k){x(k.message||"Failed to test OpenAI connection")}finally{j(!1)}},className:"relative -ml-px inline-flex items-center space-x-2 rounded-r-md border border-gray-300 bg-gray-50 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500",children:"Test Connection"})]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Get your API key from"," ",e.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-900",children:"OpenAI's platform"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"model",className:"block text-sm font-medium text-gray-700",children:"Default Model"}),e.jsxs("select",{id:"model",name:"model",value:i.model,onChange:k=>o({...i,model:k.target.value}),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"gpt-4",children:"GPT-4 (Recommended)"}),e.jsx("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:C,disabled:_,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:_?"Saving...":"Save Settings"})})]})]}),c==="communities"&&e.jsxs("div",{className:"bg-white shadow sm:rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Communities"}),e.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Community"]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:l.map(k=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:k.name}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:k.description})]},k.id))})]})]})]})})}const Ud=["Artificial Intelligence","Blockchain","E-commerce","FinTech","Healthcare","SaaS","Sustainability","EdTech","Mobile Apps","IoT","Cybersecurity","Cloud Computing","Digital Marketing","Remote Work","Social Impact"];function qd(){const s=Ue(),{user:t,profile:r}=X(),[n,a]=h.useState("basic"),[i,o]=h.useState(!0),[l,m]=h.useState(""),[c,g]=h.useState(()=>{const P=sessionStorage.getItem("companySetupData"),C={name:"",industries:[],website:"",target_market:"",market_size:"",competition:"",business_model:"",revenue_model:"",pricing_strategy:"",product_description:"",features:"",tech_stack:"",team_size:"",culture:"",remote_policy:"",description:"",mission:"",is_public:!0,social_links:{linkedin:"",twitter:"",github:"",website:""}};if(P)try{const k=JSON.parse(P);return{...C,...k,social_links:{...C.social_links,...k.social_links||{}}}}catch{return C}return C}),[u,p]=h.useState(""),[d,y]=h.useState(""),[b,x]=h.useState(!1),v=Ud.filter(P=>P.toLowerCase().includes(u.toLowerCase())),w=P=>{c.industries.includes(P)||g(C=>({...C,industries:[...C.industries,P]})),p("")},_=P=>{g(C=>({...C,industries:C.industries.filter(k=>k!==P)}))},j=()=>{d.trim()&&!c.industries.includes(d.trim())&&(w(d.trim()),y(""),x(!1))};h.useEffect(()=>{sessionStorage.setItem("companySetupData",JSON.stringify(c))},[c]),h.useEffect(()=>{(async()=>{if(t)try{o(!0),m("");const{data:C,error:k}=await R.from("companies").select("id").eq("owner_id",t.id);if(k)throw k;const{data:E,error:A}=await R.from("company_members").select("company_id").eq("user_id",t.id);if(A)throw A;(C&&C.length>0||E&&E.length>0)&&s("/company/dashboard")}catch(C){console.error("Error checking company access:",C),m(C.message)}finally{o(!1)}})()},[t,s]);const f=P=>{const{name:C,value:k,type:E,checked:A}=P.target;g(D=>({...D,[C]:E==="checkbox"?A:k}))},S=async P=>{if(P.preventDefault(),!(!t||!c.name||c.industries.length===0)){o(!0);try{const{data:C,error:k}=await R.from("companies").insert([{name:c.name,industries:c.industries,website:c.website,target_market:c.target_market,market_size:c.market_size,business_model:c.business_model,description:c.description,mission:c.mission,is_public:c.is_public,social_links:c.social_links,owner_id:t.id,remote_policy:c.remote_policy,company_culture:c.culture,tech_stack:{description:c.tech_stack}}]).select().single();if(k)throw k;if(!C)throw new Error("Failed to create company");const{error:E}=await R.from("company_members").insert({company_id:C.id,user_id:t.id,role:"owner",title:"Founder",joined_at:new Date().toISOString()});if(E)throw await R.from("companies").delete().eq("id",C.id),E;sessionStorage.removeItem("companySetupData"),s("/company/dashboard")}catch(C){console.error("Error creating company:",C),m(C.message)}finally{o(!1)}}},N=()=>{const P=$t.findIndex(C=>C.id===n);P<$t.length-1&&a($t[P+1].id)},O=()=>{const P=$t.findIndex(C=>C.id===n);P>0&&a($t[P-1].id)},T=()=>{window.confirm("Are you sure you want to exit? Your progress will be saved.")&&s("/dashboard")},I=()=>{switch(n){case"basic":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:["Company Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",name:"name",required:!0,value:c.name,onChange:f,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter your company name"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Industries ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:c.industries.map(P=>e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:[P,e.jsx("button",{type:"button",onClick:()=>_(P),className:"ml-2 inline-flex items-center p-0.5 rounded-full text-blue-800 hover:bg-blue-200",children:e.jsx(de,{className:"h-3 w-3"})})]},P))}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx("input",{type:"text",value:u,onChange:P=>p(P.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Search industries..."}),u&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md border border-gray-200 max-h-60 overflow-auto",children:v.length>0?e.jsx("ul",{className:"py-1",children:v.map(P=>e.jsx("li",{children:e.jsx("button",{type:"button",onClick:()=>w(P),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:P})},P))}):e.jsxs("div",{className:"p-4",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"No matching industries"}),!b&&e.jsxs("button",{type:"button",onClick:()=>{x(!0),y(u)},className:"mt-2 inline-flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Add custom industry"]})]})})]}),b&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"custom_industry",className:"block text-sm font-medium text-gray-700",children:"Add Custom Industry"}),e.jsxs("div",{className:"mt-1 flex rounded-md shadow-sm",children:[e.jsx("input",{type:"text",id:"custom_industry",value:d,onChange:P=>y(P.target.value),className:"flex-1 min-w-0 block w-full rounded-none rounded-l-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter custom industry"}),e.jsx("button",{type:"button",onClick:j,className:"inline-flex items-center px-3 py-2 rounded-r-md border border-l-0 border-gray-300 bg-gray-50 text-gray-500 sm:text-sm hover:bg-gray-100",children:"Add"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"website",className:"block text-sm font-medium text-gray-700",children:"Website"}),e.jsx("input",{type:"url",id:"website",name:"website",value:c.website,onChange:f,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"https://example.com"})]})]});case"market":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"target_market",className:"block text-sm font-medium text-gray-700",children:"Target Market"}),e.jsx("textarea",{id:"target_market",name:"target_market",value:c.target_market,onChange:f,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Describe your target market..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"market_size",className:"block text-sm font-medium text-gray-700",children:"Market Size"}),e.jsx("textarea",{id:"market_size",name:"market_size",value:c.market_size,onChange:f,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Describe your market size and opportunity..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"competition",className:"block text-sm font-medium text-gray-700",children:"Competition"}),e.jsx("textarea",{id:"competition",name:"competition",value:c.competition,onChange:f,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Describe your competitors..."})]})]});case"business":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"business_model",className:"block text-sm font-medium text-gray-700",children:"Business Model"}),e.jsxs("select",{id:"business_model",name:"business_model",value:c.business_model,onChange:f,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select business model"}),e.jsx("option",{value:"b2b",children:"B2B"}),e.jsx("option",{value:"b2c",children:"B2C"}),e.jsx("option",{value:"b2b2c",children:"B2B2C"}),e.jsx("option",{value:"c2c",children:"C2C"}),e.jsx("option",{value:"saas",children:"SaaS"}),e.jsx("option",{value:"marketplace",children:"Marketplace"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"revenue_model",className:"block text-sm font-medium text-gray-700",children:"Revenue Model"}),e.jsxs("select",{id:"revenue_model",name:"revenue_model",value:c.revenue_model,onChange:f,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select revenue model"}),e.jsx("option",{value:"subscription",children:"Subscription"}),e.jsx("option",{value:"transactional",children:"Transactional"}),e.jsx("option",{value:"advertising",children:"Advertising"}),e.jsx("option",{value:"freemium",children:"Freemium"}),e.jsx("option",{value:"commission",children:"Commission"}),e.jsx("option",{value:"licensing",children:"Licensing"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pricing_strategy",className:"block text-sm font-medium text-gray-700",children:"Pricing Strategy"}),e.jsx("textarea",{id:"pricing_strategy",name:"pricing_strategy",value:c.pricing_strategy,onChange:f,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Describe your pricing strategy..."})]})]});case"product":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"product_description",className:"block text-sm font-medium text-gray-700",children:"Product Description"}),e.jsx("textarea",{id:"product_description",name:"product_description",value:c.product_description,onChange:f,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Describe your product or service..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"features",className:"block text-sm font-medium text-gray-700",children:"Key Features"}),e.jsx("textarea",{id:"features",name:"features",value:c.features,onChange:f,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"List your key features..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tech_stack",className:"block text-sm font-medium text-gray-700",children:"Technology Stack"}),e.jsx("textarea",{id:"tech_stack",name:"tech_stack",value:c.tech_stack,onChange:f,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Describe your technology stack..."})]})]});case"team":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"team_size",className:"block text-sm font-medium text-gray-700",children:"Team Size"}),e.jsxs("select",{id:"team_size",name:"team_size",value:c.team_size,onChange:f,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select team size"}),e.jsx("option",{value:"1",children:"Solo founder"}),e.jsx("option",{value:"2-5",children:"2-5 people"}),e.jsx("option",{value:"6-10",children:"6-10 people"}),e.jsx("option",{value:"11-20",children:"11-20 people"}),e.jsx("option",{value:"21-50",children:"21-50 people"}),e.jsx("option",{value:"50+",children:"50+ people"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"culture",className:"block text-sm font-medium text-gray-700",children:"Company Culture"}),e.jsx("textarea",{id:"culture",name:"culture",value:c.culture,onChange:f,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Describe your company culture..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"remote_policy",className:"block text-sm font-medium text-gray-700",children:"Remote Work Policy"}),e.jsxs("select",{id:"remote_policy",name:"remote_policy",value:c.remote_policy,onChange:f,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select policy"}),e.jsx("option",{value:"remote",children:"Remote-first"}),e.jsx("option",{value:"hybrid",children:"Hybrid"}),e.jsx("option",{value:"office",children:"Office-based"}),e.jsx("option",{value:"flexible",children:"Flexible"})]})]})]});case"profile":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Company Description"}),e.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:f,rows:4,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Describe your company..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mission",className:"block text-sm font-medium text-gray-700",children:"Mission Statement"}),e.jsx("textarea",{id:"mission",name:"mission",value:c.mission,onChange:f,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"What is your company's mission?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Social Links"}),e.jsxs("div",{className:"mt-1 space-y-2",children:[e.jsx("input",{type:"url",name:"social_links.linkedin",value:c.social_links.linkedin,onChange:f,className:"block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"LinkedIn URL"}),e.jsx("input",{type:"url",name:"social_links.twitter",value:c.social_links.twitter,onChange:f,className:"block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Twitter URL"}),e.jsx("input",{type:"url",name:"social_links.github",value:c.social_links.github,onChange:f,className:"block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"GitHub URL"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_public",name:"is_public",checked:c.is_public,onChange:f,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"is_public",className:"ml-2 block text-sm text-gray-900",children:"Make company profile public"})]})]});default:return null}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(ut,{className:"mx-auto h-12 w-12 text-blue-600"}),e.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Complete Your Company Profile"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Tell us about your company and we'll help you get started"})]}),e.jsx("div",{className:"bg-white shadow rounded-lg p-8",children:e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[I(),e.jsxs("div",{className:"mt-8 flex justify-between pt-6 border-t border-gray-200",children:[e.jsx("div",{children:e.jsx("button",{type:"button",onClick:T,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Save & Exit"})}),e.jsxs("div",{className:"flex space-x-3",children:[n!=="basic"&&e.jsx("button",{type:"button",onClick:O,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Back"}),n==="profile"?e.jsx("button",{type:"submit",disabled:i||!c.name||c.industries.length===0,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Complete Setup"}):e.jsx("button",{type:"button",onClick:N,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Next Step"})]})]})]})})]})})}const $t=[{id:"basic",name:"Basic Info",description:"Company name and industry",icon:ut},{id:"market",name:"Market",description:"Target market and positioning",icon:sn},{id:"business",name:"Business Model",description:"Revenue and operations",icon:Ir},{id:"product",name:"Product",description:"Product/service details",icon:Ve},{id:"team",name:"Team",description:"Team structure and culture",icon:xe},{id:"profile",name:"Profile",description:"Public profile and links",icon:rn}];function Wd(){const{user:s}=X(),[t,r]=h.useState([]),[n,a]=h.useState("/"),[i,o]=h.useState(""),[l,m]=h.useState("all"),[c,g]=h.useState(!1),[u,p]=h.useState(!1),[d,y]=h.useState({title:"",description:"",file:null}),[b,x]=h.useState("");h.useEffect(()=>{v()},[n,i,l]);const v=async()=>{try{let N=R.from("company_documents").select(`
          *,
          author:created_by(full_name)
        `).eq("folder_path",n).order("created_at",{ascending:!1});i&&(N=N.ilike("title",`%${i}%`)),l!=="all"&&(N=N.eq("file_type",l));const{data:O,error:T}=await N;if(T)throw T;r(O||[])}catch(N){console.error("Error loading documents:",N),x("Failed to load documents")}},w=async N=>{var T;const O=(T=N.target.files)==null?void 0:T[0];O&&y(I=>({...I,file:O}))},_=async N=>{if(N.preventDefault(),!(!s||!d.file)){g(!0),x("");try{const O=d.file.name.split(".").pop(),T=`${s.id}/${Date.now()}.${O}`,{error:I}=await R.storage.from("documents").upload(T,d.file);if(I)throw I;const{data:{publicUrl:P}}=R.storage.from("documents").getPublicUrl(T),{error:C}=await R.from("company_documents").insert({title:d.title,description:d.description,file_url:P,file_type:O,size_bytes:d.file.size,folder_path:n,created_by:s.id});if(C)throw C;y({title:"",description:"",file:null}),p(!1),v()}catch(O){console.error("Error uploading document:",O),x("Failed to upload document")}finally{g(!1)}}},j=async N=>{if(window.confirm("Are you sure you want to delete this document?"))try{const{error:O}=await R.from("company_documents").delete().eq("id",N.id);if(O)throw O;v()}catch(O){console.error("Error deleting document:",O),x("Failed to delete document")}},f=N=>{switch(N.toLowerCase()){case"pdf":return e.jsx(he,{className:"h-8 w-8 text-red-500"});case"doc":case"docx":return e.jsx(he,{className:"h-8 w-8 text-blue-500"});case"xls":case"xlsx":return e.jsx(he,{className:"h-8 w-8 text-green-500"});case"jpg":case"jpeg":case"png":case"gif":return e.jsx(Nl,{className:"h-8 w-8 text-purple-500"});case"mp4":case"mov":case"avi":return e.jsx(Js,{className:"h-8 w-8 text-indigo-500"});default:return e.jsx(vl,{className:"h-8 w-8 text-gray-400"})}},S=N=>{if(N===0)return"0 Bytes";const O=1024,T=["Bytes","KB","MB","GB"],I=Math.floor(Math.log(N)/Math.log(O));return parseFloat((N/Math.pow(O,I)).toFixed(2))+" "+T[I]};return e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx($s,{className:"h-5 w-5 mr-2 text-gray-400"}),"Document Store"]}),e.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Upload Document"]})]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(rt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"search",value:i,onChange:N=>o(N.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Search documents..."})]})}),e.jsx("div",{className:"sm:w-48",children:e.jsxs("select",{value:l,onChange:N=>m(N.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"doc",children:"Word"}),e.jsx("option",{value:"xls",children:"Excel"}),e.jsx("option",{value:"img",children:"Images"}),e.jsx("option",{value:"vid",children:"Videos"})]})})]}),e.jsxs("div",{className:"mt-4 flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx("button",{onClick:()=>a("/"),className:"hover:text-gray-700",children:"Root"}),n!=="/"&&n.split("/").filter(Boolean).map((N,O,T)=>e.jsxs(Qe.Fragment,{children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("button",{onClick:()=>a("/"+T.slice(0,O+1).join("/")),className:"hover:text-gray-700",children:N})]},N))]})]}),e.jsxs("div",{className:"px-6 py-4",children:[b&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 rounded-md",children:e.jsx("p",{className:"text-sm text-red-700",children:b})}),e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Size"}),e.jsx("th",{className:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Modified"}),e.jsx("th",{className:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Owner"}),e.jsx("th",{className:"px-6 py-3 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(N=>{var O;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[f(N.file_type),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:N.title}),e.jsx("div",{className:"text-sm text-gray-500",children:N.description})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:S(N.size_bytes)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(N.updated_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(O=N.author)==null?void 0:O.full_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("a",{href:N.file_url,download:!0,className:"text-gray-400 hover:text-gray-500",children:e.jsx(nn,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>j(N),className:"text-gray-400 hover:text-gray-500",children:e.jsx(wt,{className:"h-5 w-5"})})]})})]},N.id)})})]})})]}),u&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:()=>p(!1)}),e.jsxs("div",{className:"relative w-full max-w-md rounded-lg bg-white shadow-lg",children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Upload Document"})}),e.jsxs("form",{onSubmit:_,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx("input",{type:"text",value:d.title,onChange:N=>y(O=>({...O,title:N.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{value:d.description,onChange:N=>y(O=>({...O,description:N.target.value})),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"File"}),e.jsx("input",{type:"file",onChange:w,className:`mt-1 block w-full text-sm text-gray-500
                      file:mr-4 file:py-2 file:px-4
                      file:rounded-md file:border-0
                      file:text-sm file:font-medium
                      file:bg-indigo-50 file:text-indigo-700
                      hover:file:bg-indigo-100`,required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>p(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:c?e.jsxs(e.Fragment,{children:[e.jsx(Gn,{className:"h-4 w-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Gn,{className:"h-4 w-4 mr-2"}),"Upload"]})})]})]})]})]})})]})}function Hd({company:s}){X();const[t,r]=h.useState([]),[n,a]=h.useState({}),[i,o]=h.useState({}),[l,m]=h.useState({}),[c,g]=h.useState({}),[u,p]=h.useState({}),[d,y]=h.useState(!0),[b,x]=h.useState("");h.useEffect(()=>{s&&v()},[s]);const v=async()=>{try{const{data:f,error:S}=await R.from("company_stages").select("*").order("order_index");if(S)throw S;if(f){r(f);const N=f.map(C=>R.from("company_stage_steps").select("*").eq("stage_id",C.id).order("order_index")),O=await Promise.all(N),T={};if(O.forEach((C,k)=>{if(C.error)throw C.error;C.data&&(T[f[k].id]=C.data)}),a(T),s){const{data:C,error:k}=await R.from("company_progress").select("*").eq("company_id",s.id);if(k)throw k;if(C){const E={};C.forEach(A=>{E[`${A.stage_id}_${A.step_id}`]=A}),o(E)}}const{data:I,error:P}=await R.from("company_step_suggestions").select("*").eq("is_public",!0);if(P)throw P;if(I){const C={};I.forEach(k=>{C[k.step_id]||(C[k.step_id]=[]),C[k.step_id].push(k)}),m(C)}f.length>0&&g({[f[0].id]:!0})}}catch(f){console.error("Error loading stages:",f),x(f.message)}finally{y(!1)}},w=f=>{g(S=>({...S,[f]:!S[f]}))},_=f=>{p(S=>({...S,[f]:!S[f]}))},j=async(f,S,N,O)=>{if(s)try{const T=`${f}_${S}`,I=i[T];if(I){const{error:P}=await R.from("company_progress").update({status:N,notes:O,completed_at:N==="completed"?new Date().toISOString():null,updated_at:new Date().toISOString()}).eq("id",I.id);if(P)throw P}else{const{error:P}=await R.from("company_progress").insert({company_id:s.id,stage_id:f,step_id:S,status:N,notes:O,completed_at:N==="completed"?new Date().toISOString():null});if(P)throw P}await v()}catch(T){console.error("Error updating progress:",T),x(T.message)}};return d?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading company stages..."})]}):t.length?e.jsxs("div",{className:"space-y-6",children:[b&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(fe,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:b})})]})}),t.map(f=>{var S;return e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>w(f.id),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center",children:[c[f.id]?e.jsx(ce,{className:"h-5 w-5 text-gray-400"}):e.jsx(Z,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:f.name}),e.jsx("p",{className:"text-sm text-gray-500",children:f.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-sm text-gray-500",children:f.estimated_duration}),f.required&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Required"})]})]}),c[f.id]&&e.jsx("div",{className:"border-t border-gray-200",children:(S=n[f.id])==null?void 0:S.map(N=>{var O,T,I,P;return e.jsx("div",{className:"border-b border-gray-200 last:border-b-0",children:e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("button",{onClick:()=>_(N.id),className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[u[N.id]?e.jsx(ce,{className:"h-5 w-5 text-gray-400"}):e.jsx(Z,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:N.name}),e.jsx("p",{className:"text-sm text-gray-500",children:N.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[((O=i[`${f.id}_${N.id}`])==null?void 0:O.status)==="completed"&&e.jsx("span",{className:"inline-flex items-center text-green-600",children:e.jsx(Ct,{className:"h-5 w-5"})}),((T=i[`${f.id}_${N.id}`])==null?void 0:T.status)==="in_progress"&&e.jsx("span",{className:"inline-flex items-center text-yellow-600",children:e.jsx(Le,{className:"h-5 w-5"})}),N.required&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Required"})]})]}),u[N.id]&&e.jsxs("div",{className:"mt-4 ml-8 space-y-4",children:[N.checklist.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:"Checklist"}),e.jsx("div",{className:"space-y-2",children:N.checklist.map((C,k)=>{var E;return e.jsxs("div",{className:"flex items-start",children:[e.jsx("input",{type:"checkbox",checked:((E=i[`${f.id}_${N.id}`])==null?void 0:E.status)==="completed",onChange:A=>j(f.id,N.id,A.target.checked?"completed":"in_progress"),className:"mt-1 h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-3 text-sm text-gray-700",children:C})]},k)})})]}),N.tools.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:"Tools"}),e.jsx("div",{className:"space-y-2",children:N.tools.map((C,k)=>e.jsxs("a",{href:C.url,target:C.type==="internal"?"_self":"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[e.jsx(_l,{className:"h-4 w-4 mr-1"}),C.name,C.type!=="internal"&&e.jsx(Q,{className:"h-3 w-3 ml-1"})]},k))})]}),N.resources.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:"Resources"}),e.jsx("div",{className:"space-y-2",children:N.resources.map((C,k)=>e.jsxs("a",{href:C.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[e.jsx(he,{className:"h-4 w-4 mr-1"}),C.title,e.jsx(Q,{className:"h-3 w-3 ml-1"})]},k))})]}),N.tips.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:"Tips"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:N.tips.map((C,k)=>e.jsx("li",{className:"text-sm text-gray-700",children:C},k))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:"Notes"}),e.jsx("textarea",{value:((I=i[`${f.id}_${N.id}`])==null?void 0:I.notes)||"",onChange:C=>j(f.id,N.id,"in_progress",C.target.value),rows:3,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Add your notes about this step..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>j(f.id,N.id,"skipped"),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Skip Step"}),e.jsx("button",{onClick:()=>{var C;return j(f.id,N.id,((C=i[`${f.id}_${N.id}`])==null?void 0:C.status)==="completed"?"in_progress":"completed")},className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:((P=i[`${f.id}_${N.id}`])==null?void 0:P.status)==="completed"?e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"h-4 w-4 mr-1"}),"Mark In Progress"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ct,{className:"h-4 w-4 mr-1"}),"Mark Complete"]})})]})]})]})},N.id)})})]},f.id)})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(fe,{className:"h-12 w-12 text-gray-400 mx-auto"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No stages found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Please contact an administrator to set up company stages."})]})}function zd(){const{profile:s}=X(),[t,r]=h.useState(null),[n,a]=h.useState([]),[i,o]=h.useState([]),[l,m]=h.useState([]),[c,g]=h.useState("overview"),[u,p]=h.useState(!0),[d,y]=h.useState("");h.useEffect(()=>{s&&b()},[s]);const b=async()=>{try{p(!0),y("");const{data:x,error:v}=await R.from("companies").select("*").eq("owner_id",s==null?void 0:s.id).order("created_at",{ascending:!1}).limit(1);if(v)throw v;const w=x==null?void 0:x[0];if(w){r(w);const[{data:_},{data:j},{data:f}]=await Promise.all([R.from("company_documents").select("*").eq("company_id",w.id).order("created_at",{ascending:!1}).limit(5),R.from("development_environments").select("*").eq("company_id",w.id),R.from("company_members").select("id, role, title, department, user_id, user_email").eq("company_id",w.id)]);a(_||[]),o(j||[]),m(f||[])}}catch(x){console.error("Error fetching company data:",x),y(x.message)}finally{p(!1)}};return u?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):d?e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(fe,{className:"h-5 w-5 text-red-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("p",{className:"mt-2 text-sm text-red-700",children:d})]})]})})})}):e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ut,{className:"h-6 w-6"}),(t==null?void 0:t.name)||"Company Dashboard"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:t==null?void 0:t.industry})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(G,{to:"/company/members",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Team (",l.length,")"]}),e.jsxs(G,{to:"/company/settings",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(Zt,{className:"h-4 w-4 mr-2"}),"Settings"]})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(xe,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Team Members"}),e.jsx("dd",{className:"flex items-baseline",children:e.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:l.length})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx(G,{to:"/company/members",className:"font-medium text-indigo-700 hover:text-indigo-900",children:"View all"})})})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx($s,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Documents"}),e.jsx("dd",{className:"flex items-baseline",children:e.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:n.length})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx("button",{onClick:()=>g("documents"),className:"font-medium text-indigo-700 hover:text-indigo-900",children:"View all"})})})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ba,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Dev Environments"}),e.jsx("dd",{className:"flex items-baseline",children:e.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:i.filter(x=>x.status==="active").length})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx(G,{to:"/company/environments",className:"font-medium text-indigo-700 hover:text-indigo-900",children:"View all"})})})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(kl,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Analytics"}),e.jsx("dd",{className:"flex items-baseline",children:e.jsx("div",{className:"text-sm text-gray-500",children:"Coming soon"})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx("span",{className:"text-gray-500",children:"Available soon"})})})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx(Hd,{company:t})}),e.jsx("div",{className:"mt-8 border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>g("overview"),className:`${c==="overview"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:"Overview"}),e.jsx("button",{onClick:()=>g("documents"),className:`${c==="documents"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:"Documents"}),e.jsx("button",{onClick:()=>g("tasks"),className:`${c==="tasks"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:"Tasks"})]})}),e.jsxs("div",{className:"mt-6",children:[c==="overview"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Tasks"}),e.jsx(zr,{category:"company",showCompleted:!1})]}),e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Team Members"}),e.jsxs("button",{className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Invite Member"]})]}),e.jsx("div",{className:"flow-root",children:e.jsx("ul",{className:"-my-5 divide-y divide-gray-200",children:l.map(x=>e.jsx("li",{className:"py-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{className:"h-8 w-8 rounded-full",src:`https://ui-avatars.com/api/?name=${encodeURIComponent(x.user_email||"User")}`,alt:""})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:x.user_email}),e.jsxs("p",{className:"text-sm text-gray-500 truncate",children:[x.title," • ",x.role]})]}),e.jsx("div",{children:e.jsx(Z,{className:"h-5 w-5 text-gray-400"})})]})},x.id))})})]})})]}),c==="documents"&&e.jsx(Wd,{}),c==="tasks"&&e.jsx(zr,{category:"company",showCompleted:!0})]})]})})}function Gd({companyId:s,members:t,onMemberAdded:r,onMemberRemoved:n}){const[a,i]=h.useState(""),[o,l]=h.useState("member"),[m,c]=h.useState(""),[g,u]=h.useState(""),[p,d]=h.useState(!1),[y,b]=h.useState(""),x=async w=>{w.preventDefault(),b(""),d(!0);try{const{data:_,error:j}=await R.rpc("get_user_by_email",{email:a});if(j||!_){b("User not found. Please check the email address.");return}const{error:f}=await R.from("company_members").insert({company_id:s,user_id:_.id,role:o,title:m,department:g});if(f){f.code==="23505"?b("This user is already a member of the company."):b("Failed to add team member. Please try again.");return}i(""),l("member"),c(""),u(""),r()}catch(_){console.error("Error adding team member:",_),b("An unexpected error occurred. Please try again.")}finally{d(!1)}},v=async w=>{try{const{error:_}=await R.from("company_members").delete().eq("id",w);if(_)throw _;n()}catch(_){console.error("Error removing team member:",_),b("Failed to remove team member. Please try again.")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(Cl,{className:"h-5 w-5 mr-2"}),"Add Team Member"]})}),e.jsxs("form",{onSubmit:x,className:"px-6 py-5 space-y-4",children:[y&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"text-sm text-red-700",children:y})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",required:!0,value:a,onChange:w=>i(w.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700",children:"Role"}),e.jsxs("select",{id:"role",required:!0,value:o,onChange:w=>l(w.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"member",children:"Member"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"guest",children:"Guest"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx("input",{type:"text",id:"title",value:m,onChange:w=>c(w.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700",children:"Department"}),e.jsx("input",{type:"text",id:"department",value:g,onChange:w=>u(w.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:p,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:p?"Adding...":"Add Member"})})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(xe,{className:"h-5 w-5 mr-2"}),"Team Members"]})}),e.jsx("div",{className:"px-6 py-5",children:e.jsx("div",{className:"flow-root",children:e.jsx("ul",{className:"-my-5 divide-y divide-gray-200",children:t.map(w=>e.jsx("li",{className:"py-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{className:"h-8 w-8 rounded-full",src:`https://ui-avatars.com/api/?name=${encodeURIComponent(w.user_email||"User")}`,alt:""})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:w.user_email}),e.jsxs("p",{className:"text-sm text-gray-500 truncate",children:[w.title," • ",w.role]}),w.department&&e.jsx("p",{className:"text-sm text-gray-500 truncate",children:w.department})]}),e.jsx("div",{children:e.jsx("button",{onClick:()=>v(w.id),className:"inline-flex items-center p-1 border border-transparent rounded-full text-gray-400 hover:bg-gray-100 hover:text-gray-500",children:e.jsx(wt,{className:"h-5 w-5"})})})]})},w.id))})})})]})]})}function Vd(){const s=Ue(),{user:t}=X(),[r,n]=h.useState(null),[a,i]=h.useState([]),[o,l]=h.useState(!1),[m,c]=h.useState("general"),[g,u]=h.useState("basic"),[p,d]=h.useState(!0),[y,b]=h.useState("");h.useEffect(()=>{t&&x()},[t]),h.useEffect(()=>{r&&v()},[r]);const x=async()=>{try{d(!0),b("");const{data:I,error:P}=await R.from("companies").select("*").eq("owner_id",t==null?void 0:t.id).order("created_at",{ascending:!1}).limit(1);if(P)throw P;const C=I==null?void 0:I[0];C&&n({...C,product_roadmap:C.product_roadmap||{current_stage:null,key_features:[],upcoming_releases:[],long_term_vision:null},tech_stack:C.tech_stack||{frontend:[],backend:[],infrastructure:[],tools:[]},team_structure:C.team_structure||{departments:[],key_roles:[]},team_composition:C.team_composition||{full_time:0,part_time:0,contractors:0}})}catch(I){console.error("Error loading company:",I),b(I.message)}finally{d(!1)}},v=async()=>{if(r)try{const{data:I,error:P}=await R.from("company_members").select("id, role, title, department, user_id, user_email").eq("company_id",r.id);if(P)throw P;i(I||[])}catch(I){console.error("Error loading members:",I),b(I.message)}},w=I=>{const{name:P,value:C,type:k}=I.target;if(P.startsWith("social_links.")){const E=P.split(".")[1];n(A=>({...A,social_links:{...A.social_links,[E]:C}}))}else n(E=>({...E,[P]:k==="checkbox"?I.target.checked:C}))},_=(I,P,C,k)=>{n(E=>{if(!E)return E;const A=[...E[I][P]];return A[k]=C,{...E,[I]:{...E[I],[P]:A}}})},j=(I,P)=>{n(C=>C&&{...C,[I]:{...C[I],[P]:[...C[I][P],""]}})},f=(I,P,C)=>{n(k=>{if(!k)return k;const E=[...k[I][P]];return E.splice(C,1),{...k,[I]:{...k[I],[P]:E}}})},S=(I,P,C)=>{n(k=>k&&{...k,[I]:{...k[I],[P]:C}})},N=async()=>{if(r){l(!0),b("");try{const{error:I}=await R.from("companies").update({...r,updated_at:new Date().toISOString()}).eq("id",r.id);if(I)throw I;await x()}catch(I){console.error("Error updating company:",I),b(I.message)}finally{l(!1)}}},O=async()=>{if(!(!r||!window.confirm("Are you sure you want to delete this company? This action cannot be undone.")))try{const{error:I}=await R.from("companies").delete().eq("id",r.id);if(I)throw I;s("/dashboard")}catch(I){console.error("Error deleting company:",I),b(I.message)}},T=()=>{r&&(sessionStorage.setItem("companySetupData",JSON.stringify({name:r.name,industries:r.industries,website:r.website,size:r.size,stage:r.stage,business_model:r.business_model,target_market:r.target_market,description:r.description,mission:r.mission,is_public:r.is_public,logo_url:r.logo_url,social_links:r.social_links})),s("/company/setup"))};return p?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):r?e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center",children:[e.jsx(ut,{className:"h-6 w-6 mr-2"}),"Company Settings"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage your company preferences and settings"})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:T,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(Sl,{className:"h-4 w-4 mr-2"}),"Relaunch Setup"]}),m==="general"&&e.jsxs("button",{onClick:N,disabled:o,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),o?"Saving...":"Save Changes"]})]})]}),y&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-md flex items-start",children:[e.jsx(de,{className:"h-5 w-5 text-red-400 mr-2 mt-0.5"}),e.jsx("div",{className:"text-sm text-red-700",children:y})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{onClick:()=>c("general"),className:`${m==="general"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,children:[e.jsx(Zt,{className:"h-5 w-5 mr-2"}),"General"]}),e.jsxs("button",{onClick:()=>c("team"),className:`${m==="team"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,children:[e.jsx(xe,{className:"h-5 w-5 mr-2"}),"Team"]}),e.jsxs("button",{onClick:()=>c("storage"),className:`${m==="storage"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,children:[e.jsx(Ba,{className:"h-5 w-5 mr-2"}),"Cloud Storage"]})]})}),e.jsxs("div",{className:"mt-6",children:[m==="general"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>u("basic"),className:`${g==="basic"?"bg-indigo-100 text-indigo-700":"text-gray-500 hover:text-gray-700"} px-3 py-2 rounded-md text-sm font-medium`,children:"Basic Info"}),e.jsx("button",{onClick:()=>u("market"),className:`${g==="market"?"bg-indigo-100 text-indigo-700":"text-gray-500 hover:text-gray-700"} px-3 py-2 rounded-md text-sm font-medium`,children:"Market"}),e.jsx("button",{onClick:()=>u("product"),className:`${g==="product"?"bg-indigo-100 text-indigo-700":"text-gray-500 hover:text-gray-700"} px-3 py-2 rounded-md text-sm font-medium`,children:"Product"}),e.jsx("button",{onClick:()=>u("team"),className:`${g==="team"?"bg-indigo-100 text-indigo-700":"text-gray-500 hover:text-gray-700"} px-3 py-2 rounded-md text-sm font-medium`,children:"Team"}),e.jsx("button",{onClick:()=>u("profile"),className:`${g==="profile"?"bg-indigo-100 text-indigo-700":"text-gray-500 hover:text-gray-700"} px-3 py-2 rounded-md text-sm font-medium`,children:"Profile"})]})}),e.jsxs("div",{className:"p-6",children:[g==="basic"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Company Name"}),e.jsx("input",{type:"text",id:"name",name:"name",value:r.name,onChange:w,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"website",className:"block text-sm font-medium text-gray-700",children:"Website"}),e.jsx("input",{type:"url",id:"website",name:"website",value:r.website||"",onChange:w,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"size",className:"block text-sm font-medium text-gray-700",children:"Company Size"}),e.jsxs("select",{id:"size",name:"size",value:r.size||"",onChange:w,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select size"}),e.jsx("option",{value:"1-10",children:"1-10 employees"}),e.jsx("option",{value:"11-50",children:"11-50 employees"}),e.jsx("option",{value:"51-200",children:"51-200 employees"}),e.jsx("option",{value:"201-500",children:"201-500 employees"}),e.jsx("option",{value:"501+",children:"501+ employees"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"stage",className:"block text-sm font-medium text-gray-700",children:"Company Stage"}),e.jsxs("select",{id:"stage",name:"stage",value:r.stage||"",onChange:w,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select stage"}),e.jsx("option",{value:"idea",children:"Idea Stage"}),e.jsx("option",{value:"mvp",children:"MVP"}),e.jsx("option",{value:"early",children:"Early Stage"}),e.jsx("option",{value:"growth",children:"Growth Stage"}),e.jsx("option",{value:"scale",children:"Scale Up"})]})]})]}),g==="market"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"target_market",className:"block text-sm font-medium text-gray-700",children:"Target Market"}),e.jsx("textarea",{id:"target_market",name:"target_market",value:r.target_market||"",onChange:w,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"business_model",className:"block text-sm font-medium text-gray-700",children:"Business Model"}),e.jsxs("select",{id:"business_model",name:"business_model",value:r.business_model||"",onChange:w,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select business model"}),e.jsx("option",{value:"b2b",children:"B2B"}),e.jsx("option",{value:"b2c",children:"B2C"}),e.jsx("option",{value:"b2b2c",children:"B2B2C"}),e.jsx("option",{value:"c2c",children:"C2C"}),e.jsx("option",{value:"saas",children:"SaaS"}),e.jsx("option",{value:"marketplace",children:"Marketplace"})]})]})]}),g==="product"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Key Features"}),r.product_roadmap.key_features.map((I,P)=>e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("input",{type:"text",value:I,onChange:C=>_("product_roadmap","key_features",C.target.value,P),className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx("button",{type:"button",onClick:()=>f("product_roadmap","key_features",P),className:"ml-2 text-gray-400 hover:text-gray-500",children:e.jsx(Ge,{className:"h-5 w-5"})})]},P)),e.jsxs("button",{type:"button",onClick:()=>j("product_roadmap","key_features"),className:"mt-2 inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Feature"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tech Stack"}),e.jsxs("div",{className:"space-y-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-500",children:"Frontend"}),r.tech_stack.frontend.map((I,P)=>e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("input",{type:"text",value:I,onChange:C=>_("tech_stack","frontend",C.target.value,P),className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx("button",{type:"button",onClick:()=>f("tech_stack","frontend",P),className:"ml-2 text-gray-400 hover:text-gray-500",children:e.jsx(Ge,{className:"h-5 w-5"})})]},P)),e.jsxs("button",{type:"button",onClick:()=>j("tech_stack","frontend"),className:"mt-2 inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Frontend Tech"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-500",children:"Backend"}),r.tech_stack.backend.map((I,P)=>e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("input",{type:"text",value:I,onChange:C=>_("tech_stack","backend",C.target.value,P),className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx("button",{type:"button",onClick:()=>f("tech_stack","backend",P),className:"ml-2 text-gray-400 hover:text-gray-500",children:e.jsx(Ge,{className:"h-5 w-5"})})]},P)),e.jsxs("button",{type:"button",onClick:()=>j("tech_stack","backend"),className:"mt-2 inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Backend Tech"]})]})]})]})]}),g==="team"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Team Structure"}),e.jsxs("div",{className:"space-y-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-500",children:"Departments"}),r.team_structure.departments.map((I,P)=>e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("input",{type:"text",value:I,onChange:C=>_("team_structure","departments",C.target.value,P),className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx("button",{type:"button",onClick:()=>f("team_structure","departments",P),className:"ml-2 text-gray-400 hover:text-gray-500",children:e.jsx(Ge,{className:"h-5 w-5"})})]},P)),e.jsxs("button",{type:"button",onClick:()=>j("team_structure","departments"),className:"mt-2 inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Department"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-500",children:"Key Roles"}),r.team_structure.key_roles.map((I,P)=>e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("input",{type:"text",value:I,onChange:C=>_("team_structure","key_roles",C.target.value,P),className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx("button",{type:"button",onClick:()=>f("team_structure","key_roles",P),className:"ml-2 text-gray-400 hover:text-gray-500",children:e.jsx(Ge,{className:"h-5 w-5"})})]},P)),e.jsxs("button",{type:"button",onClick:()=>j("team_structure","key_roles"),className:"mt-2 inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Key Role"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Team Composition"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-500",children:"Full-time"}),e.jsx("input",{type:"number",value:r.team_composition.full_time,onChange:I=>S("team_composition","full_time",parseInt(I.target.value)),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-500",children:"Part-time"}),e.jsx("input",{type:"number",value:r.team_composition.part_time,onChange:I=>S("team_composition","part_time",parseInt(I.target.value)),className:"mt- 1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-500",children:"Contractors"}),e.jsx("input",{type:"number",value:r.team_composition.contractors,onChange:I=>S("team_composition","contractors",parseInt(I.target.value)),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]})]})]}),g==="profile"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Company Description"}),e.jsx("textarea",{id:"description",name:"description",rows:4,value:r.description||"",onChange:w,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mission",className:"block text-sm font-medium text-gray-700",children:"Company Mission"}),e.jsx("textarea",{id:"mission",name:"mission",rows:3,value:r.mission||"",onChange:w,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"logo_url",className:"block text-sm font-medium text-gray-700",children:"Logo URL"}),e.jsx("input",{type:"url",id:"logo_url",name:"logo_url",value:r.logo_url||"",onChange:w,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_public",name:"is_public",checked:r.is_public,onChange:w,className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"is_public",className:"ml-2 block text-sm text-gray-900",children:"Make company profile public"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Public profiles are visible to all users and can be found in the directory"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Social Links"}),e.jsxs("div",{className:"mt-1 space-y-2",children:[e.jsx("input",{type:"url",name:"social_links.linkedin",value:r.social_links.linkedin||"",onChange:w,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"LinkedIn URL"}),e.jsx("input",{type:"url",name:"social_links.twitter",value:r.social_links.twitter||"",onChange:w,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Twitter URL"}),e.jsx("input",{type:"url",name:"social_links.github",value:r.social_links.github||"",onChange:w,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"GitHub URL"}),e.jsx("input",{type:"url",name:"social_links.facebook",value:r.social_links.facebook||"",onChange:w,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Facebook URL"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Danger Zone"})}),e.jsx("div",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Delete Company"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Once you delete a company, there is no going back. Please be certain."})]}),e.jsxs("button",{onClick:O,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700",children:[e.jsx(wt,{className:"h-4 w-4 mr-2"}),"Delete Company"]})]})})]})]}),m==="team"&&e.jsx(Gd,{companyId:r.id,members:a,onMemberAdded:v,onMemberRemoved:v}),m==="storage"&&e.jsx(lo,{companyId:r.id,onComplete:()=>{x()}})]})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Company Found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"You need to set up a company first."}),e.jsx("button",{onClick:()=>s("/company/setup"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:"Set Up Company"})]})}function Jd(){const s=[{icon:Ze,title:"Idea Flow",description:"Refine your startup ideas into buildable concepts with AI guidance.",action:{text:"Start Ideation",href:"/idea-hub/flow"}},{icon:Qt,title:"AI Co-founder Bot",description:"Bounce ideas and get instant feedback from our AI assistant.",action:{text:"Start Discussion",href:"/idea-hub/ai-discussion"}},{icon:Ua,title:"Idea Canvas",description:"Structure and visualize your concept using our interactive canvas.",action:{text:"Open Canvas",href:"/idea-hub/canvas"}},{icon:an,title:"Market Research",description:"Analyze market size and competition with our research tools.",action:{text:"Research Now",href:"/idea-hub/market-research"}},{icon:qa,title:"Business Model Builder",description:"Define your revenue streams and cost structures.",action:{text:"Build Model",href:"/idea-hub/business-model"}},{icon:on,title:"Pitch Deck Creator",description:"Create compelling investor presentations with our templates.",action:{text:"Create Deck",href:"/idea-hub/pitch-deck"}}];return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Idea Hub"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Transform your ideas into successful startups"})]}),e.jsxs(G,{to:"/idea-hub/flow",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"New Idea"]})]}),e.jsx("div",{className:"mb-8 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg shadow-lg overflow-hidden",children:e.jsx("div",{className:"px-6 py-8 sm:p-10",children:e.jsxs("div",{className:"sm:flex sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"sm:flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-white sm:text-2xl",children:"New: AI-Powered Idea Flow"}),e.jsx("p",{className:"mt-2 text-sm text-indigo-100 sm:text-base",children:"Take your startup ideas from concept to execution with our new guided workflow. Get AI feedback at every step and refine your ideas into buildable concepts."}),e.jsx("div",{className:"mt-4",children:e.jsxs(G,{to:"/idea-hub/flow",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-indigo-600 bg-white hover:bg-indigo-50",children:["Try Idea Flow",e.jsx(Vn,{className:"ml-2 h-4 w-4"})]})})]}),e.jsx("div",{className:"mt-4 sm:mt-0 sm:ml-6",children:e.jsx(Ze,{className:"h-12 w-12 text-white opacity-75"})})]})})}),e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:s.map((t,r)=>e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(t.icon,{className:"h-6 w-6 text-indigo-600"})}),e.jsx("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:t.title})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:t.description}),e.jsxs(G,{to:t.action.href,className:"inline-flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-900",children:[t.action.text,e.jsx(Vn,{className:"ml-2 h-4 w-4"})]})]})},r))})]})})}function Xd(){const{user:s}=X(),[t,r]=h.useState("New Discussion"),[n,a]=h.useState(null),[i,o]=h.useState(!1),[l,m]=h.useState([{role:"assistant",content:"Hi! I'm your AI co-founder. I can help you validate your ideas and provide feedback. What would you like to discuss?"}]),[c,g]=h.useState("");h.useEffect(()=>{s&&(async()=>{const{data:b}=await R.from("ai_discussions").select("*").eq("user_id",s==null?void 0:s.id).order("updated_at",{ascending:!1}).limit(1).single();b&&(a(b.id),r(b.title),m(b.messages))})()},[s]);const u=async y=>{if(y.preventDefault(),!c.trim())return;const b=[...l,{role:"user",content:c},{role:"assistant",content:"This is a demo response. In a real implementation, this would be connected to an AI service."}];m(b),g(""),s&&await p(b)},p=async(y=l)=>{if(s){o(!0);try{if(n)await R.from("ai_discussions").update({title:t,messages:y,updated_at:new Date().toISOString()}).eq("id",n);else{const{data:b}=await R.from("ai_discussions").insert({user_id:s.id,title:t,messages:y}).select().single();b&&a(b.id)}}catch(b){console.error("Error saving discussion:",b)}finally{o(!1)}}},d=()=>{a(null),r("New Discussion"),m([{role:"assistant",content:"Hi! I'm your AI co-founder. I can help you validate your ideas and provide feedback. What would you like to discuss?"}])};return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{to:"/idea-hub",className:"mr-4 text-gray-400 hover:text-gray-500",children:e.jsx(Ye,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Qt,{className:"h-6 w-6 mr-2 text-gray-400"}),e.jsx("input",{type:"text",value:t,onChange:y=>r(y.target.value),className:"text-2xl font-semibold text-gray-900 bg-transparent border-none focus:ring-0 focus:outline-none",placeholder:"Enter discussion title..."})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get instant feedback and validation for your startup ideas"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:d,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"New Discussion"]}),e.jsxs("button",{onClick:()=>p(),disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),i?"Saving...":"Save Discussion"]})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"h-[600px] overflow-y-auto p-6 space-y-4",children:l.map((y,b)=>e.jsx("div",{className:`flex ${y.role==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] rounded-lg p-4 ${y.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:y.content})},b))}),e.jsx("div",{className:"border-t border-gray-200 p-4",children:e.jsxs("form",{onSubmit:u,className:"flex space-x-4",children:[e.jsx("input",{type:"text",value:c,onChange:y=>g(y.target.value),placeholder:"Type your message...",className:"flex-1 rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}),e.jsxs("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[e.jsx(ln,{className:"h-4 w-4 mr-2"}),"Send"]})]})})]})]})})}function Yd(){const{user:s}=X(),[t,r]=h.useState("Untitled Canvas"),[n,a]=h.useState(null),[i,o]=h.useState(!1),[l,m]=h.useState([{title:"Problem",content:"",placeholder:"What problem are you solving?"},{title:"Solution",content:"",placeholder:"How does your solution address the problem?"},{title:"Unique Value Proposition",content:"",placeholder:"What makes your solution unique and valuable?"},{title:"Target Market",content:"",placeholder:"Who are your target customers?"},{title:"Revenue Streams",content:"",placeholder:"How will you make money?"},{title:"Cost Structure",content:"",placeholder:"What are the main costs?"},{title:"Key Metrics",content:"",placeholder:"What metrics will you track?"},{title:"Competitive Advantage",content:"",placeholder:"What gives you an edge over competitors?"},{title:"Channels",content:"",placeholder:"How will you reach your customers?"}]);h.useEffect(()=>{s&&(async()=>{const{data:d}=await R.from("idea_canvases").select("*").eq("user_id",s==null?void 0:s.id).order("updated_at",{ascending:!1}).limit(1).single();d&&(a(d.id),r(d.title),m(d.sections))})()},[s]);const c=(p,d)=>{const y=[...l];y[p].content=d,m(y)},g=async()=>{if(s){o(!0);try{if(n)await R.from("idea_canvases").update({title:t,sections:l,updated_at:new Date().toISOString()}).eq("id",n);else{const{data:p}=await R.from("idea_canvases").insert({user_id:s.id,title:t,sections:l}).select().single();p&&a(p.id)}}catch(p){console.error("Error saving canvas:",p)}finally{o(!1)}}},u=()=>{a(null),r("Untitled Canvas"),m(l.map(p=>({...p,content:""})))};return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{to:"/idea-hub",className:"mr-4 text-gray-400 hover:text-gray-500",children:e.jsx(Ye,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ua,{className:"h-6 w-6 mr-2 text-gray-400"}),e.jsx("input",{type:"text",value:t,onChange:p=>r(p.target.value),className:"text-2xl font-semibold text-gray-900 bg-transparent border-none focus:ring-0 focus:outline-none",placeholder:"Enter canvas title..."})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Structure and visualize your business concept"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:u,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"New Canvas"]}),e.jsxs("button",{onClick:g,disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),i?"Saving...":"Save Canvas"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map((p,d)=>e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:p.title}),e.jsx("textarea",{rows:4,value:p.content,onChange:y=>c(d,y.target.value),placeholder:p.placeholder,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]},d))})]})})}function Kd(){const{user:s}=X(),[t,r]=h.useState("Market Analysis"),[n,a]=h.useState(null),[i,o]=h.useState(!1),[l,m]=h.useState([{title:"Market Size",value:"$4.2B",change:"+12.3%",trend:"up"},{title:"Growth Rate",value:"15.7%",change:"+2.1%",trend:"up"},{title:"Customer Acquisition Cost",value:"$125",change:"-5.2%",trend:"down"},{title:"Customer Lifetime Value",value:"$2,450",change:"+8.7%",trend:"up"}]),[c,g]=h.useState([{name:"CompetitorX",website:"https://example.com",marketShare:"35%",strengths:["Brand recognition","Large user base","Strong partnerships"],weaknesses:["Outdated technology","High prices","Poor customer support"]},{name:"CompetitorY",website:"https://example.com",marketShare:"25%",strengths:["Modern platform","Competitive pricing","Innovation"],weaknesses:["Limited market reach","New player","Feature gaps"]}]);h.useEffect(()=>{s&&(async()=>{const{data:y}=await R.from("market_research").select("*").eq("user_id",s==null?void 0:s.id).order("updated_at",{ascending:!1}).limit(1).single();y&&(a(y.id),r(y.title),m(y.insights),g(y.competitors))})()},[s]);const u=async()=>{if(s){o(!0);try{if(n)await R.from("market_research").update({title:t,insights:l,competitors:c,updated_at:new Date().toISOString()}).eq("id",n);else{const{data:d}=await R.from("market_research").insert({user_id:s.id,title:t,insights:l,competitors:c}).select().single();d&&a(d.id)}}catch(d){console.error("Error saving research:",d)}finally{o(!1)}}},p=()=>{a(null),r("Market Analysis"),m([{title:"Market Size",value:"$0",change:"0%",trend:"neutral"},{title:"Growth Rate",value:"0%",change:"0%",trend:"neutral"},{title:"Customer Acquisition Cost",value:"$0",change:"0%",trend:"neutral"},{title:"Customer Lifetime Value",value:"$0",change:"0%",trend:"neutral"}]),g([{name:"New Competitor",website:"",marketShare:"0%",strengths:[],weaknesses:[]}])};return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{to:"/idea-hub",className:"mr-4 text-gray-400 hover:text-gray-500",children:e.jsx(Ye,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(an,{className:"h-6 w-6 mr-2 text-gray-400"}),e.jsx("input",{type:"text",value:t,onChange:d=>r(d.target.value),className:"text-2xl font-semibold text-gray-900 bg-transparent border-none focus:ring-0 focus:outline-none",placeholder:"Enter research title..."})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Analyze your market and competition"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"max-w-xs",children:[e.jsx("label",{htmlFor:"search",className:"sr-only",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(rt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"search",name:"search",id:"search",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Search market data..."})]})]}),e.jsxs("button",{onClick:p,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"New Research"]}),e.jsxs("button",{onClick:u,disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),i?"Saving...":"Save Research"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-8",children:l.map((d,y)=>e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:d.title}),e.jsxs("dd",{className:"flex items-baseline",children:[e.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:d.value}),e.jsx("div",{className:`ml-2 flex items-baseline text-sm font-semibold ${d.trend==="up"?"text-green-600":d.trend==="down"?"text-red-600":"text-gray-500"}`,children:d.change})]})]})})})})},y))}),e.jsxs("div",{className:"bg-white shadow rounded-lg mb-8",children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Competitor Analysis"})}),e.jsx("div",{className:"px-6 py-5",children:e.jsx("div",{className:"grid grid-cols-1 gap-6",children:c.map((d,y)=>e.jsxs("div",{className:"border rounded-lg p-6 hover:border-blue-500 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:d.name}),e.jsxs("a",{href:d.website,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-900 flex items-center",children:[d.website,e.jsx(Q,{className:"h-4 w-4 ml-1"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:d.marketShare}),e.jsx("div",{className:"text-sm text-gray-500",children:"Market Share"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:"Strengths"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-500",children:d.strengths.map((b,x)=>e.jsx("li",{children:b},x))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:"Weaknesses"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-500",children:d.weaknesses.map((b,x)=>e.jsx("li",{children:b},x))})]})]})]},y))})})]})]})})}function Qd(){const{user:s}=X(),[t,r]=h.useState("Business Model"),[n,a]=h.useState(null),[i,o]=h.useState(!1),[l,m]=h.useState([{name:"Subscription Revenue",type:"recurring",amount:29.99,frequency:"monthly",description:"Monthly subscription fee for premium features"}]),[c,g]=h.useState([{name:"Server Costs",type:"variable",amount:500,frequency:"monthly"}]),[u,p]=h.useState([{name:"Monthly Active Users",target:"10000",current:"2500",unit:"users"}]);h.useEffect(()=>{s&&(async()=>{const{data:_}=await R.from("business_models").select("*").eq("user_id",s==null?void 0:s.id).order("updated_at",{ascending:!1}).limit(1).single();_&&(a(_.id),r(_.title),m(_.revenue_streams),g(_.cost_structure),p(_.key_metrics))})()},[s]);const d=async()=>{if(s){o(!0);try{if(n)await R.from("business_models").update({title:t,revenue_streams:l,cost_structure:c,key_metrics:u,updated_at:new Date().toISOString()}).eq("id",n);else{const{data:w}=await R.from("business_models").insert({user_id:s.id,title:t,revenue_streams:l,cost_structure:c,key_metrics:u}).select().single();w&&a(w.id)}}catch(w){console.error("Error saving business model:",w)}finally{o(!1)}}},y=()=>{a(null),r("Business Model"),m([{name:"",type:"recurring",amount:0,frequency:"monthly",description:""}]),g([{name:"",type:"fixed",amount:0,frequency:"monthly"}]),p([{name:"",target:"",current:"",unit:""}])},b=()=>{m([...l,{name:"",type:"recurring",amount:0,frequency:"monthly",description:""}])},x=()=>{g([...c,{name:"",type:"fixed",amount:0,frequency:"monthly"}])},v=()=>{p([...u,{name:"",target:"",current:"",unit:""}])};return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{to:"/idea-hub",className:"mr-4 text-gray-400 hover:text-gray-500",children:e.jsx(Ye,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(qa,{className:"h-6 w-6 mr-2 text-gray-400"}),e.jsx("input",{type:"text",value:t,onChange:w=>r(w.target.value),className:"text-2xl font-semibold text-gray-900 bg-transparent border-none focus:ring-0 focus:outline-none",placeholder:"Enter model title..."})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Define your revenue streams and cost structures"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:y,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"New Model"]}),e.jsxs("button",{onClick:d,disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),i?"Saving...":"Save Model"]})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg mb-8",children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Revenue Streams"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"space-y-6",children:l.map((w,_)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",value:w.name,onChange:j=>{const f=[...l];f[_].name=j.target.value,m(f)},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),e.jsxs("select",{value:w.type,onChange:j=>{const f=[...l];f[_].type=j.target.value,m(f)},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[e.jsx("option",{value:"recurring",children:"Recurring"}),e.jsx("option",{value:"one-time",children:"One-time"}),e.jsx("option",{value:"usage-based",children:"Usage-based"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ir,{className:"h-4 w-4 text-gray-400"})}),e.jsx("input",{type:"number",value:w.amount,onChange:j=>{const f=[...l];f[_].amount=parseFloat(j.target.value),m(f)},className:"block w-full pl-10 rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Frequency"}),e.jsxs("select",{value:w.frequency,onChange:j=>{const f=[...l];f[_].frequency=j.target.value,m(f)},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"})]})]})]},_))}),e.jsxs("button",{type:"button",onClick:b,className:"mt-4 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Revenue Stream"]})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg mb-8",children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Cost Structure"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"space-y-6",children:c.map((w,_)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",value:w.name,onChange:j=>{const f=[...c];f[_].name=j.target.value,g(f)},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),e.jsxs("select",{value:w.type,onChange:j=>{const f=[...c];f[_].type=j.target.value,g(f)},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[e.jsx("option",{value:"fixed",children:"Fixed"}),e.jsx("option",{value:"variable",children:"Variable"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ir,{className:"h-4 w-4 text-gray-400"})}),e.jsx("input",{type:"number",value:w.amount,onChange:j=>{const f=[...c];f[_].amount=parseFloat(j.target.value),g(f)},className:"block w-full pl-10 rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Frequency"}),e.jsxs("select",{value:w.frequency,onChange:j=>{const f=[...c];f[_].frequency=j.target.value,g(f)},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"})]})]})]},_))}),e.jsxs("button",{type:"button",onClick:x,className:"mt-4 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Cost Item"]})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Key Metrics"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"space-y-6",children:u.map((w,_)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Metric Name"}),e.jsx("input",{type:"text",value:w.name,onChange:j=>{const f=[...u];f[_].name=j.target.value,p(f)},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Target"}),e.jsx("input",{type:"text",value:w.target,onChange:j=>{const f=[...u];f[_].target=j.target.value,p(f)},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Current"}),e.jsx("input",{type:"text",value:w.current,onChange:j=>{const f=[...u];f[_].current=j.target.value,p(f)},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit"}),e.jsx("input",{type:"text",value:w.unit,onChange:j=>{const f=[...u];f[_].unit=j.target.value,p(f)},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]})]},_))}),e.jsxs("button",{type:"button",onClick:v,className:"mt-4 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Key Metric"]})]})]})]})})}const Zd=async(s,t)=>{try{return window.open("https://accounts.google.com/o/oauth2/v2/auth?client_id=your-google-client-id&redirect_uri=http://localhost:5173/auth/google/callback&response_type=code&scope=https://www.googleapis.com/auth/presentations https://www.googleapis.com/auth/drive.file&access_type=offline","_blank"),"placeholder-id"}catch(r){throw console.error("Error creating Google Slides:",r),r}};function em(){var ne,xt,ls,cs,ds;const{user:s}=X(),[t,r]=h.useState("Pitch Deck"),[n,a]=h.useState(null),[i,o]=h.useState(!1),[l,m]=h.useState(0),[c,g]=h.useState(!1),[u,p]=h.useState(""),[d,y]=h.useState(!1),[b,x]=h.useState([]),[v,w]=h.useState(""),[_,j]=h.useState([]),[f,S]=h.useState(""),[N,O]=h.useState(!1),[T,I]=h.useState([{id:"1",type:"cover",title:"Company Name",content:{text:"Tagline goes here"}},{id:"2",type:"problem",title:"The Problem",content:{text:"Describe the problem you're solving",bullets:["Pain point 1","Pain point 2","Pain point 3"]}},{id:"3",type:"solution",title:"Our Solution",content:{text:"Describe your solution",image:"https://via.placeholder.com/800x400"}}]);h.useEffect(()=>{s&&P()},[s]);const P=async()=>{try{const{data:F,error:L}=await R.from("pitch_decks").select(`
          *,
          collaborators:pitch_deck_collaborators(
            id,
            user_id,
            role,
            user:user_id(
              full_name,
              email,
              avatar_url
            )
          )
        `).eq("user_id",s==null?void 0:s.id).order("updated_at",{ascending:!1}).limit(1).single();if(L)throw L;F&&(a(F.id),r(F.title),I(F.slides),g(F.is_public),x(F.collaborators||[]),p(`${window.location.origin}/pitch-deck/${F.id}`),await C(F.id))}catch(F){console.error("Error loading deck:",F)}},C=async F=>{try{const{data:L,error:z}=await R.from("pitch_deck_comments").select(`
          *,
          user:user_id(
            full_name,
            avatar_url
          )
        `).eq("deck_id",F).order("created_at",{ascending:!0});if(z)throw z;L&&j(L)}catch(L){console.error("Error loading comments:",L)}},k=async()=>{if(s){o(!0);try{if(n)await R.from("pitch_decks").update({title:t,slides:T,is_public:c,updated_at:new Date().toISOString()}).eq("id",n);else{const{data:F}=await R.from("pitch_decks").insert({user_id:s.id,title:t,slides:T,is_public:c}).select().single();F&&(a(F.id),p(`${window.location.origin}/pitch-deck/${F.id}`))}}catch(F){console.error("Error saving pitch deck:",F)}finally{o(!1)}}},E=()=>{a(null),r("Pitch Deck"),I([{id:"1",type:"cover",title:"Company Name",content:{text:"Tagline goes here"}}]),m(0),g(!1),p(""),x([]),j([])},A=F=>{const L={id:Date.now().toString(),type:F,title:F.charAt(0).toUpperCase()+F.slice(1),content:{text:"",bullets:[]}};I([...T,L]),m(T.length)},D=(F,L)=>{const z=[...T];z[F]={...z[F],...L},I(z)},$=async()=>{if(!(!n||!v))try{const{data:F,error:L}=await R.rpc("get_user_by_email",{email:v});if(L||!F){console.error("User not found");return}const{error:z}=await R.from("pitch_deck_collaborators").insert({deck_id:n,user_id:F.id,role:"viewer"});if(z)throw z;const{data:ee}=await R.from("pitch_deck_collaborators").select(`
          id,
          user_id,
          role,
          user:profiles(full_name, email, avatar_url)
        `).eq("deck_id",n);ee&&x(ee),w("")}catch(F){console.error("Error adding collaborator:",F)}},U=async(F,L)=>{if(n)try{await R.from("pitch_deck_collaborators").update({role:L}).eq("id",F),x(z=>z.map(ee=>ee.id===F?{...ee,role:L}:ee))}catch(z){console.error("Error updating collaborator:",z)}},Y=async F=>{if(n)try{await R.from("pitch_deck_collaborators").delete().eq("id",F),x(L=>L.filter(z=>z.id!==F))}catch(L){console.error("Error removing collaborator:",L)}},re=async()=>{if(!(!n||!f.trim()))try{const{data:F,error:L}=await R.from("pitch_deck_comments").insert({deck_id:n,slide_id:T[l].id,content:f,user_id:s==null?void 0:s.id}).select(`
          *,
          user:profiles(full_name, avatar_url)
        `).single();if(L)throw L;F&&(j(z=>[...z,F]),S(""))}catch(F){console.error("Error adding comment:",F)}},ve=async()=>{try{const F=await Zd(t,T);window.open(`https://docs.google.com/presentation/d/${F}/edit`,"_blank")}catch(F){console.error("Error exporting to Google Slides:",F)}};return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{to:"/idea-hub",className:"mr-4 text-gray-400 hover:text-gray-500",children:e.jsx(Ye,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(on,{className:"h-6 w-6 mr-2 text-gray-400"}),e.jsx("input",{type:"text",value:t,onChange:F=>r(F.target.value),className:"text-2xl font-semibold text-gray-900 bg-transparent border-none focus:ring-0 focus:outline-none",placeholder:"Enter deck title..."})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Create compelling investor presentations"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>y(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(Wa,{className:"h-4 w-4 mr-2"}),"Share"]}),e.jsxs("button",{onClick:ve,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(nn,{className:"h-4 w-4 mr-2"}),"Export to Google Slides"]}),e.jsxs("button",{onClick:E,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"New Deck"]}),e.jsxs("button",{onClick:k,disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),i?"Saving...":"Save Deck"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Slides"}),e.jsxs("div",{className:"space-y-4",children:[T.map((F,L)=>e.jsx("button",{onClick:()=>m(L),className:`w-full text-left p-3 rounded-lg ${l===L?"bg-blue-50 border-2 border-blue-500":"border border-gray-200 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(El,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[L+1,". ",F.title]})]})},F.id)),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("button",{onClick:()=>A("custom"),className:"w-full inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Slide"]})})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>m(Math.max(0,l-1)),disabled:l===0,className:"p-2 rounded-full hover:bg-gray-100 disabled:opacity-50",children:e.jsx(Al,{className:"h-5 w-5"})}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Slide ",l+1," of ",T.length]}),e.jsx("button",{onClick:()=>m(Math.min(T.length-1,l+1)),disabled:l===T.length-1,className:"p-2 rounded-full hover:bg-gray-100 disabled:opacity-50",children:e.jsx(Z,{className:"h-5 w-5"})})]}),e.jsxs("select",{value:(ne=T[l])==null?void 0:ne.type,onChange:F=>D(l,{type:F.target.value}),className:"rounded-md border-gray-300 text-sm",children:[e.jsx("option",{value:"cover",children:"Cover Slide"}),e.jsx("option",{value:"problem",children:"Problem"}),e.jsx("option",{value:"solution",children:"Solution"}),e.jsx("option",{value:"market",children:"Market"}),e.jsx("option",{value:"business",children:"Business Model"}),e.jsx("option",{value:"team",children:"Team"}),e.jsx("option",{value:"custom",children:"Custom"})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Slide Title"}),e.jsx("input",{type:"text",value:(xt=T[l])==null?void 0:xt.title,onChange:F=>D(l,{title:F.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Content"}),e.jsx("textarea",{value:(ls=T[l])==null?void 0:ls.content.text,onChange:F=>D(l,{content:{...T[l].content,text:F.target.value}}),rows:4,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),((cs=T[l])==null?void 0:cs.content.bullets)&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bullet Points"}),T[l].content.bullets.map((F,L)=>e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("input",{type:"text",value:F,onChange:z=>{const ee=[...T[l].content.bullets];ee[L]=z.target.value,D(l,{content:{...T[l].content,bullets:ee}})},className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("button",{onClick:()=>{const z=T[l].content.bullets.filter((ee,it)=>it!==L);D(l,{content:{...T[l].content,bullets:z}})},className:"ml-2 p-2 text-gray-400 hover:text-gray-500",children:e.jsx(Jn,{className:"h-4 w-4"})})]},L)),e.jsxs("button",{onClick:()=>{const F=[...T[l].content.bullets||[],""];D(l,{content:{...T[l].content,bullets:F}})},className:"mt-2 inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Add Bullet Point"]})]}),((ds=T[l])==null?void 0:ds.content.image)&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Image URL"}),e.jsx("input",{type:"url",value:T[l].content.image,onChange:F=>D(l,{content:{...T[l].content,image:F.target.value}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),T[l].content.image&&e.jsx("img",{src:T[l].content.image,alt:"Slide",className:"mt-2 max-h-48 rounded-lg"})]})]})]})}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Comments"}),e.jsxs("button",{onClick:()=>O(!N),className:"text-sm text-gray-500 hover:text-gray-700",children:[N?"Hide":"Show"," Comments"]})]}),N&&e.jsxs("div",{className:"space-y-4",children:[_.filter(F=>{var L;return F.slide_id===((L=T[l])==null?void 0:L.id)}).map(F=>{var L,z,ee;return e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("img",{className:"h-8 w-8 rounded-full",src:((L=F.user)==null?void 0:L.avatar_url)||"https://ui-avatars.com/api/?name="+encodeURIComponent(((z=F.user)==null?void 0:z.full_name)||"User"),alt:""}),e.jsxs("div",{className:"flex-1 bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm",children:e.jsx("span",{className:"font-medium text-gray-900",children:(ee=F.user)==null?void 0:ee.full_name})}),e.jsx("div",{className:"mt-1 text-sm text-gray-700",children:F.content}),e.jsx("div",{className:"mt-2 text-xs text-gray-500",children:new Date(F.created_at).toLocaleString()})]})]},F.id)}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"comment",className:"sr-only",children:"Add comment"}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("textarea",{id:"comment",rows:3,value:f,onChange:F=>S(F.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Add a comment..."})}),e.jsxs("button",{type:"button",onClick:re,disabled:!f.trim(),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Comment"]})]})]})]})]})]}),d&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:()=>y(!1)}),e.jsxs("div",{className:"relative w-full max-w-md rounded-lg bg-white shadow-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Share Pitch Deck"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Visibility"}),e.jsxs("div",{className:"mt-2 flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>g(!1),className:`inline-flex items-center px-3 py-2 rounded-md ${c?"bg-white text-gray-700 border border-gray-300":"bg-blue-50 text-blue-700 border-2 border-blue-500"}`,children:[e.jsx(Pl,{className:"h-4 w-4 mr-2"}),"Private"]}),e.jsxs("button",{onClick:()=>g(!0),className:`inline-flex items-center px-3 py-2 rounded-md ${c?"bg-blue-50 text-blue-700 border-2 border-blue-500":"bg-white text-gray-700 border border-gray-300"}`,children:[e.jsx(rn,{className:"h-4 w-4 mr-2"}),"Public"]})]})]}),u&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Share Link"}),e.jsxs("div",{className:"mt-2 flex",children:[e.jsx("input",{type:"text",value:u,readOnly:!0,className:"block w-full rounded-l-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(u)},className:"inline-flex items-center px-4 py-2 border border-l-0 border-gray-300 rounded-r-md bg-gray-50 text-gray-700 hover:bg-gray-100",children:e.jsx(Il,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Collaborators"}),e.jsxs("div",{className:"mt-2 space-y-4",children:[b.map(F=>{var L,z,ee,it;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:((L=F.user)==null?void 0:L.avatar_url)||`https://ui-avatars.com/api/?name=${encodeURIComponent(((z=F.user)==null?void 0:z.full_name)||"User")}`,alt:"",className:"h-8 w-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:(ee=F.user)==null?void 0:ee.full_name}),e.jsx("p",{className:"text-sm text-gray-500",children:(it=F.user)==null?void 0:it.email})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:F.role,onChange:ms=>U(F.id,ms.target.value),className:"rounded-md border-gray-300 text-sm",children:[e.jsx("option",{value:"viewer",children:"Can View"}),e.jsx("option",{value:"editor",children:"Can Edit"})]}),e.jsx("button",{onClick:()=>Y(F.id),className:"p-1 text-gray-400 hover:text-gray-500",children:e.jsx(Jn,{className:"h-4 w-4"})})]})]},F.id)}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"email",value:v,onChange:F=>w(F.target.value),placeholder:"Enter email address",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("button",{onClick:$,disabled:!v,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:e.jsx(B,{className:"h-4 w-4"})})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>y(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Close"})})]})]})})]})})}function tm(){const[s,t]=h.useState([]),[r,n]=h.useState(""),[a,i]=h.useState("all"),[o,l]=h.useState("all"),m=["Business Planning","Market Research","Financial Models","Legal Templates","Pitch Decks","Growth Strategies"],c=["Template","Guide","Tool","Article","Video","Worksheet"];h.useEffect(()=>{g()},[a,o,r]);const g=async()=>{let u=R.from("resource_library").select("*");a!=="all"&&(u=u.eq("category",a)),o!=="all"&&(u=u.eq("type",o)),r&&(u=u.ilike("title",`%${r}%`));const{data:p}=await u;p&&t(p)};return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{to:"/idea-hub",className:"mr-4 text-gray-400 hover:text-gray-500",children:e.jsx(Ye,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center",children:[e.jsx(Rl,{className:"h-6 w-6 mr-2"}),"Resource Library"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Access templates, guides, and educational content"})]})]})}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(rt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"search",value:r,onChange:u=>n(u.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Search resources..."})]})}),e.jsx("div",{children:e.jsxs("select",{value:a,onChange:u=>i(u.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"all",children:"All Categories"}),m.map(u=>e.jsx("option",{value:u,children:u},u))]})}),e.jsx("div",{children:e.jsxs("select",{value:o,onChange:u=>l(u.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"all",children:"All Types"}),c.map(u=>e.jsx("option",{value:u,children:u},u))]})})]})}),e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:s.map(u=>e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow duration-200",children:[u.thumbnail_url&&e.jsx("div",{className:"aspect-w-16 aspect-h-9",children:e.jsx("img",{src:u.thumbnail_url,alt:u.title,className:"object-cover"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:u.type}),u.is_premium&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Premium"})]}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:u.title}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:u.description}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:u.tags.map(p=>e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:[e.jsx(cn,{className:"h-3 w-3 mr-1"}),p]},p))}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("a",{href:u.content_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-sm font-medium text-blue-600 hover:text-blue-900",children:["View Resource",e.jsx(Q,{className:"ml-1 h-4 w-4"})]}),e.jsxs("button",{className:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-gray-900",children:[e.jsx(nn,{className:"mr-1 h-4 w-4"}),"Download"]})]})]})]},u.id))})]})})}function sm({isOpen:s,onClose:t,isCompanyView:r=!1,standupEntry:n}){const a=Ue();if(!s)return null;const i=()=>{a(r?"/tasks/new/company":"/tasks/new",{state:{standupEntry:n}}),t()},o=()=>{a("/dashboard"),t()};return e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:t}),e.jsx("div",{className:"relative w-full max-w-md rounded-lg bg-white shadow-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Generate Tasks"}),e.jsx("button",{onClick:t,className:"rounded-full p-1 text-gray-400 hover:text-gray-500",children:e.jsx(de,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Would you like to generate tasks based on your update? Our AI can help create task suggestions aligned with your goals and current work."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:i,className:"w-full inline-flex items-center justify-between px-4 py-3 border border-gray-300 rounded-lg text-sm font-medium text-gray-900 bg-white hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"h-4 w-4 text-gray-400 mr-3"}),"Generate Tasks"]}),e.jsx(Z,{className:"h-5 w-5 text-gray-400"})]}),e.jsx("button",{onClick:o,className:"w-full inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-500",children:"Skip for now"})]})]})})]})})}const kr={accomplished:{title:"Accomplishments",initial:"Let's start with your recent accomplishments. What have you achieved since your last update? Think about completed tasks, milestones, or any progress worth celebrating.",followup:"That's great progress! Let me ask you a bit more about these accomplishments."},working_on:{title:"Current Work",initial:"Now, tell me about what you're actively working on. What are your main focus areas and priorities?",followup:"I see. Let's dive deeper into your current work to ensure you're on the right track."},blockers:{title:"Challenges",initial:"Are you facing any challenges or blockers? Don't worry, we'll figure them out together and find solutions.",followup:"Let's break down these challenges and identify actionable solutions."},goals:{title:"Goals & Next Steps",initial:"Looking ahead, what are your key goals and priorities? Think about both short-term objectives and longer-term aspirations.",followup:"Those are interesting goals. Let's make sure they're achievable and impactful."}},rm={accomplished:["That's great! What specific challenges did you overcome to achieve this?","How does this accomplishment align with your overall goals?","What key learnings can you take from this success?","How will this achievement help with your next steps?","What resources or support helped you succeed?"],working_on:["What's the biggest challenge you're facing with this work?","Do you have all the resources you need to move forward?","Are there any potential roadblocks you can anticipate?","How does this align with your priorities?","What would help you make faster progress?"],blockers:["Have you tried any solutions for this blocker yet?","What resources or support would help resolve this?","Is this a recurring issue we should address?","How is this impacting your timeline?","What's your backup plan if this persists?"],goals:["What's your first step toward these goals?","How will you measure success?","What potential obstacles might you face?","What resources will you need?","When do you aim to achieve these goals?"]};function nm(){const s=Ue(),{user:t}=X();h.useState("Daily Standup");const[r,n]=h.useState("accomplished"),[a,i]=h.useState({accomplished:"",working_on:"",blockers:"",goals:"",answers:{}}),[o,l]=h.useState([{role:"assistant",content:kr.accomplished.initial,type:"question"}]),[m,c]=h.useState(""),[g,u]=h.useState(!1),[p,d]=h.useState(!1),[y,b]=h.useState({accomplished:0,working_on:0,blockers:0,goals:0});h.useEffect(()=>{t||s("/login")},[t,s]);const x=()=>{const _=Object.keys(kr),j=_.indexOf(r);if(j<_.length-1){const f=_[j+1];n(f),l(S=>[...S,{role:"assistant",content:kr[f].initial,type:"question",section:f}])}else v()},v=async()=>{if(t)try{const{data:_,error:j}=await R.from("standup_entries").insert({user_id:t.id,date:new Date().toISOString().split("T")[0],...a}).select().single();if(j)throw j;d(!0)}catch(_){console.error("Error saving standup:",_)}},w=async _=>{if(_.preventDefault(),!m.trim()||g)return;const j={role:"user",content:m,type:"answer",section:r};l(f=>[...f,j]),i(f=>({...f,[r]:m,answers:{...f.answers,[`${r}_${y[r]}`]:m}})),c(""),u(!0);try{const f=rm[r],S=y[r];f&&S<f.length-1?setTimeout(()=>{const N={role:"assistant",content:f[S+1],type:"question",section:r};l(O=>[...O,N]),b(O=>({...O,[r]:O[r]+1})),u(!1)},1500):setTimeout(()=>{u(!1),x()},1500)}catch(f){console.error("Error processing input:",f),u(!1),x()}};return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Qt,{className:"h-8 w-8 text-indigo-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Daily Standup"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Let's review your progress and plan next steps"})]})]})}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsxs("div",{className:"h-[600px] overflow-y-auto p-6 space-y-4",children:[o.map((_,j)=>e.jsx("div",{className:`flex ${_.role==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] rounded-lg p-4 ${_.role==="user"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-900"}`,children:_.content})},j)),g&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gray-100 rounded-lg p-4 flex items-center space-x-2",children:e.jsxs("div",{className:"animate-pulse flex space-x-2",children:[e.jsx("div",{className:"h-2 w-2 bg-gray-400 rounded-full"}),e.jsx("div",{className:"h-2 w-2 bg-gray-400 rounded-full"}),e.jsx("div",{className:"h-2 w-2 bg-gray-400 rounded-full"})]})})})]}),e.jsx("div",{className:"border-t border-gray-200 p-4",children:e.jsxs("form",{onSubmit:w,className:"flex space-x-4",children:[e.jsx("input",{type:"text",value:m,onChange:_=>c(_.target.value),placeholder:"Type your message...",className:"flex-1 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),e.jsxs("button",{type:"submit",disabled:!m.trim()||g,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:[e.jsx(ln,{className:"h-4 w-4 mr-2"}),"Send"]})]})})]}),e.jsx(sm,{isOpen:p,onClose:()=>d(!1),standupEntry:a})]})})}const Re=[{id:"brainstorm",name:"Brainstorm",description:"Explore and refine raw ideas",icon:Ve,fields:["raw_idea","inspiration_source","initial_thoughts","market_opportunities","potential_challenges"]},{id:"concept",name:"Concept",description:"Define the problem and initial solution",icon:Ze,fields:["problem_statement","solution","unique_value"]},{id:"validation",name:"Validation",description:"Validate market need and feasibility",icon:sn,fields:["target_audience","market_size","competition"]},{id:"planning",name:"Planning",description:"Plan business model and go-to-market",icon:an,fields:["business_model","go_to_market","resources_needed"]},{id:"execution",name:"Execution",description:"Define actionable next steps",icon:on,fields:["next_steps"]}];function am(){var j;const{user:s}=X(),[t,r]=h.useState([]),[n,a]=h.useState(null),[i,o]=h.useState(!1),[l,m]=h.useState(!1),[c,g]=h.useState(!1),[u,p]=h.useState(""),[d,y]=h.useState("");h.useEffect(()=>{s&&b()},[s]);const b=async()=>{try{const{data:f,error:S}=await R.from("ideas").select("*").order("updated_at",{ascending:!1});if(S)throw S;r(f||[])}catch(f){console.error("Error loading ideas:",f),p(f.message)}},x=()=>{a({title:"New Idea",stage:"brainstorm",raw_idea:"",inspiration_source:"",initial_thoughts:"",market_opportunities:"",potential_challenges:"",problem_statement:"",target_audience:"",solution:"",unique_value:"",market_size:"",competition:"",business_model:"",go_to_market:"",resources_needed:"",next_steps:"",ai_feedback:{strengths:[],weaknesses:[],opportunities:[],threats:[],suggestions:[]}}),o(!0)},v=async()=>{if(n){g(!0),p("");try{const{feedback:f}=await as({accomplished:"",working_on:`
          Problem: ${n.problem_statement}
          Solution: ${n.solution}
          Target Audience: ${n.target_audience}
          Market Size: ${n.market_size}
          Competition: ${n.competition}
          Business Model: ${n.business_model}
          Go-to-Market: ${n.go_to_market}
          Resources Needed: ${n.resources_needed}
          Next Steps: ${n.next_steps}
        `,blockers:"",goals:n.unique_value},(s==null?void 0:s.id)||"");a(S=>({...S,ai_feedback:{strengths:f.strengths||[],weaknesses:f.weaknesses||[],opportunities:f.opportunities||[],threats:f.threats||[],suggestions:f.suggestions||[]}}))}catch(f){console.error("Error generating feedback:",f),p(f.message)}finally{g(!1)}}},w=async()=>{if(!(!n||!s)){m(!0),p(""),y("");try{if(n.id){const{error:f}=await R.from("ideas").update({...n,updated_at:new Date().toISOString()}).eq("id",n.id);if(f)throw f}else{const{data:f,error:S}=await R.from("ideas").insert([{...n,user_id:s.id}]).select().single();if(S)throw S;f&&a(f)}y("Idea saved successfully!"),b()}catch(f){console.error("Error saving idea:",f),p(f.message)}finally{m(!1)}}},_=async()=>{if(!n)return;const f=Re.findIndex(S=>S.id===n.stage);if(f<Re.length-1){const S=Re[f+1].id;a(N=>({...N,stage:S})),await w()}};return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{to:"/idea-hub",className:"mr-4 text-gray-400 hover:text-gray-500",children:e.jsx(Ye,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center",children:[e.jsx(Ze,{className:"h-6 w-6 mr-2"}),"Idea Flow"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Refine your ideas into buildable concepts"})]})]}),e.jsxs("button",{onClick:x,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"New Idea"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Your Ideas"}),e.jsx("div",{className:"space-y-4",children:t.map(f=>e.jsxs("button",{onClick:()=>{a(f),o(!1)},className:`w-full text-left p-4 rounded-lg border ${(n==null?void 0:n.id)===f.id?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("h3",{className:"font-medium text-gray-900",children:f.title}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Stage: ",f.stage.charAt(0).toUpperCase()+f.stage.slice(1)]}),e.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Updated ",new Date(f.updated_at).toLocaleDateString()]})]},f.id))})]}),e.jsx("div",{className:"lg:col-span-3",children:n?e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("nav",{"aria-label":"Progress",children:e.jsx("ol",{className:"flex items-center",children:Re.map((f,S)=>e.jsxs("li",{className:`${S!==Re.length-1?"flex-1":""} relative`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`${f.id===n.stage?"border-2 border-indigo-600":Re.findIndex(N=>N.id===n.stage)>S?"bg-indigo-600":"bg-gray-200"} rounded-full h-8 w-8 flex items-center justify-center`,children:e.jsx(f.icon,{className:`h-5 w-5 ${f.id===n.stage?"text-indigo-600":Re.findIndex(N=>N.id===n.stage)>S?"text-white":"text-gray-400"}`})}),S!==Re.length-1&&e.jsx("div",{className:`flex-1 h-0.5 mx-2 ${Re.findIndex(N=>N.id===n.stage)>S?"bg-indigo-600":"bg-gray-200"}`})]}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"text-xs font-medium",children:f.name})})]},f.id))})})}),e.jsxs("div",{className:"p-6",children:[u&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 rounded-md",children:e.jsx("p",{className:"text-sm text-red-700",children:u})}),d&&e.jsx("div",{className:"mb-4 p-4 bg-green-50 rounded-md",children:e.jsx("p",{className:"text-sm text-green-700",children:d})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx("input",{type:"text",value:n.title,onChange:f=>a(S=>({...S,title:f.target.value})),disabled:!i,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm disabled:bg-gray-50 disabled:text-gray-500"})]}),(j=Re.find(f=>f.id===n.stage))==null?void 0:j.fields.map(f=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:f.split("_").map(S=>S.charAt(0).toUpperCase()+S.slice(1)).join(" ")}),e.jsx("textarea",{value:n[f],onChange:S=>a(N=>({...N,[f]:S.target.value})),disabled:!i,rows:4,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm disabled:bg-gray-50 disabled:text-gray-500"})]},f)),n.ai_feedback&&e.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"AI Analysis"]}),e.jsxs("div",{className:"space-y-4",children:[n.ai_feedback.strengths.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Strengths"}),e.jsx("ul",{className:"mt-2 list-disc list-inside text-sm text-gray-600",children:n.ai_feedback.strengths.map((f,S)=>e.jsx("li",{children:f},S))})]}),n.ai_feedback.weaknesses.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Areas for Improvement"}),e.jsx("ul",{className:"mt-2 list-disc list-inside text-sm text-gray-600",children:n.ai_feedback.weaknesses.map((f,S)=>e.jsx("li",{children:f},S))})]}),n.ai_feedback.opportunities.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Opportunities"}),e.jsx("ul",{className:"mt-2 list-disc list-inside text-sm text-gray-600",children:n.ai_feedback.opportunities.map((f,S)=>e.jsx("li",{children:f},S))})]}),n.ai_feedback.threats.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Risks"}),e.jsx("ul",{className:"mt-2 list-disc list-inside text-sm text-gray-600",children:n.ai_feedback.threats.map((f,S)=>e.jsx("li",{children:f},S))})]}),n.ai_feedback.suggestions.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Suggestions"}),e.jsx("ul",{className:"mt-2 list-disc list-inside text-sm text-gray-600",children:n.ai_feedback.suggestions.map((f,S)=>e.jsx("li",{children:f},S))})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>o(!i),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:i?"Cancel":"Edit"}),e.jsxs("button",{onClick:v,disabled:c,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),c?"Generating...":"Get AI Feedback"]}),e.jsxs(G,{to:"/idea-hub/cofounder-bot",className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Discuss with AI"]})]}),e.jsxs("div",{className:"flex space-x-3",children:[i&&e.jsxs("button",{onClick:w,disabled:l,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),l?"Saving...":"Save"]}),!i&&e.jsxs("button",{onClick:_,disabled:n.stage==="execution",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:["Next Stage",e.jsx(Z,{className:"h-4 w-4 ml-2"})]})]})]})]})]})]}):e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:[e.jsx(Ze,{className:"h-12 w-12 text-gray-400 mx-auto"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No idea selected"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Select an existing idea or create a new one to get started"}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:x,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"New Idea"]})})]})})]})]})})}function im({isOpen:s,onClose:t,onSuccess:r}){const{user:n}=X(),[a,i]=h.useState({name:"",description:"",is_private:!1}),[o,l]=h.useState(""),[m,c]=h.useState(!1),g=async u=>{if(u.preventDefault(),!!n){l(""),c(!0);try{const p=a.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),{data:d,error:y}=await R.from("communities").insert({name:a.name,description:a.description,slug:p,is_private:a.is_private,owner_id:n.id,member_count:1}).select().single();if(y)throw y;if(d){const{error:b}=await R.from("community_members").insert({community_id:d.id,user_id:n.id,role:"owner"});if(b)throw b}r(),t(),i({name:"",description:"",is_private:!1})}catch(p){console.error("Error creating community:",p),l(p.message||"Failed to create community")}finally{c(!1)}}};return s?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:t}),e.jsxs("div",{className:"relative w-full max-w-md rounded-lg bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 px-6 py-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Create Community"}),e.jsx("button",{onClick:t,className:"rounded-full p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-500",children:e.jsx(de,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:g,className:"p-6",children:[o&&e.jsx("div",{className:"mb-4 rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(fe,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:o})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:["Community Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",name:"name",required:!0,value:a.name,onChange:u=>i({...a,name:u.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter community name"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",rows:4,value:a.description,onChange:u=>i({...a,description:u.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Describe your community..."})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_private",name:"is_private",checked:a.is_private,onChange:u=>i({...a,is_private:u.target.checked}),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"is_private",className:"ml-2 block text-sm text-gray-900",children:"Make this community private"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:t,className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:"inline-flex items-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50",children:m?"Creating...":"Create Community"})]})]})]})]})}):null}function om(){Ue();const{user:s}=X();h.useState("discussions");const[t,r]=h.useState([]),[n,a]=h.useState(!0),[i,o]=h.useState(!1),[l,m]=h.useState(""),[c,g]=h.useState("all");h.useEffect(()=>{u()},[]);const u=async()=>{try{const{data:d,error:y}=await R.from("communities").select("*").order("created_at",{ascending:!1});if(y)throw y;r(d||[])}catch(d){console.error("Error loading communities:",d)}finally{a(!1)}},p=t.filter(d=>{var x;return(d.name.toLowerCase().includes(l.toLowerCase())||((x=d.description)==null?void 0:x.toLowerCase().includes(l.toLowerCase())))&&(c==="all"||!0)});return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center",children:[e.jsx(Ee,{className:"h-6 w-6 mr-2"}),"Communities"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Join communities to connect with other founders and entrepreneurs"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Create Community"]})]}),e.jsxs("div",{className:"mb-8 flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(rt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"search",value:l,onChange:d=>m(d.target.value),placeholder:"Search communities...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("select",{value:c,onChange:d=>g(d.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"tech",children:"Technology"}),e.jsx("option",{value:"business",children:"Business"}),e.jsx("option",{value:"startup",children:"Startups"}),e.jsx("option",{value:"product",children:"Product"})]})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:p.map(d=>e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow duration-200",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.jsx(G,{to:`/community/${d.slug}`,className:"hover:text-indigo-600",children:d.name})}),d.is_private&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Private"})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-4 line-clamp-2",children:d.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),d.member_count," members"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ut,{className:"h-4 w-4 mr-1"}),d.owner_id===(s==null?void 0:s.id)?"You":"Member"]})]})]}),e.jsx("div",{className:"bg-gray-50 px-6 py-4",children:e.jsxs(G,{to:`/community/${d.slug}`,className:"text-sm font-medium text-indigo-600 hover:text-indigo-900",children:["View Community",e.jsx("span",{"aria-hidden":"true",children:" →"})]})})]},d.id))}),e.jsx(im,{isOpen:i,onClose:()=>o(!1),onSuccess:u})]})})}function lm(){const{slug:s}=Oa(),t=Ue(),{user:r}=X(),[n,a]=h.useState(null),[i,o]=h.useState([]),[l,m]=h.useState([]),[c,g]=h.useState([]),[u,p]=h.useState([]),[d,y]=h.useState("discussions"),[b,x]=h.useState(!0),[v,w]=h.useState(!1),[_,j]=h.useState(!1),[f,S]=h.useState("");h.useEffect(()=>{s&&N()},[s]);const N=async()=>{if(s){S("");try{const{data:C,error:k}=await R.from("communities").select(`
          *,
          owner:profiles!communities_owner_id_fkey(full_name)
        `).eq("slug",s).single();if(k)throw k;if(!C){S("Community not found");return}a(C);const{data:E,error:A}=await R.from("community_members").select(`
          *,
          user:profiles(full_name, avatar_url)
        `).eq("community_id",C.id);if(A)throw A;if(E){o(E);const ne=E.find(xt=>xt.user_id===(r==null?void 0:r.id));w(!!ne),j((ne==null?void 0:ne.role)==="admin"||(ne==null?void 0:ne.role)==="owner")}const{data:D,error:$}=await R.from("community_posts").select(`
          *,
          author:profiles(full_name)
        `).eq("community_id",C.id).order("created_at",{ascending:!1}).limit(5);if($)throw $;D&&m(D);const{data:U,error:Y}=await R.from("community_events").select(`
          *,
          organizer:profiles(full_name)
        `).eq("community_id",C.id).gte("end_time",new Date().toISOString()).order("start_time",{ascending:!0}).limit(5);if(Y)throw Y;U&&g(U);const{data:re,error:ve}=await R.from("community_documents").select(`
          *,
          author:profiles(full_name)
        `).eq("community_id",C.id).order("created_at",{ascending:!1}).limit(5);if(ve)throw ve;re&&p(re)}catch(C){console.error("Error loading community:",C),S(C.message||"Failed to load community data")}finally{x(!1)}}},O=async()=>{if(!(!r||!n))try{const{error:C}=await R.from("community_members").insert({community_id:n.id,user_id:r.id,role:"member"});if(C)throw C;await N()}catch(C){console.error("Error joining community:",C),S(C.message||"Failed to join community")}},T=()=>{n&&t(`/community/${s}/new-post`)},I=()=>{n&&t(`/community/${s}/new-event`)},P=()=>{n&&t(`/community/${s}/upload-document`)};return b?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):f?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[e.jsx(fe,{className:"h-12 w-12 text-red-500 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error"}),e.jsx("p",{className:"text-gray-500",children:f}),e.jsx("button",{onClick:()=>t("/community"),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:"Back to Communities"})]}):n?e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg mb-8",children:[e.jsx("div",{className:"h-32 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-t-lg"}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n.name}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n.description})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[!v&&e.jsxs("button",{onClick:O,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Join Community"]}),_&&e.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(Zt,{className:"h-4 w-4 mr-2"}),"Manage"]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center space-x-8 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),n.member_count," members"]}),e.jsxs("div",{children:["Created by ",n.owner.full_name]})]})]})]}),e.jsx("div",{className:"bg-white shadow rounded-lg mb-8",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex",children:[e.jsxs("button",{onClick:()=>y("discussions"),className:`${d==="discussions"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex-1 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center justify-center`,children:[e.jsx(Ee,{className:"h-5 w-5 mr-2"}),"Discussions"]}),e.jsxs("button",{onClick:()=>y("events"),className:`${d==="events"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex-1 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center justify-center`,children:[e.jsx(Ms,{className:"h-5 w-5 mr-2"}),"Events"]}),e.jsxs("button",{onClick:()=>y("members"),className:`${d==="members"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex-1 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center justify-center`,children:[e.jsx(xe,{className:"h-5 w-5 mr-2"}),"Members"]}),e.jsxs("button",{onClick:()=>y("documents"),className:`${d==="documents"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex-1 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center justify-center`,children:[e.jsx($s,{className:"h-5 w-5 mr-2"}),"Documents"]})]})})}),e.jsxs("div",{className:"space-y-6",children:[d==="discussions"&&e.jsx("div",{className:"bg-white shadow rounded-lg divide-y divide-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Recent Discussions"}),v&&e.jsxs("button",{onClick:T,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"New Discussion"]})]}),l.length>0?e.jsx("div",{className:"space-y-6",children:l.map(C=>e.jsx("div",{className:"flex space-x-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:e.jsx(G,{to:`/community/${s}/post/${C.id}`,className:"hover:text-indigo-600",children:C.title})}),e.jsx("div",{className:"mt-1 text-sm text-gray-500 line-clamp-2",children:C.content}),e.jsxs("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-500",children:[e.jsx("span",{children:C.author.full_name}),e.jsx("span",{children:"•"}),e.jsx("span",{children:new Date(C.created_at).toLocaleDateString()})]})]})},C.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ee,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No discussions yet"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get the conversation started by creating the first discussion."})]})]})}),d==="events"&&e.jsx("div",{className:"bg-white shadow rounded-lg divide-y divide-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Upcoming Events"}),v&&e.jsxs("button",{onClick:I,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Create Event"]})]}),c.length>0?e.jsx("div",{className:"space-y-6",children:c.map(C=>e.jsx("div",{className:"flex space-x-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:C.title}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:C.description}),e.jsxs("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"h-4 w-4 mr-1"}),new Date(C.start_time).toLocaleString()]}),e.jsx("div",{children:C.location})]})]})},C.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ms,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No upcoming events"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Create an event to bring the community together."})]})]})}),d==="members"&&e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Members"}),_&&e.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Invite Members"]})]}),i.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:i.map(C=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:C.user.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(C.user.full_name)}`,alt:"",className:"h-10 w-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:C.user.full_name}),e.jsx("p",{className:"text-sm text-gray-500 capitalize",children:C.role})]})]},C.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(xe,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No members yet"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Invite others to join this community."})]})]})}),d==="documents"&&e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Documents"}),v&&e.jsxs("button",{onClick:P,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Upload Document"]})]}),u.length>0?e.jsx("div",{className:"space-y-6",children:u.map(C=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(he,{className:"h-8 w-8 text-gray-400"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:C.title}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:C.description}),e.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:["Uploaded by ",C.author.full_name," • ",new Date(C.created_at).toLocaleDateString()]})]})]}),e.jsx("button",{className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Download"})]},C.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx($s,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No documents yet"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Upload documents to share with the community."})]})]})})]})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[e.jsx(fe,{className:"h-12 w-12 text-red-500 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Community Not Found"}),e.jsx("p",{className:"text-gray-500",children:"The community you're looking for doesn't exist."}),e.jsx("button",{onClick:()=>t("/community"),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:"Back to Communities"})]})}function cm(){var v,w,_;const{id:s}=Oa(),{user:t}=X(),[r,n]=h.useState(null),[a,i]=h.useState([]),[o,l]=h.useState(""),[m,c]=h.useState(!1),[g,u]=h.useState(null);h.useEffect(()=>{s&&(p(),d(),t&&y())},[s,t]);const p=async()=>{if(!s)return;const{data:j,error:f}=await R.from("community_posts").select(`
        *,
        author:author_id (
          full_name,
          avatar_url
        )
      `).eq("id",s).single();if(f){console.error("Error loading post:",f);return}n(j)},d=async()=>{if(!s)return;const{data:j,error:f}=await R.from("community_comments").select(`
        *,
        author:author_id (
          full_name,
          avatar_url
        )
      `).eq("post_id",s).order("created_at",{ascending:!0});if(f){console.error("Error loading comments:",f);return}i(j||[])},y=async()=>{if(!s||!t)return;const{data:j}=await R.from("community_post_votes").select("vote_type").eq("post_id",s).eq("user_id",t.id).single();j&&u(j.vote_type)},b=async j=>{if(!(!t||!s))try{g===j?(await R.from("community_post_votes").delete().eq("post_id",s).eq("user_id",t.id),u(null)):(await R.from("community_post_votes").upsert({post_id:s,user_id:t.id,vote_type:j}),u(j)),p()}catch(f){console.error("Error voting:",f)}},x=async j=>{if(j.preventDefault(),!(!t||!o.trim()||!s)){c(!0);try{const{error:f}=await R.from("community_comments").insert({post_id:s,author_id:t.id,content:o});if(f)throw f;l(""),d()}catch(f){console.error("Error submitting comment:",f)}finally{c(!1)}}};return r?e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs(G,{to:"/community",className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700 mb-6",children:[e.jsx(Ye,{className:"h-4 w-4 mr-1"}),"Back to Discussions"]}),e.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{className:"h-10 w-10 rounded-full",src:((v=r.author)==null?void 0:v.avatar_url)||`https://ui-avatars.com/api/?name=${encodeURIComponent(((w=r.author)==null?void 0:w.full_name)||"User")}`,alt:""}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:(_=r.author)==null?void 0:_.full_name}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(Le,{className:"h-4 w-4 mr-1"}),new Date(r.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(Wa,{className:"h-5 w-5 text-gray-400"})}),e.jsx("button",{className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(Tl,{className:"h-5 w-5 text-gray-400"})})]})]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:r.title}),e.jsx("div",{className:"prose max-w-none mb-6",children:r.content}),r.tags&&r.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:r.tags.map(j=>e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[e.jsx(cn,{className:"h-3 w-3 mr-1"}),j]},j))}),e.jsx("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>b(!0),className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium ${g===!0?"bg-green-100 text-green-800":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx(Xn,{className:"h-4 w-4 mr-1"}),r.upvotes]}),e.jsxs("button",{onClick:()=>b(!1),className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium ${g===!1?"bg-red-100 text-red-800":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx(Yn,{className:"h-4 w-4 mr-1"}),r.downvotes]}),e.jsxs("div",{className:"inline-flex items-center text-sm text-gray-500",children:[e.jsx(Dl,{className:"h-4 w-4 mr-1"}),a.length," comments"]})]})})]})}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Comments"}),t?e.jsxs("form",{onSubmit:x,className:"mb-8",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"comment",className:"sr-only",children:"Add your comment"}),e.jsx("textarea",{id:"comment",rows:3,value:o,onChange:j=>l(j.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Add your comment..."})]}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx("button",{type:"submit",disabled:m||!o.trim(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:m?"Posting...":"Post Comment"})})]}):e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 text-center mb-8",children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Please"," ",e.jsx(G,{to:"/login",className:"text-indigo-600 hover:text-indigo-900",children:"sign in"})," ","to join the discussion."]})}),e.jsx("div",{className:"space-y-6",children:a.map(j=>{var f,S,N;return e.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{className:"h-10 w-10 rounded-full",src:((f=j.author)==null?void 0:f.avatar_url)||`https://ui-avatars.com/api/?name=${encodeURIComponent(((S=j.author)==null?void 0:S.full_name)||"User")}`,alt:""})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:(N=j.author)==null?void 0:N.full_name}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(j.created_at).toLocaleDateString()}),e.jsx("div",{className:"mt-2 text-sm text-gray-700",children:j.content}),e.jsxs("div",{className:"mt-2 flex items-center space-x-4",children:[e.jsxs("button",{className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700",children:[e.jsx(Xn,{className:"h-4 w-4 mr-1"}),j.upvotes]}),e.jsxs("button",{className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700",children:[e.jsx(Yn,{className:"h-4 w-4 mr-1"}),j.downvotes]}),e.jsx("button",{className:"text-sm text-gray-500 hover:text-gray-700",children:"Reply"})]})]})]})},j.id)})})]})]})}):e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-3/4 mb-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6"})]})]})})})}function dm(){const s=Ue(),{user:t}=X(),[r,n]=h.useState(""),[a,i]=h.useState(""),[o,l]=h.useState("discussion"),[m,c]=h.useState(""),[g,u]=h.useState([]),[p,d]=h.useState(""),[y,b]=h.useState(!1),[x,v]=h.useState(""),w=f=>{f.key==="Enter"&&p.trim()&&(f.preventDefault(),g.includes(p.trim())||u([...g,p.trim()]),d(""))},_=f=>{u(g.filter(S=>S!==f))},j=async f=>{if(f.preventDefault(),!!t){if(!r.trim()||!a.trim()){v("Please fill in all required fields");return}b(!0),v("");try{const{data:S,error:N}=await R.from("community_posts").insert({title:r,content:a,author_id:t.id,post_type:o,category:m,tags:g}).select().single();if(N)throw N;s(`/community/post/${S.id}`)}catch(S){console.error("Error creating post:",S),v("Failed to create post. Please try again.")}finally{b(!1)}}};return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{to:"/community",className:"mr-4 text-gray-400 hover:text-gray-500",children:e.jsx(Ye,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center",children:[e.jsx(Ee,{className:"h-6 w-6 mr-2"}),"Create New Post"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Share your thoughts with the community"})]})]})}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[x&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"text-sm text-red-700",children:x})}),e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Post Type"}),e.jsxs("select",{value:o,onChange:f=>l(f.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"discussion",children:"Discussion"}),e.jsx("option",{value:"question",children:"Question"}),e.jsx("option",{value:"announcement",children:"Announcement"}),e.jsx("option",{value:"resource",children:"Resource"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:["Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"title",value:r,onChange:f=>n(f.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter a descriptive title",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700",children:["Content ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"content",rows:8,value:a,onChange:f=>i(f.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Write your post content here...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700",children:"Category"}),e.jsxs("select",{id:"category",value:m,onChange:f=>c(f.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select a category"}),e.jsx("option",{value:"product_development",children:"Product Development"}),e.jsx("option",{value:"marketing",children:"Marketing"}),e.jsx("option",{value:"fundraising",children:"Fundraising"}),e.jsx("option",{value:"growth",children:"Growth"}),e.jsx("option",{value:"technology",children:"Technology"}),e.jsx("option",{value:"design",children:"Design"}),e.jsx("option",{value:"business",children:"Business"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-700",children:"Tags"}),e.jsxs("div",{className:"mt-1",children:[e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:g.map(f=>e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:[e.jsx(cn,{className:"h-3 w-3 mr-1"}),f,e.jsx("button",{type:"button",onClick:()=>_(f),className:"ml-1 inline-flex items-center p-0.5 rounded-full text-indigo-400 hover:bg-indigo-200 hover:text-indigo-500",children:e.jsx(de,{className:"h-3 w-3"})})]},f))}),e.jsx("input",{type:"text",id:"tags",value:p,onChange:f=>d(f.target.value),onKeyDown:w,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Press Enter to add tags"})]})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 flex items-center justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>s("/community"),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:y,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),y?"Creating...":"Create Post"]})]})]})]})]})})}function mm(){var T,I,P;const{user:s,profile:t}=X(),[r,n]=h.useState([]),[a,i]=h.useState(null),[o,l]=h.useState([]),[m,c]=h.useState(""),[g,u]=h.useState(""),[p,d]=h.useState(""),[y,b]=h.useState(!1),[x,v]=h.useState(""),[w,_]=h.useState(!0);h.useEffect(()=>{s&&j()},[s]),h.useEffect(()=>{a&&f(a.id)},[a]);const j=async()=>{try{const{data:C,error:k}=await R.from("conversations").select(`
          *,
          participant1:participant1_id(full_name, avatar_url, email),
          participant2:participant2_id(full_name, avatar_url, email)
        `).or(`participant1_id.eq.${s==null?void 0:s.id},participant2_id.eq.${s==null?void 0:s.id}`).order("last_message_at",{ascending:!1});if(k)throw k;if(C){const E=C.map(A=>({...A,participant:A.participant1_id===(s==null?void 0:s.id)?A.participant2:A.participant1}));n(E)}}catch(C){console.error("Error loading conversations:",C)}finally{_(!1)}},f=async C=>{try{const{data:k,error:E}=await R.from("messages").select(`
          *,
          sender:sender_id(full_name, avatar_url)
        `).eq("conversation_id",C).order("created_at",{ascending:!0});if(E)throw E;if(l(k||[]),k){const A=k.filter(D=>!D.is_read&&D.recipient_id===(s==null?void 0:s.id));A.length>0&&await R.from("messages").update({is_read:!0}).in("id",A.map(D=>D.id))}}catch(k){console.error("Error loading messages:",k)}},S=async()=>{if(!s||!p.trim()){v("Please enter a recipient email");return}try{const{data:C,error:k}=await R.rpc("get_user_by_email",{email:p});if(k||!C){v("User not found. Please check the email address.");return}const{data:E,error:A}=await R.from("conversations").insert({participant1_id:s.id,participant2_id:C.id}).select().single();if(A){A.code==="23505"?v("A conversation with this user already exists."):v("Failed to start conversation. Please try again.");return}d(""),b(!1),j(),E&&i(E)}catch(C){console.error("Error starting conversation:",C),v("An unexpected error occurred. Please try again.")}},N=async C=>{if(C.preventDefault(),!(!s||!a||!m.trim()))try{const k=a.participant1_id===s.id?a.participant2_id:a.participant1_id,{error:E}=await R.from("messages").insert({conversation_id:a.id,sender_id:s.id,recipient_id:k,content:m});if(E)throw E;c(""),f(a.id),j()}catch(k){console.error("Error sending message:",k)}},O=r.filter(C=>{var k,E,A,D;return((E=(k=C.participant)==null?void 0:k.full_name)==null?void 0:E.toLowerCase().includes(g.toLowerCase()))||((D=(A=C.participant)==null?void 0:A.email)==null?void 0:D.toLowerCase().includes(g.toLowerCase()))});return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex h-[calc(100vh-200px)] bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"w-96 border-r border-gray-200 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Messages"}),e.jsxs("button",{onClick:()=>b(!0),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"New Message"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(rt,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:g,onChange:C=>u(C.target.value),placeholder:"Search conversations...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:O.map(C=>{var k,E,A,D;return e.jsxs("button",{onClick:()=>i(C),className:`w-full p-4 flex items-center space-x-3 hover:bg-gray-50 ${(a==null?void 0:a.id)===C.id?"bg-blue-50":""}`,children:[(k=C.participant)!=null&&k.avatar_url?e.jsx("img",{src:C.participant.avatar_url,alt:"",className:"h-10 w-10 rounded-full"}):e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(Ls,{className:"h-6 w-6 text-gray-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:((E=C.participant)==null?void 0:E.full_name)||((A=C.participant)==null?void 0:A.email)}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(C.last_message_at).toLocaleDateString()})]}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:(D=C.last_message)==null?void 0:D.content})]})]},C.id)})})]}),e.jsx("div",{className:"flex-1 flex flex-col",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[(T=a.participant)!=null&&T.avatar_url?e.jsx("img",{src:a.participant.avatar_url,alt:"",className:"h-8 w-8 rounded-full"}):e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(Ls,{className:"h-5 w-5 text-gray-500"})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:((I=a.participant)==null?void 0:I.full_name)||((P=a.participant)==null?void 0:P.email)})})]})}),e.jsx("div",{className:"flex-1 p-4 space-y-4 overflow-y-auto",children:o.map(C=>e.jsx("div",{className:`flex ${C.sender_id===(s==null?void 0:s.id)?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[70%] rounded-lg p-4 ${C.sender_id===(s==null?void 0:s.id)?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:[e.jsx("p",{className:"text-sm",children:C.content}),e.jsxs("p",{className:`text-xs mt-1 flex items-center ${C.sender_id===(s==null?void 0:s.id)?"text-blue-200":"text-gray-500"}`,children:[e.jsx(Le,{className:"h-3 w-3 mr-1"}),new Date(C.created_at).toLocaleTimeString()]})]})},C.id))}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs("form",{onSubmit:N,className:"flex space-x-4",children:[e.jsx("input",{type:"text",value:m,onChange:C=>c(C.target.value),placeholder:"Type your message...",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}),e.jsxs("button",{type:"submit",disabled:!m.trim(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[e.jsx(ln,{className:"h-4 w-4 mr-2"}),"Send"]})]})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ee,{className:"h-12 w-12 text-gray-400 mx-auto"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No conversation selected"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Choose a conversation or start a new one"})]})})})]}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"New Message"}),e.jsx("button",{onClick:()=>{b(!1),d(""),v("")},className:"text-gray-400 hover:text-gray-500",children:e.jsx(de,{className:"h-5 w-5"})})]}),x&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 rounded-md",children:e.jsx("p",{className:"text-sm text-red-700",children:x})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"recipient",className:"block text-sm font-medium text-gray-700",children:"Recipient Email"}),e.jsx("input",{type:"email",id:"recipient",value:p,onChange:C=>d(C.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Enter recipient's email"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{b(!1),d(""),v("")},className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:S,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:"Start Conversation"})]})]})]})})]})})}function ze(s,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(s==null||s(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function ja(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function co(...s){return t=>{let r=!1;const n=s.map(a=>{const i=ja(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():ja(s[a],null)}}}}function ht(...s){return h.useCallback(co(...s),s)}function mo(s,t=[]){let r=[];function n(i,o){const l=h.createContext(o),m=r.length;r=[...r,o];const c=u=>{var v;const{scope:p,children:d,...y}=u,b=((v=p==null?void 0:p[s])==null?void 0:v[m])||l,x=h.useMemo(()=>y,Object.values(y));return e.jsx(b.Provider,{value:x,children:d})};c.displayName=i+"Provider";function g(u,p){var b;const d=((b=p==null?void 0:p[s])==null?void 0:b[m])||l,y=h.useContext(d);if(y)return y;if(o!==void 0)return o;throw new Error(`\`${u}\` must be used within \`${i}\``)}return[c,g]}const a=()=>{const i=r.map(o=>h.createContext(o));return function(l){const m=(l==null?void 0:l[s])||i;return h.useMemo(()=>({[`__scope${s}`]:{...l,[s]:m}}),[l,m])}};return a.scopeName=s,[n,um(a,...t)]}function um(...s){const t=s[0];if(s.length===1)return t;const r=()=>{const n=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:m,scopeName:c})=>{const u=m(i)[`__scope${c}`];return{...l,...u}},{});return h.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}var uo=h.forwardRef((s,t)=>{const{children:r,...n}=s,a=h.Children.toArray(r),i=a.find(hm);if(i){const o=i.props.children,l=a.map(m=>m===i?h.Children.count(o)>1?h.Children.only(null):h.isValidElement(o)?o.props.children:null:m);return e.jsx(Gr,{...n,ref:t,children:h.isValidElement(o)?h.cloneElement(o,void 0,l):null})}return e.jsx(Gr,{...n,ref:t,children:r})});uo.displayName="Slot";var Gr=h.forwardRef((s,t)=>{const{children:r,...n}=s;if(h.isValidElement(r)){const a=fm(r),i=xm(n,r.props);return r.type!==h.Fragment&&(i.ref=t?co(t,a):a),h.cloneElement(r,i)}return h.Children.count(r)>1?h.Children.only(null):null});Gr.displayName="SlotClone";var ho=({children:s})=>e.jsx(e.Fragment,{children:s});function hm(s){return h.isValidElement(s)&&s.type===ho}function xm(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function fm(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var gm=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],at=gm.reduce((s,t)=>{const r=h.forwardRef((n,a)=>{const{asChild:i,...o}=n,l=i?uo:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{});function pm(s,t){s&&Zr.flushSync(()=>s.dispatchEvent(t))}function Dt(s){const t=h.useRef(s);return h.useEffect(()=>{t.current=s}),h.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function ym(s,t=globalThis==null?void 0:globalThis.document){const r=Dt(s);h.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var bm="DismissableLayer",Vr="dismissableLayer.update",wm="dismissableLayer.pointerDownOutside",jm="dismissableLayer.focusOutside",va,xo=h.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),fo=h.forwardRef((s,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...m}=s,c=h.useContext(xo),[g,u]=h.useState(null),p=(g==null?void 0:g.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,d]=h.useState({}),y=ht(t,N=>u(N)),b=Array.from(c.layers),[x]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),v=b.indexOf(x),w=g?b.indexOf(g):-1,_=c.layersWithOutsidePointerEventsDisabled.size>0,j=w>=v,f=_m(N=>{const O=N.target,T=[...c.branches].some(I=>I.contains(O));!j||T||(a==null||a(N),o==null||o(N),N.defaultPrevented||l==null||l())},p),S=km(N=>{const O=N.target;[...c.branches].some(I=>I.contains(O))||(i==null||i(N),o==null||o(N),N.defaultPrevented||l==null||l())},p);return ym(N=>{w===c.layers.size-1&&(n==null||n(N),!N.defaultPrevented&&l&&(N.preventDefault(),l()))},p),h.useEffect(()=>{if(g)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(va=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(g)),c.layers.add(g),Na(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=va)}},[g,p,r,c]),h.useEffect(()=>()=>{g&&(c.layers.delete(g),c.layersWithOutsidePointerEventsDisabled.delete(g),Na())},[g,c]),h.useEffect(()=>{const N=()=>d({});return document.addEventListener(Vr,N),()=>document.removeEventListener(Vr,N)},[]),e.jsx(at.div,{...m,ref:y,style:{pointerEvents:_?j?"auto":"none":void 0,...s.style},onFocusCapture:ze(s.onFocusCapture,S.onFocusCapture),onBlurCapture:ze(s.onBlurCapture,S.onBlurCapture),onPointerDownCapture:ze(s.onPointerDownCapture,f.onPointerDownCapture)})});fo.displayName=bm;var vm="DismissableLayerBranch",Nm=h.forwardRef((s,t)=>{const r=h.useContext(xo),n=h.useRef(null),a=ht(t,n);return h.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),e.jsx(at.div,{...s,ref:a})});Nm.displayName=vm;function _m(s,t=globalThis==null?void 0:globalThis.document){const r=Dt(s),n=h.useRef(!1),a=h.useRef(()=>{});return h.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let m=function(){go(wm,r,c,{discrete:!0})};const c={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=m,t.addEventListener("click",a.current,{once:!0})):m()}else t.removeEventListener("click",a.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function km(s,t=globalThis==null?void 0:globalThis.document){const r=Dt(s),n=h.useRef(!1);return h.useEffect(()=>{const a=i=>{i.target&&!n.current&&go(jm,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Na(){const s=new CustomEvent(Vr);document.dispatchEvent(s)}function go(s,t,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(s,t,{once:!0}),n?pm(a,i):a.dispatchEvent(i)}var dt=globalThis!=null&&globalThis.document?h.useLayoutEffect:()=>{},Cm=el.useId||(()=>{}),Sm=0;function Em(s){const[t,r]=h.useState(Cm());return dt(()=>{r(n=>n??String(Sm++))},[s]),t?`radix-${t}`:""}const Am=["top","right","bottom","left"],et=Math.min,be=Math.max,Hs=Math.round,js=Math.floor,$e=s=>({x:s,y:s}),Pm={left:"right",right:"left",bottom:"top",top:"bottom"},Im={start:"end",end:"start"};function Jr(s,t,r){return be(s,et(t,r))}function Je(s,t){return typeof s=="function"?s(t):s}function Xe(s){return s.split("-")[0]}function Ot(s){return s.split("-")[1]}function Tn(s){return s==="x"?"y":"x"}function Dn(s){return s==="y"?"height":"width"}function tt(s){return["top","bottom"].includes(Xe(s))?"y":"x"}function On(s){return Tn(tt(s))}function Rm(s,t,r){r===void 0&&(r=!1);const n=Ot(s),a=On(s),i=Dn(a);let o=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=zs(o)),[o,zs(o)]}function Tm(s){const t=zs(s);return[Xr(s),t,Xr(t)]}function Xr(s){return s.replace(/start|end/g,t=>Im[t])}function Dm(s,t,r){const n=["left","right"],a=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(s){case"top":case"bottom":return r?t?a:n:t?n:a;case"left":case"right":return t?i:o;default:return[]}}function Om(s,t,r,n){const a=Ot(s);let i=Dm(Xe(s),r==="start",n);return a&&(i=i.map(o=>o+"-"+a),t&&(i=i.concat(i.map(Xr)))),i}function zs(s){return s.replace(/left|right|bottom|top/g,t=>Pm[t])}function Fm(s){return{top:0,right:0,bottom:0,left:0,...s}}function po(s){return typeof s!="number"?Fm(s):{top:s,right:s,bottom:s,left:s}}function Gs(s){const{x:t,y:r,width:n,height:a}=s;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function _a(s,t,r){let{reference:n,floating:a}=s;const i=tt(t),o=On(t),l=Dn(o),m=Xe(t),c=i==="y",g=n.x+n.width/2-a.width/2,u=n.y+n.height/2-a.height/2,p=n[l]/2-a[l]/2;let d;switch(m){case"top":d={x:g,y:n.y-a.height};break;case"bottom":d={x:g,y:n.y+n.height};break;case"right":d={x:n.x+n.width,y:u};break;case"left":d={x:n.x-a.width,y:u};break;default:d={x:n.x,y:n.y}}switch(Ot(t)){case"start":d[o]-=p*(r&&c?-1:1);break;case"end":d[o]+=p*(r&&c?-1:1);break}return d}const Mm=async(s,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:i=[],platform:o}=r,l=i.filter(Boolean),m=await(o.isRTL==null?void 0:o.isRTL(t));let c=await o.getElementRects({reference:s,floating:t,strategy:a}),{x:g,y:u}=_a(c,n,m),p=n,d={},y=0;for(let b=0;b<l.length;b++){const{name:x,fn:v}=l[b],{x:w,y:_,data:j,reset:f}=await v({x:g,y:u,initialPlacement:n,placement:p,strategy:a,middlewareData:d,rects:c,platform:o,elements:{reference:s,floating:t}});g=w??g,u=_??u,d={...d,[x]:{...d[x],...j}},f&&y<=50&&(y++,typeof f=="object"&&(f.placement&&(p=f.placement),f.rects&&(c=f.rects===!0?await o.getElementRects({reference:s,floating:t,strategy:a}):f.rects),{x:g,y:u}=_a(c,p,m)),b=-1)}return{x:g,y:u,placement:p,strategy:a,middlewareData:d}};async function Yt(s,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:i,rects:o,elements:l,strategy:m}=s,{boundary:c="clippingAncestors",rootBoundary:g="viewport",elementContext:u="floating",altBoundary:p=!1,padding:d=0}=Je(t,s),y=po(d),x=l[p?u==="floating"?"reference":"floating":u],v=Gs(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(x)))==null||r?x:x.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:c,rootBoundary:g,strategy:m})),w=u==="floating"?{x:n,y:a,width:o.floating.width,height:o.floating.height}:o.reference,_=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),j=await(i.isElement==null?void 0:i.isElement(_))?await(i.getScale==null?void 0:i.getScale(_))||{x:1,y:1}:{x:1,y:1},f=Gs(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:w,offsetParent:_,strategy:m}):w);return{top:(v.top-f.top+y.top)/j.y,bottom:(f.bottom-v.bottom+y.bottom)/j.y,left:(v.left-f.left+y.left)/j.x,right:(f.right-v.right+y.right)/j.x}}const $m=s=>({name:"arrow",options:s,async fn(t){const{x:r,y:n,placement:a,rects:i,platform:o,elements:l,middlewareData:m}=t,{element:c,padding:g=0}=Je(s,t)||{};if(c==null)return{};const u=po(g),p={x:r,y:n},d=On(a),y=Dn(d),b=await o.getDimensions(c),x=d==="y",v=x?"top":"left",w=x?"bottom":"right",_=x?"clientHeight":"clientWidth",j=i.reference[y]+i.reference[d]-p[d]-i.floating[y],f=p[d]-i.reference[d],S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let N=S?S[_]:0;(!N||!await(o.isElement==null?void 0:o.isElement(S)))&&(N=l.floating[_]||i.floating[y]);const O=j/2-f/2,T=N/2-b[y]/2-1,I=et(u[v],T),P=et(u[w],T),C=I,k=N-b[y]-P,E=N/2-b[y]/2+O,A=Jr(C,E,k),D=!m.arrow&&Ot(a)!=null&&E!==A&&i.reference[y]/2-(E<C?I:P)-b[y]/2<0,$=D?E<C?E-C:E-k:0;return{[d]:p[d]+$,data:{[d]:A,centerOffset:E-A-$,...D&&{alignmentOffset:$}},reset:D}}}),Lm=function(s){return s===void 0&&(s={}),{name:"flip",options:s,async fn(t){var r,n;const{placement:a,middlewareData:i,rects:o,initialPlacement:l,platform:m,elements:c}=t,{mainAxis:g=!0,crossAxis:u=!0,fallbackPlacements:p,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:b=!0,...x}=Je(s,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const v=Xe(a),w=tt(l),_=Xe(l)===l,j=await(m.isRTL==null?void 0:m.isRTL(c.floating)),f=p||(_||!b?[zs(l)]:Tm(l)),S=y!=="none";!p&&S&&f.push(...Om(l,b,y,j));const N=[l,...f],O=await Yt(t,x),T=[];let I=((n=i.flip)==null?void 0:n.overflows)||[];if(g&&T.push(O[v]),u){const E=Rm(a,o,j);T.push(O[E[0]],O[E[1]])}if(I=[...I,{placement:a,overflows:T}],!T.every(E=>E<=0)){var P,C;const E=(((P=i.flip)==null?void 0:P.index)||0)+1,A=N[E];if(A)return{data:{index:E,overflows:I},reset:{placement:A}};let D=(C=I.filter($=>$.overflows[0]<=0).sort(($,U)=>$.overflows[1]-U.overflows[1])[0])==null?void 0:C.placement;if(!D)switch(d){case"bestFit":{var k;const $=(k=I.filter(U=>{if(S){const Y=tt(U.placement);return Y===w||Y==="y"}return!0}).map(U=>[U.placement,U.overflows.filter(Y=>Y>0).reduce((Y,re)=>Y+re,0)]).sort((U,Y)=>U[1]-Y[1])[0])==null?void 0:k[0];$&&(D=$);break}case"initialPlacement":D=l;break}if(a!==D)return{reset:{placement:D}}}return{}}}};function ka(s,t){return{top:s.top-t.height,right:s.right-t.width,bottom:s.bottom-t.height,left:s.left-t.width}}function Ca(s){return Am.some(t=>s[t]>=0)}const Bm=function(s){return s===void 0&&(s={}),{name:"hide",options:s,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=Je(s,t);switch(n){case"referenceHidden":{const i=await Yt(t,{...a,elementContext:"reference"}),o=ka(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Ca(o)}}}case"escaped":{const i=await Yt(t,{...a,altBoundary:!0}),o=ka(i,r.floating);return{data:{escapedOffsets:o,escaped:Ca(o)}}}default:return{}}}}};async function Um(s,t){const{placement:r,platform:n,elements:a}=s,i=await(n.isRTL==null?void 0:n.isRTL(a.floating)),o=Xe(r),l=Ot(r),m=tt(r)==="y",c=["left","top"].includes(o)?-1:1,g=i&&m?-1:1,u=Je(t,s);let{mainAxis:p,crossAxis:d,alignmentAxis:y}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return l&&typeof y=="number"&&(d=l==="end"?y*-1:y),m?{x:d*g,y:p*c}:{x:p*c,y:d*g}}const qm=function(s){return s===void 0&&(s=0),{name:"offset",options:s,async fn(t){var r,n;const{x:a,y:i,placement:o,middlewareData:l}=t,m=await Um(t,s);return o===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:a+m.x,y:i+m.y,data:{...m,placement:o}}}}},Wm=function(s){return s===void 0&&(s={}),{name:"shift",options:s,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:x=>{let{x:v,y:w}=x;return{x:v,y:w}}},...m}=Je(s,t),c={x:r,y:n},g=await Yt(t,m),u=tt(Xe(a)),p=Tn(u);let d=c[p],y=c[u];if(i){const x=p==="y"?"top":"left",v=p==="y"?"bottom":"right",w=d+g[x],_=d-g[v];d=Jr(w,d,_)}if(o){const x=u==="y"?"top":"left",v=u==="y"?"bottom":"right",w=y+g[x],_=y-g[v];y=Jr(w,y,_)}const b=l.fn({...t,[p]:d,[u]:y});return{...b,data:{x:b.x-r,y:b.y-n,enabled:{[p]:i,[u]:o}}}}}},Hm=function(s){return s===void 0&&(s={}),{options:s,fn(t){const{x:r,y:n,placement:a,rects:i,middlewareData:o}=t,{offset:l=0,mainAxis:m=!0,crossAxis:c=!0}=Je(s,t),g={x:r,y:n},u=tt(a),p=Tn(u);let d=g[p],y=g[u];const b=Je(l,t),x=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(m){const _=p==="y"?"height":"width",j=i.reference[p]-i.floating[_]+x.mainAxis,f=i.reference[p]+i.reference[_]-x.mainAxis;d<j?d=j:d>f&&(d=f)}if(c){var v,w;const _=p==="y"?"width":"height",j=["top","left"].includes(Xe(a)),f=i.reference[u]-i.floating[_]+(j&&((v=o.offset)==null?void 0:v[u])||0)+(j?0:x.crossAxis),S=i.reference[u]+i.reference[_]+(j?0:((w=o.offset)==null?void 0:w[u])||0)-(j?x.crossAxis:0);y<f?y=f:y>S&&(y=S)}return{[p]:d,[u]:y}}}},zm=function(s){return s===void 0&&(s={}),{name:"size",options:s,async fn(t){var r,n;const{placement:a,rects:i,platform:o,elements:l}=t,{apply:m=()=>{},...c}=Je(s,t),g=await Yt(t,c),u=Xe(a),p=Ot(a),d=tt(a)==="y",{width:y,height:b}=i.floating;let x,v;u==="top"||u==="bottom"?(x=u,v=p===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(v=u,x=p==="end"?"top":"bottom");const w=b-g.top-g.bottom,_=y-g.left-g.right,j=et(b-g[x],w),f=et(y-g[v],_),S=!t.middlewareData.shift;let N=j,O=f;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(O=_),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(N=w),S&&!p){const I=be(g.left,0),P=be(g.right,0),C=be(g.top,0),k=be(g.bottom,0);d?O=y-2*(I!==0||P!==0?I+P:be(g.left,g.right)):N=b-2*(C!==0||k!==0?C+k:be(g.top,g.bottom))}await m({...t,availableWidth:O,availableHeight:N});const T=await o.getDimensions(l.floating);return y!==T.width||b!==T.height?{reset:{rects:!0}}:{}}}};function ar(){return typeof window<"u"}function Ft(s){return yo(s)?(s.nodeName||"").toLowerCase():"#document"}function we(s){var t;return(s==null||(t=s.ownerDocument)==null?void 0:t.defaultView)||window}function qe(s){var t;return(t=(yo(s)?s.ownerDocument:s.document)||window.document)==null?void 0:t.documentElement}function yo(s){return ar()?s instanceof Node||s instanceof we(s).Node:!1}function Ae(s){return ar()?s instanceof Element||s instanceof we(s).Element:!1}function Be(s){return ar()?s instanceof HTMLElement||s instanceof we(s).HTMLElement:!1}function Sa(s){return!ar()||typeof ShadowRoot>"u"?!1:s instanceof ShadowRoot||s instanceof we(s).ShadowRoot}function is(s){const{overflow:t,overflowX:r,overflowY:n,display:a}=Pe(s);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(a)}function Gm(s){return["table","td","th"].includes(Ft(s))}function ir(s){return[":popover-open",":modal"].some(t=>{try{return s.matches(t)}catch{return!1}})}function Fn(s){const t=Mn(),r=Ae(s)?Pe(s):s;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function Vm(s){let t=st(s);for(;Be(t)&&!At(t);){if(Fn(t))return t;if(ir(t))return null;t=st(t)}return null}function Mn(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function At(s){return["html","body","#document"].includes(Ft(s))}function Pe(s){return we(s).getComputedStyle(s)}function or(s){return Ae(s)?{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}:{scrollLeft:s.scrollX,scrollTop:s.scrollY}}function st(s){if(Ft(s)==="html")return s;const t=s.assignedSlot||s.parentNode||Sa(s)&&s.host||qe(s);return Sa(t)?t.host:t}function bo(s){const t=st(s);return At(t)?s.ownerDocument?s.ownerDocument.body:s.body:Be(t)&&is(t)?t:bo(t)}function Kt(s,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=bo(s),i=a===((n=s.ownerDocument)==null?void 0:n.body),o=we(a);if(i){const l=Yr(o);return t.concat(o,o.visualViewport||[],is(a)?a:[],l&&r?Kt(l):[])}return t.concat(a,Kt(a,[],r))}function Yr(s){return s.parent&&Object.getPrototypeOf(s.parent)?s.frameElement:null}function wo(s){const t=Pe(s);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Be(s),i=a?s.offsetWidth:r,o=a?s.offsetHeight:n,l=Hs(r)!==i||Hs(n)!==o;return l&&(r=i,n=o),{width:r,height:n,$:l}}function $n(s){return Ae(s)?s:s.contextElement}function kt(s){const t=$n(s);if(!Be(t))return $e(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:i}=wo(t);let o=(i?Hs(r.width):r.width)/n,l=(i?Hs(r.height):r.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const Jm=$e(0);function jo(s){const t=we(s);return!Mn()||!t.visualViewport?Jm:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Xm(s,t,r){return t===void 0&&(t=!1),!r||t&&r!==we(s)?!1:t}function mt(s,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=s.getBoundingClientRect(),i=$n(s);let o=$e(1);t&&(n?Ae(n)&&(o=kt(n)):o=kt(s));const l=Xm(i,r,n)?jo(i):$e(0);let m=(a.left+l.x)/o.x,c=(a.top+l.y)/o.y,g=a.width/o.x,u=a.height/o.y;if(i){const p=we(i),d=n&&Ae(n)?we(n):n;let y=p,b=Yr(y);for(;b&&n&&d!==y;){const x=kt(b),v=b.getBoundingClientRect(),w=Pe(b),_=v.left+(b.clientLeft+parseFloat(w.paddingLeft))*x.x,j=v.top+(b.clientTop+parseFloat(w.paddingTop))*x.y;m*=x.x,c*=x.y,g*=x.x,u*=x.y,m+=_,c+=j,y=we(b),b=Yr(y)}}return Gs({width:g,height:u,x:m,y:c})}function Ln(s,t){const r=or(s).scrollLeft;return t?t.left+r:mt(qe(s)).left+r}function vo(s,t,r){r===void 0&&(r=!1);const n=s.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:Ln(s,n)),i=n.top+t.scrollTop;return{x:a,y:i}}function Ym(s){let{elements:t,rect:r,offsetParent:n,strategy:a}=s;const i=a==="fixed",o=qe(n),l=t?ir(t.floating):!1;if(n===o||l&&i)return r;let m={scrollLeft:0,scrollTop:0},c=$e(1);const g=$e(0),u=Be(n);if((u||!u&&!i)&&((Ft(n)!=="body"||is(o))&&(m=or(n)),Be(n))){const d=mt(n);c=kt(n),g.x=d.x+n.clientLeft,g.y=d.y+n.clientTop}const p=o&&!u&&!i?vo(o,m,!0):$e(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-m.scrollLeft*c.x+g.x+p.x,y:r.y*c.y-m.scrollTop*c.y+g.y+p.y}}function Km(s){return Array.from(s.getClientRects())}function Qm(s){const t=qe(s),r=or(s),n=s.ownerDocument.body,a=be(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=be(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+Ln(s);const l=-r.scrollTop;return Pe(n).direction==="rtl"&&(o+=be(t.clientWidth,n.clientWidth)-a),{width:a,height:i,x:o,y:l}}function Zm(s,t){const r=we(s),n=qe(s),a=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,l=0,m=0;if(a){i=a.width,o=a.height;const c=Mn();(!c||c&&t==="fixed")&&(l=a.offsetLeft,m=a.offsetTop)}return{width:i,height:o,x:l,y:m}}function eu(s,t){const r=mt(s,!0,t==="fixed"),n=r.top+s.clientTop,a=r.left+s.clientLeft,i=Be(s)?kt(s):$e(1),o=s.clientWidth*i.x,l=s.clientHeight*i.y,m=a*i.x,c=n*i.y;return{width:o,height:l,x:m,y:c}}function Ea(s,t,r){let n;if(t==="viewport")n=Zm(s,r);else if(t==="document")n=Qm(qe(s));else if(Ae(t))n=eu(t,r);else{const a=jo(s);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return Gs(n)}function No(s,t){const r=st(s);return r===t||!Ae(r)||At(r)?!1:Pe(r).position==="fixed"||No(r,t)}function tu(s,t){const r=t.get(s);if(r)return r;let n=Kt(s,[],!1).filter(l=>Ae(l)&&Ft(l)!=="body"),a=null;const i=Pe(s).position==="fixed";let o=i?st(s):s;for(;Ae(o)&&!At(o);){const l=Pe(o),m=Fn(o);!m&&l.position==="fixed"&&(a=null),(i?!m&&!a:!m&&l.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||is(o)&&!m&&No(s,o))?n=n.filter(g=>g!==o):a=l,o=st(o)}return t.set(s,n),n}function su(s){let{element:t,boundary:r,rootBoundary:n,strategy:a}=s;const o=[...r==="clippingAncestors"?ir(t)?[]:tu(t,this._c):[].concat(r),n],l=o[0],m=o.reduce((c,g)=>{const u=Ea(t,g,a);return c.top=be(u.top,c.top),c.right=et(u.right,c.right),c.bottom=et(u.bottom,c.bottom),c.left=be(u.left,c.left),c},Ea(t,l,a));return{width:m.right-m.left,height:m.bottom-m.top,x:m.left,y:m.top}}function ru(s){const{width:t,height:r}=wo(s);return{width:t,height:r}}function nu(s,t,r){const n=Be(t),a=qe(t),i=r==="fixed",o=mt(s,!0,i,t);let l={scrollLeft:0,scrollTop:0};const m=$e(0);if(n||!n&&!i)if((Ft(t)!=="body"||is(a))&&(l=or(t)),n){const p=mt(t,!0,i,t);m.x=p.x+t.clientLeft,m.y=p.y+t.clientTop}else a&&(m.x=Ln(a));const c=a&&!n&&!i?vo(a,l):$e(0),g=o.left+l.scrollLeft-m.x-c.x,u=o.top+l.scrollTop-m.y-c.y;return{x:g,y:u,width:o.width,height:o.height}}function Cr(s){return Pe(s).position==="static"}function Aa(s,t){if(!Be(s)||Pe(s).position==="fixed")return null;if(t)return t(s);let r=s.offsetParent;return qe(s)===r&&(r=r.ownerDocument.body),r}function _o(s,t){const r=we(s);if(ir(s))return r;if(!Be(s)){let a=st(s);for(;a&&!At(a);){if(Ae(a)&&!Cr(a))return a;a=st(a)}return r}let n=Aa(s,t);for(;n&&Gm(n)&&Cr(n);)n=Aa(n,t);return n&&At(n)&&Cr(n)&&!Fn(n)?r:n||Vm(s)||r}const au=async function(s){const t=this.getOffsetParent||_o,r=this.getDimensions,n=await r(s.floating);return{reference:nu(s.reference,await t(s.floating),s.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function iu(s){return Pe(s).direction==="rtl"}const ou={convertOffsetParentRelativeRectToViewportRelativeRect:Ym,getDocumentElement:qe,getClippingRect:su,getOffsetParent:_o,getElementRects:au,getClientRects:Km,getDimensions:ru,getScale:kt,isElement:Ae,isRTL:iu};function ko(s,t){return s.x===t.x&&s.y===t.y&&s.width===t.width&&s.height===t.height}function lu(s,t){let r=null,n;const a=qe(s);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,m){l===void 0&&(l=!1),m===void 0&&(m=1),i();const c=s.getBoundingClientRect(),{left:g,top:u,width:p,height:d}=c;if(l||t(),!p||!d)return;const y=js(u),b=js(a.clientWidth-(g+p)),x=js(a.clientHeight-(u+d)),v=js(g),_={rootMargin:-y+"px "+-b+"px "+-x+"px "+-v+"px",threshold:be(0,et(1,m))||1};let j=!0;function f(S){const N=S[0].intersectionRatio;if(N!==m){if(!j)return o();N?o(!1,N):n=setTimeout(()=>{o(!1,1e-7)},1e3)}N===1&&!ko(c,s.getBoundingClientRect())&&o(),j=!1}try{r=new IntersectionObserver(f,{..._,root:a.ownerDocument})}catch{r=new IntersectionObserver(f,_)}r.observe(s)}return o(!0),i}function cu(s,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:m=!1}=n,c=$n(s),g=a||i?[...c?Kt(c):[],...Kt(t)]:[];g.forEach(v=>{a&&v.addEventListener("scroll",r,{passive:!0}),i&&v.addEventListener("resize",r)});const u=c&&l?lu(c,r):null;let p=-1,d=null;o&&(d=new ResizeObserver(v=>{let[w]=v;w&&w.target===c&&d&&(d.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var _;(_=d)==null||_.observe(t)})),r()}),c&&!m&&d.observe(c),d.observe(t));let y,b=m?mt(s):null;m&&x();function x(){const v=mt(s);b&&!ko(b,v)&&r(),b=v,y=requestAnimationFrame(x)}return r(),()=>{var v;g.forEach(w=>{a&&w.removeEventListener("scroll",r),i&&w.removeEventListener("resize",r)}),u==null||u(),(v=d)==null||v.disconnect(),d=null,m&&cancelAnimationFrame(y)}}const du=qm,mu=Wm,uu=Lm,hu=zm,xu=Bm,Pa=$m,fu=Hm,gu=(s,t,r)=>{const n=new Map,a={platform:ou,...r},i={...a.platform,_c:n};return Mm(s,t,{...a,platform:i})};var Fs=typeof document<"u"?h.useLayoutEffect:h.useEffect;function Vs(s,t){if(s===t)return!0;if(typeof s!=typeof t)return!1;if(typeof s=="function"&&s.toString()===t.toString())return!0;let r,n,a;if(s&&t&&typeof s=="object"){if(Array.isArray(s)){if(r=s.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Vs(s[n],t[n]))return!1;return!0}if(a=Object.keys(s),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const i=a[n];if(!(i==="_owner"&&s.$$typeof)&&!Vs(s[i],t[i]))return!1}return!0}return s!==s&&t!==t}function Co(s){return typeof window>"u"?1:(s.ownerDocument.defaultView||window).devicePixelRatio||1}function Ia(s,t){const r=Co(s);return Math.round(t*r)/r}function Sr(s){const t=h.useRef(s);return Fs(()=>{t.current=s}),t}function pu(s){s===void 0&&(s={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:m,open:c}=s,[g,u]=h.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[p,d]=h.useState(n);Vs(p,n)||d(n);const[y,b]=h.useState(null),[x,v]=h.useState(null),w=h.useCallback(U=>{U!==S.current&&(S.current=U,b(U))},[]),_=h.useCallback(U=>{U!==N.current&&(N.current=U,v(U))},[]),j=i||y,f=o||x,S=h.useRef(null),N=h.useRef(null),O=h.useRef(g),T=m!=null,I=Sr(m),P=Sr(a),C=Sr(c),k=h.useCallback(()=>{if(!S.current||!N.current)return;const U={placement:t,strategy:r,middleware:p};P.current&&(U.platform=P.current),gu(S.current,N.current,U).then(Y=>{const re={...Y,isPositioned:C.current!==!1};E.current&&!Vs(O.current,re)&&(O.current=re,Zr.flushSync(()=>{u(re)}))})},[p,t,r,P,C]);Fs(()=>{c===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,u(U=>({...U,isPositioned:!1})))},[c]);const E=h.useRef(!1);Fs(()=>(E.current=!0,()=>{E.current=!1}),[]),Fs(()=>{if(j&&(S.current=j),f&&(N.current=f),j&&f){if(I.current)return I.current(j,f,k);k()}},[j,f,k,I,T]);const A=h.useMemo(()=>({reference:S,floating:N,setReference:w,setFloating:_}),[w,_]),D=h.useMemo(()=>({reference:j,floating:f}),[j,f]),$=h.useMemo(()=>{const U={position:r,left:0,top:0};if(!D.floating)return U;const Y=Ia(D.floating,g.x),re=Ia(D.floating,g.y);return l?{...U,transform:"translate("+Y+"px, "+re+"px)",...Co(D.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Y,top:re}},[r,l,D.floating,g.x,g.y]);return h.useMemo(()=>({...g,update:k,refs:A,elements:D,floatingStyles:$}),[g,k,A,D,$])}const yu=s=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:s,fn(r){const{element:n,padding:a}=typeof s=="function"?s(r):s;return n&&t(n)?n.current!=null?Pa({element:n.current,padding:a}).fn(r):{}:n?Pa({element:n,padding:a}).fn(r):{}}}},bu=(s,t)=>({...du(s),options:[s,t]}),wu=(s,t)=>({...mu(s),options:[s,t]}),ju=(s,t)=>({...fu(s),options:[s,t]}),vu=(s,t)=>({...uu(s),options:[s,t]}),Nu=(s,t)=>({...hu(s),options:[s,t]}),_u=(s,t)=>({...xu(s),options:[s,t]}),ku=(s,t)=>({...yu(s),options:[s,t]});var Cu="Arrow",So=h.forwardRef((s,t)=>{const{children:r,width:n=10,height:a=5,...i}=s;return e.jsx(at.svg,{...i,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:s.asChild?r:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});So.displayName=Cu;var Su=So;function Eu(s){const[t,r]=h.useState(void 0);return dt(()=>{if(s){r({width:s.offsetWidth,height:s.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,l;if("borderBoxSize"in i){const m=i.borderBoxSize,c=Array.isArray(m)?m[0]:m;o=c.inlineSize,l=c.blockSize}else o=s.offsetWidth,l=s.offsetHeight;r({width:o,height:l})});return n.observe(s,{box:"border-box"}),()=>n.unobserve(s)}else r(void 0)},[s]),t}var Bn="Popper",[Eo,Ao]=mo(Bn),[Au,Po]=Eo(Bn),Io=s=>{const{__scopePopper:t,children:r}=s,[n,a]=h.useState(null);return e.jsx(Au,{scope:t,anchor:n,onAnchorChange:a,children:r})};Io.displayName=Bn;var Ro="PopperAnchor",To=h.forwardRef((s,t)=>{const{__scopePopper:r,virtualRef:n,...a}=s,i=Po(Ro,r),o=h.useRef(null),l=ht(t,o);return h.useEffect(()=>{i.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:e.jsx(at.div,{...a,ref:l})});To.displayName=Ro;var Un="PopperContent",[Pu,Iu]=Eo(Un),Do=h.forwardRef((s,t)=>{var F,L,z,ee,it,ms;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:m=!0,collisionBoundary:c=[],collisionPadding:g=0,sticky:u="partial",hideWhenDetached:p=!1,updatePositionStrategy:d="optimized",onPlaced:y,...b}=s,x=Po(Un,r),[v,w]=h.useState(null),_=ht(t,Mt=>w(Mt)),[j,f]=h.useState(null),S=Eu(j),N=(S==null?void 0:S.width)??0,O=(S==null?void 0:S.height)??0,T=n+(i!=="center"?"-"+i:""),I=typeof g=="number"?g:{top:0,right:0,bottom:0,left:0,...g},P=Array.isArray(c)?c:[c],C=P.length>0,k={padding:I,boundary:P.filter(Tu),altBoundary:C},{refs:E,floatingStyles:A,placement:D,isPositioned:$,middlewareData:U}=pu({strategy:"fixed",placement:T,whileElementsMounted:(...Mt)=>cu(...Mt,{animationFrame:d==="always"}),elements:{reference:x.anchor},middleware:[bu({mainAxis:a+O,alignmentAxis:o}),m&&wu({mainAxis:!0,crossAxis:!1,limiter:u==="partial"?ju():void 0,...k}),m&&vu({...k}),Nu({...k,apply:({elements:Mt,rects:zn,availableWidth:Xo,availableHeight:Yo})=>{const{width:Ko,height:Qo}=zn.reference,us=Mt.floating.style;us.setProperty("--radix-popper-available-width",`${Xo}px`),us.setProperty("--radix-popper-available-height",`${Yo}px`),us.setProperty("--radix-popper-anchor-width",`${Ko}px`),us.setProperty("--radix-popper-anchor-height",`${Qo}px`)}}),j&&ku({element:j,padding:l}),Du({arrowWidth:N,arrowHeight:O}),p&&_u({strategy:"referenceHidden",...k})]}),[Y,re]=Mo(D),ve=Dt(y);dt(()=>{$&&(ve==null||ve())},[$,ve]);const ne=(F=U.arrow)==null?void 0:F.x,xt=(L=U.arrow)==null?void 0:L.y,ls=((z=U.arrow)==null?void 0:z.centerOffset)!==0,[cs,ds]=h.useState();return dt(()=>{v&&ds(window.getComputedStyle(v).zIndex)},[v]),e.jsx("div",{ref:E.setFloating,"data-radix-popper-content-wrapper":"",style:{...A,transform:$?A.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:cs,"--radix-popper-transform-origin":[(ee=U.transformOrigin)==null?void 0:ee.x,(it=U.transformOrigin)==null?void 0:it.y].join(" "),...((ms=U.hide)==null?void 0:ms.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:s.dir,children:e.jsx(Pu,{scope:r,placedSide:Y,onArrowChange:f,arrowX:ne,arrowY:xt,shouldHideArrow:ls,children:e.jsx(at.div,{"data-side":Y,"data-align":re,...b,ref:_,style:{...b.style,animation:$?void 0:"none"}})})})});Do.displayName=Un;var Oo="PopperArrow",Ru={top:"bottom",right:"left",bottom:"top",left:"right"},Fo=h.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,i=Iu(Oo,n),o=Ru[i.placedSide];return e.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:e.jsx(Su,{...a,ref:r,style:{...a.style,display:"block"}})})});Fo.displayName=Oo;function Tu(s){return s!==null}var Du=s=>({name:"transformOrigin",options:s,fn(t){var x,v,w;const{placement:r,rects:n,middlewareData:a}=t,o=((x=a.arrow)==null?void 0:x.centerOffset)!==0,l=o?0:s.arrowWidth,m=o?0:s.arrowHeight,[c,g]=Mo(r),u={start:"0%",center:"50%",end:"100%"}[g],p=(((v=a.arrow)==null?void 0:v.x)??0)+l/2,d=(((w=a.arrow)==null?void 0:w.y)??0)+m/2;let y="",b="";return c==="bottom"?(y=o?u:`${p}px`,b=`${-m}px`):c==="top"?(y=o?u:`${p}px`,b=`${n.floating.height+m}px`):c==="right"?(y=`${-m}px`,b=o?u:`${d}px`):c==="left"&&(y=`${n.floating.width+m}px`,b=o?u:`${d}px`),{data:{x:y,y:b}}}});function Mo(s){const[t,r="center"]=s.split("-");return[t,r]}var Ou=Io,Fu=To,Mu=Do,$u=Fo,Lu="Portal",$o=h.forwardRef((s,t)=>{var l;const{container:r,...n}=s,[a,i]=h.useState(!1);dt(()=>i(!0),[]);const o=r||a&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?tl.createPortal(e.jsx(at.div,{...n,ref:t}),o):null});$o.displayName=Lu;function Bu(s,t){return h.useReducer((r,n)=>t[r][n]??r,s)}var qn=s=>{const{present:t,children:r}=s,n=Uu(t),a=typeof r=="function"?r({present:n.isPresent}):h.Children.only(r),i=ht(n.ref,qu(a));return typeof r=="function"||n.isPresent?h.cloneElement(a,{ref:i}):null};qn.displayName="Presence";function Uu(s){const[t,r]=h.useState(),n=h.useRef({}),a=h.useRef(s),i=h.useRef("none"),o=s?"mounted":"unmounted",[l,m]=Bu(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return h.useEffect(()=>{const c=vs(n.current);i.current=l==="mounted"?c:"none"},[l]),dt(()=>{const c=n.current,g=a.current;if(g!==s){const p=i.current,d=vs(c);s?m("MOUNT"):d==="none"||(c==null?void 0:c.display)==="none"?m("UNMOUNT"):m(g&&p!==d?"ANIMATION_OUT":"UNMOUNT"),a.current=s}},[s,m]),dt(()=>{if(t){let c;const g=t.ownerDocument.defaultView??window,u=d=>{const b=vs(n.current).includes(d.animationName);if(d.target===t&&b&&(m("ANIMATION_END"),!a.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",c=g.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},p=d=>{d.target===t&&(i.current=vs(n.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",u),t.addEventListener("animationend",u),()=>{g.clearTimeout(c),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",u),t.removeEventListener("animationend",u)}}else m("ANIMATION_END")},[t,m]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:h.useCallback(c=>{c&&(n.current=getComputedStyle(c)),r(c)},[])}}function vs(s){return(s==null?void 0:s.animationName)||"none"}function qu(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}function Wu({prop:s,defaultProp:t,onChange:r=()=>{}}){const[n,a]=Hu({defaultProp:t,onChange:r}),i=s!==void 0,o=i?s:n,l=Dt(r),m=h.useCallback(c=>{if(i){const u=typeof c=="function"?c(s):c;u!==s&&l(u)}else a(c)},[i,s,a,l]);return[o,m]}function Hu({defaultProp:s,onChange:t}){const r=h.useState(s),[n]=r,a=h.useRef(n),i=Dt(t);return h.useEffect(()=>{a.current!==n&&(i(n),a.current=n)},[n,a,i]),r}var zu="VisuallyHidden",Lo=h.forwardRef((s,t)=>e.jsx(at.span,{...s,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...s.style}}));Lo.displayName=zu;var Gu=Lo,[lr,_h]=mo("Tooltip",[Ao]),cr=Ao(),Bo="TooltipProvider",Vu=700,Kr="tooltip.open",[Ju,Wn]=lr(Bo),Uo=s=>{const{__scopeTooltip:t,delayDuration:r=Vu,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:i}=s,[o,l]=h.useState(!0),m=h.useRef(!1),c=h.useRef(0);return h.useEffect(()=>{const g=c.current;return()=>window.clearTimeout(g)},[]),e.jsx(Ju,{scope:t,isOpenDelayed:o,delayDuration:r,onOpen:h.useCallback(()=>{window.clearTimeout(c.current),l(!1)},[]),onClose:h.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>l(!0),n)},[n]),isPointerInTransitRef:m,onPointerInTransitChange:h.useCallback(g=>{m.current=g},[]),disableHoverableContent:a,children:i})};Uo.displayName=Bo;var dr="Tooltip",[Xu,os]=lr(dr),qo=s=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:a=!1,onOpenChange:i,disableHoverableContent:o,delayDuration:l}=s,m=Wn(dr,s.__scopeTooltip),c=cr(t),[g,u]=h.useState(null),p=Em(),d=h.useRef(0),y=o??m.disableHoverableContent,b=l??m.delayDuration,x=h.useRef(!1),[v=!1,w]=Wu({prop:n,defaultProp:a,onChange:N=>{N?(m.onOpen(),document.dispatchEvent(new CustomEvent(Kr))):m.onClose(),i==null||i(N)}}),_=h.useMemo(()=>v?x.current?"delayed-open":"instant-open":"closed",[v]),j=h.useCallback(()=>{window.clearTimeout(d.current),d.current=0,x.current=!1,w(!0)},[w]),f=h.useCallback(()=>{window.clearTimeout(d.current),d.current=0,w(!1)},[w]),S=h.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>{x.current=!0,w(!0),d.current=0},b)},[b,w]);return h.useEffect(()=>()=>{d.current&&(window.clearTimeout(d.current),d.current=0)},[]),e.jsx(Ou,{...c,children:e.jsx(Xu,{scope:t,contentId:p,open:v,stateAttribute:_,trigger:g,onTriggerChange:u,onTriggerEnter:h.useCallback(()=>{m.isOpenDelayed?S():j()},[m.isOpenDelayed,S,j]),onTriggerLeave:h.useCallback(()=>{y?f():(window.clearTimeout(d.current),d.current=0)},[f,y]),onOpen:j,onClose:f,disableHoverableContent:y,children:r})})};qo.displayName=dr;var Qr="TooltipTrigger",Wo=h.forwardRef((s,t)=>{const{__scopeTooltip:r,...n}=s,a=os(Qr,r),i=Wn(Qr,r),o=cr(r),l=h.useRef(null),m=ht(t,l,a.onTriggerChange),c=h.useRef(!1),g=h.useRef(!1),u=h.useCallback(()=>c.current=!1,[]);return h.useEffect(()=>()=>document.removeEventListener("pointerup",u),[u]),e.jsx(Fu,{asChild:!0,...o,children:e.jsx(at.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:m,onPointerMove:ze(s.onPointerMove,p=>{p.pointerType!=="touch"&&!g.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),g.current=!0)}),onPointerLeave:ze(s.onPointerLeave,()=>{a.onTriggerLeave(),g.current=!1}),onPointerDown:ze(s.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",u,{once:!0})}),onFocus:ze(s.onFocus,()=>{c.current||a.onOpen()}),onBlur:ze(s.onBlur,a.onClose),onClick:ze(s.onClick,a.onClose)})})});Wo.displayName=Qr;var Hn="TooltipPortal",[Yu,Ku]=lr(Hn,{forceMount:void 0}),Ho=s=>{const{__scopeTooltip:t,forceMount:r,children:n,container:a}=s,i=os(Hn,t);return e.jsx(Yu,{scope:t,forceMount:r,children:e.jsx(qn,{present:r||i.open,children:e.jsx($o,{asChild:!0,container:a,children:n})})})};Ho.displayName=Hn;var Pt="TooltipContent",zo=h.forwardRef((s,t)=>{const r=Ku(Pt,s.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...i}=s,o=os(Pt,s.__scopeTooltip);return e.jsx(qn,{present:n||o.open,children:o.disableHoverableContent?e.jsx(Go,{side:a,...i,ref:t}):e.jsx(Qu,{side:a,...i,ref:t})})}),Qu=h.forwardRef((s,t)=>{const r=os(Pt,s.__scopeTooltip),n=Wn(Pt,s.__scopeTooltip),a=h.useRef(null),i=ht(t,a),[o,l]=h.useState(null),{trigger:m,onClose:c}=r,g=a.current,{onPointerInTransitChange:u}=n,p=h.useCallback(()=>{l(null),u(!1)},[u]),d=h.useCallback((y,b)=>{const x=y.currentTarget,v={x:y.clientX,y:y.clientY},w=th(v,x.getBoundingClientRect()),_=sh(v,w),j=rh(b.getBoundingClientRect()),f=ah([..._,...j]);l(f),u(!0)},[u]);return h.useEffect(()=>()=>p(),[p]),h.useEffect(()=>{if(m&&g){const y=x=>d(x,g),b=x=>d(x,m);return m.addEventListener("pointerleave",y),g.addEventListener("pointerleave",b),()=>{m.removeEventListener("pointerleave",y),g.removeEventListener("pointerleave",b)}}},[m,g,d,p]),h.useEffect(()=>{if(o){const y=b=>{const x=b.target,v={x:b.clientX,y:b.clientY},w=(m==null?void 0:m.contains(x))||(g==null?void 0:g.contains(x)),_=!nh(v,o);w?p():_&&(p(),c())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[m,g,o,c,p]),e.jsx(Go,{...s,ref:i})}),[Zu,eh]=lr(dr,{isInside:!1}),Go=h.forwardRef((s,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...l}=s,m=os(Pt,r),c=cr(r),{onClose:g}=m;return h.useEffect(()=>(document.addEventListener(Kr,g),()=>document.removeEventListener(Kr,g)),[g]),h.useEffect(()=>{if(m.trigger){const u=p=>{const d=p.target;d!=null&&d.contains(m.trigger)&&g()};return window.addEventListener("scroll",u,{capture:!0}),()=>window.removeEventListener("scroll",u,{capture:!0})}},[m.trigger,g]),e.jsx(fo,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:u=>u.preventDefault(),onDismiss:g,children:e.jsxs(Mu,{"data-state":m.stateAttribute,...c,...l,ref:t,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(ho,{children:n}),e.jsx(Zu,{scope:r,isInside:!0,children:e.jsx(Gu,{id:m.contentId,role:"tooltip",children:a||n})})]})})});zo.displayName=Pt;var Vo="TooltipArrow",Jo=h.forwardRef((s,t)=>{const{__scopeTooltip:r,...n}=s,a=cr(r);return eh(Vo,r).isInside?null:e.jsx($u,{...a,...n,ref:t})});Jo.displayName=Vo;function th(s,t){const r=Math.abs(t.top-s.y),n=Math.abs(t.bottom-s.y),a=Math.abs(t.right-s.x),i=Math.abs(t.left-s.x);switch(Math.min(r,n,a,i)){case i:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function sh(s,t,r=5){const n=[];switch(t){case"top":n.push({x:s.x-r,y:s.y+r},{x:s.x+r,y:s.y+r});break;case"bottom":n.push({x:s.x-r,y:s.y-r},{x:s.x+r,y:s.y-r});break;case"left":n.push({x:s.x+r,y:s.y-r},{x:s.x+r,y:s.y+r});break;case"right":n.push({x:s.x-r,y:s.y-r},{x:s.x-r,y:s.y+r});break}return n}function rh(s){const{top:t,right:r,bottom:n,left:a}=s;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function nh(s,t){const{x:r,y:n}=s;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i].x,m=t[i].y,c=t[o].x,g=t[o].y;m>n!=g>n&&r<(c-l)*(n-m)/(g-m)+l&&(a=!a)}return a}function ah(s){const t=s.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),ih(t)}function ih(s){if(s.length<=1)return s.slice();const t=[];for(let n=0;n<s.length;n++){const a=s[n];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=s.length-1;n>=0;n--){const a=s[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var Ns=Uo,_s=qo,ks=Wo,Cs=Ho,Ss=zo,Es=Jo;function oh(){const s=Ue(),t=en(),{user:r,profile:n,isAdmin:a,signOut:i}=X(),[o,l]=h.useState(!1),[m,c]=h.useState(!1),[g,u]=h.useState(!1);h.useEffect(()=>{(async()=>{if(r){const{data:v}=await R.from("companies").select("id").eq("owner_id",r.id).maybeSingle();u(!!v)}})()},[r]);const p=async()=>{await i(),s("/login")},d=[{name:"Dashboard",href:"/dashboard",icon:La,isEnabled:!0},{name:"My Company",href:g?"/company/dashboard":"/company/setup",icon:ut,badge:g?void 0:"Setup",isEnabled:!0},{name:"Messages",href:"/messages",icon:Ee,isEnabled:!0},{name:"Community",href:"/community",icon:xe,isEnabled:!0},{name:"Directory",href:"/directory",icon:$a,isEnabled:!0},{name:"Library",href:"#",icon:he,isEnabled:!1},{name:"Marketplace",href:"#",icon:$l,isEnabled:!1},{name:"Legal Hub",href:"#",icon:Ll,isEnabled:!1},{name:"Dev Hub",href:"#",icon:Bl,isEnabled:!1},{name:"Utilities",href:"#",icon:Ul,isEnabled:!1},{name:"Idea Hub",href:"/idea-hub",icon:Ze,isEnabled:!0},{name:"Finance Hub",href:"#",icon:ql,isEnabled:!1},{name:"Settings",href:"/profile",icon:Zt,isEnabled:!0,children:[...a?[{name:"Admin Panel",href:"/admin",icon:Kn,isEnabled:!0}]:[]]}],y=x=>x.isEnabled?e.jsxs(G,{to:x.href,className:`${t.pathname===x.href?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} group flex items-center px-2 py-2 text-sm font-medium rounded-md`,children:[e.jsx(x.icon,{className:`${t.pathname===x.href?"text-indigo-600":"text-gray-400 group-hover:text-gray-500"} mr-3 h-5 w-5`}),x.name,x.badge&&e.jsx("span",{className:"ml-auto inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:x.badge})]}):e.jsx(Ns,{children:e.jsxs(_s,{children:[e.jsx(ks,{asChild:!0,children:e.jsxs("div",{className:"flex items-center px-2 py-2 text-sm font-medium text-gray-400 cursor-not-allowed rounded-md group",children:[e.jsx(x.icon,{className:"h-5 w-5 mr-3"}),x.name,e.jsx(hs,{className:"h-4 w-4 ml-2 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),e.jsx(Cs,{children:e.jsxs(Ss,{className:"bg-gray-900 text-white px-3 py-1.5 rounded text-sm",sideOffset:5,children:["Coming Soon",e.jsx(Es,{className:"fill-gray-900"})]})})]})}),b=x=>x.isEnabled?e.jsxs(G,{to:x.href,className:`${t.pathname===x.href?"bg-indigo-50 border-indigo-500 text-indigo-700":"border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700"} block pl-3 pr-4 py-2 border-l-4 text-base font-medium flex items-center`,onClick:()=>l(!1),children:[e.jsx(x.icon,{className:"h-5 w-5 mr-2"}),x.name,x.badge&&e.jsx("span",{className:"ml-auto inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:x.badge})]}):e.jsx(Ns,{children:e.jsxs(_s,{children:[e.jsx(ks,{asChild:!0,children:e.jsxs("div",{className:"block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-gray-400 flex items-center cursor-not-allowed group",children:[e.jsx(x.icon,{className:"h-5 w-5 mr-2"}),x.name,e.jsx(hs,{className:"h-4 w-4 ml-2 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),e.jsx(Cs,{children:e.jsxs(Ss,{className:"bg-gray-900 text-white px-3 py-1.5 rounded text-sm",sideOffset:5,children:["Coming Soon",e.jsx(Es,{className:"fill-gray-900"})]})})]})});return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsxs("div",{className:"bg-white shadow-sm",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0 flex items-center",children:e.jsx(Kn,{className:"h-8 w-8 text-indigo-600"})}),e.jsx("div",{className:"hidden lg:ml-6 lg:flex lg:items-center",children:e.jsxs("div",{className:"max-w-lg w-full lg:max-w-xs",children:[e.jsx("label",{htmlFor:"search",className:"sr-only",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(rt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"search",name:"search",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Search resources...",type:"search"})]})]})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{className:"p-1 rounded-full text-gray-400 hover:text-gray-500",children:e.jsx(Ol,{className:"h-6 w-6"})}),e.jsxs("div",{className:"ml-4 relative",children:[e.jsx("div",{children:e.jsxs("button",{onClick:()=>c(!m),className:"flex items-center max-w-xs bg-white rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx("span",{className:"sr-only",children:"Open user menu"}),e.jsxs("div",{className:"flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg",children:[n!=null&&n.avatar_url?e.jsx("img",{className:"h-8 w-8 rounded-full",src:n.avatar_url,alt:""}):e.jsx(Ar,{className:"h-8 w-8 text-gray-400"}),e.jsxs("div",{className:"hidden md:block text-left",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:(n==null?void 0:n.full_name)||"Complete Profile"}),e.jsx("div",{className:"text-xs text-gray-500 capitalize",children:(n==null?void 0:n.role)||"New User"})]}),e.jsx(ce,{className:"h-4 w-4 text-gray-400"})]})]})}),m&&e.jsxs("div",{className:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 py-1",children:[n!=null&&n.full_name?e.jsxs(G,{to:"/profile",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>c(!1),children:[e.jsx(Ls,{className:"h-4 w-4 mr-3"}),"Your Profile"]}):e.jsxs(G,{to:"/profile-setup",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>c(!1),children:[e.jsx(Ls,{className:"h-4 w-4 mr-3"}),"Complete Profile"]}),e.jsxs("button",{onClick:()=>{c(!1),p()},className:"flex w-full items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[e.jsx(Fl,{className:"h-4 w-4 mr-3"}),"Sign Out"]})]})]}),e.jsx("div",{className:"ml-4 flex items-center lg:hidden",children:e.jsx("button",{onClick:()=>l(!o),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100",children:o?e.jsx(de,{className:"h-6 w-6"}):e.jsx(Ml,{className:"h-6 w-6"})})})]})]})}),o&&e.jsx("div",{className:"lg:hidden",children:e.jsx("div",{className:"pt-2 pb-3 space-y-1",children:d.map(x=>{var v;return e.jsxs(Qe.Fragment,{children:[b(x),(v=x.children)==null?void 0:v.map(w=>e.jsx(Qe.Fragment,{children:w.isEnabled?e.jsxs(G,{to:w.href,className:`${t.pathname===w.href?"bg-indigo-50 border-indigo-500 text-indigo-700":"border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700"} block pl-8 pr-4 py-2 border-l-4 text-sm font-medium flex items-center`,onClick:()=>l(!1),children:[e.jsx(w.icon,{className:"h-4 w-4 mr-2"}),w.name]}):e.jsx(Ns,{children:e.jsxs(_s,{children:[e.jsx(ks,{asChild:!0,children:e.jsxs("div",{className:"block pl-8 pr-4 py-2 border-l-4 border-transparent text-sm font-medium text-gray-400 flex items-center cursor-not-allowed group",children:[e.jsx(w.icon,{className:"h-4 w-4 mr-2"}),w.name,e.jsx(hs,{className:"h-4 w-4 ml-2 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),e.jsx(Cs,{children:e.jsxs(Ss,{className:"bg-gray-900 text-white px-3 py-1.5 rounded text-sm",sideOffset:5,children:["Coming Soon",e.jsx(Es,{className:"fill-gray-900"})]})})]})})},w.name))]},x.name)})})})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"hidden lg:flex lg:flex-shrink-0",children:e.jsx("div",{className:"flex flex-col w-64 border-r border-gray-200 bg-white",children:e.jsx("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto",children:e.jsx("nav",{className:"flex-1 px-2 space-y-1",children:d.map(x=>{var v;return e.jsxs(Qe.Fragment,{children:[y(x),(v=x.children)==null?void 0:v.map(w=>e.jsx(Qe.Fragment,{children:w.isEnabled?e.jsxs(G,{to:w.href,className:`${t.pathname===w.href?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} group flex items-center px-8 py-2 text-sm font-medium rounded-md`,children:[e.jsx(w.icon,{className:`${t.pathname===w.href?"text-indigo-600":"text-gray-400 group-hover:text-gray-500"} mr-3 h-4 w-4`}),w.name]}):e.jsx(Ns,{children:e.jsxs(_s,{children:[e.jsx(ks,{asChild:!0,children:e.jsxs("div",{className:"flex items-center px-8 py-2 text-sm font-medium text-gray-400 cursor-not-allowed rounded-md group",children:[e.jsx(w.icon,{className:"h-4 w-4 mr-3"}),w.name,e.jsx(hs,{className:"h-4 w-4 ml-2 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),e.jsx(Cs,{children:e.jsxs(Ss,{className:"bg-gray-900 text-white px-3 py-1.5 rounded text-sm",sideOffset:5,children:["Coming Soon",e.jsx(Es,{className:"fill-gray-900"})]})})]})})},w.name))]},x.name)})})})})}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx(sl,{})})})})]})]})}const lh=({task:s,onUpdateTask:t,onRemoveTask:r,onAddTask:n,isExpanded:a,onToggleExpand:i,expandedSections:o,onToggleSection:l,suggestedTask:m=!1})=>{var f,S,N,O,T,I,P,C,k,E;const[c,g]=h.useState(!1),[u,p]=h.useState(!1),[d,y]=h.useState(s),b=async()=>{p(!0);try{const{tasks:A}=await as({accomplished:"",working_on:d.description,blockers:"",goals:d.title},"");if(A&&A.length>0){const D=A[0];y($=>({...$,implementation_tips:[...$.implementation_tips||[],...D.implementation_tips||[]],potential_challenges:[...$.potential_challenges||[],...D.potential_challenges||[]],success_metrics:[...$.success_metrics||[],...D.success_metrics||[]],resources:[...$.resources||[],...D.resources||[]],learning_resources:[...$.learning_resources||[],...D.learning_resources||[]],tools:[...$.tools||[],...D.tools||[]]}))}}catch(A){console.error("Error generating AI suggestions:",A)}finally{p(!1)}},x=()=>{m&&n?n(d):t&&t(s.id,d),g(!1)},v=A=>{switch(A){case"completed":return e.jsx(Ct,{className:"h-5 w-5 text-green-500"});case"in_progress":return e.jsx(Le,{className:"h-5 w-5 text-yellow-500"});default:return e.jsx(fe,{className:"h-5 w-5 text-gray-400"})}},w=A=>{switch(A){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},_=A=>{switch(A){case"article":return e.jsx(he,{className:"h-4 w-4"});case"video":return e.jsx(Js,{className:"h-4 w-4"});case"tool":return e.jsx(Fe,{className:"h-4 w-4"});case"template":return e.jsx(he,{className:"h-4 w-4"});case"guide":return e.jsx(Oe,{className:"h-4 w-4"});default:return e.jsx(Q,{className:"h-4 w-4"})}},j=(A,D)=>{y($=>{var U,Y,re;switch(D){case"resource":return{...$,resources:(U=$.resources)==null?void 0:U.filter((ve,ne)=>ne!==A)};case"learning":return{...$,learning_resources:(Y=$.learning_resources)==null?void 0:Y.filter((ve,ne)=>ne!==A)};case"tool":return{...$,tools:(re=$.tools)==null?void 0:re.filter((ve,ne)=>ne!==A)};default:return $}})};return c?e.jsx("div",{className:"bg-white shadow rounded-lg p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx("input",{type:"text",value:d.title,onChange:A=>y({...d,title:A.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{value:d.description,onChange:A=>y({...d,description:A.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Priority"}),e.jsxs("select",{value:d.priority,onChange:A=>y({...d,priority:A.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Due Date"}),e.jsx("input",{type:"date",value:d.due_date,onChange:A=>y({...d,due_date:A.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"AI Suggestions"}),e.jsx("button",{onClick:b,disabled:u,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:u?e.jsxs(e.Fragment,{children:[e.jsx(Vt,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Generate Suggestions"]})})]}),((f=d.implementation_tips)==null?void 0:f.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Implementation Tips"}),e.jsx("ul",{className:"space-y-1",children:d.implementation_tips.map((A,D)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("span",{className:"mr-2",children:"•"}),A]},D))})]}),((S=d.potential_challenges)==null?void 0:S.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Potential Challenges"}),e.jsx("ul",{className:"space-y-1",children:d.potential_challenges.map((A,D)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("span",{className:"mr-2",children:"•"}),A]},D))})]}),((N=d.success_metrics)==null?void 0:N.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Success Metrics"}),e.jsx("ul",{className:"space-y-1",children:d.success_metrics.map((A,D)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("span",{className:"mr-2",children:"•"}),A]},D))})]}),((O=d.resources)==null?void 0:O.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Resources"}),e.jsx("div",{className:"space-y-2",children:d.resources.map((A,D)=>e.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded border border-gray-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[_(A.type),e.jsx("span",{className:"ml-2",children:A.title}),e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:A.description})]}),e.jsx("button",{onClick:()=>j(D,"resource"),className:"ml-2 p-1 text-gray-400 hover:text-gray-500",children:e.jsx(wt,{className:"h-4 w-4"})})]},D))})]}),((T=d.learning_resources)==null?void 0:T.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Learning Resources"}),e.jsx("div",{className:"space-y-2",children:d.learning_resources.map((A,D)=>e.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded border border-gray-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),A.title,e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsxs("p",{className:"text-xs text-gray-500 ml-6",children:[A.platform," • ",A.description]})]}),e.jsx("button",{onClick:()=>j(D,"learning"),className:"ml-2 p-1 text-gray-400 hover:text-gray-500",children:e.jsx(wt,{className:"h-4 w-4"})})]},D))})]}),((I=d.tools)==null?void 0:I.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recommended Tools"}),e.jsx("div",{className:"space-y-2",children:d.tools.map((A,D)=>e.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded border border-gray-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),A.name,e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",A.category,")"]}),e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:A.description})]}),e.jsx("button",{onClick:()=>j(D,"tool"),className:"ml-2 p-1 text-gray-400 hover:text-gray-500",children:e.jsx(wt,{className:"h-4 w-4"})})]},D))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs("button",{onClick:()=>{y(s),g(!1)},className:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsx("button",{onClick:x,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:m?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Task"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})]})}):e.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:i,className:"flex items-center text-left flex-1",children:[a?e.jsx(ce,{className:"h-5 w-5 text-gray-400"}):e.jsx(Z,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{className:"ml-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.title}),!a&&e.jsxs("div",{className:"mt-1 flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{children:["Type: ",s.task_type]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Due: ",new Date(s.due_date).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w(s.priority)}`,children:s.priority}),m&&n&&e.jsxs("button",{onClick:()=>n(s),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(B,{className:"h-3 w-3 mr-1"}),"Add"]}),e.jsx("button",{onClick:()=>g(!0),className:"p-1 text-gray-400 hover:text-gray-500",children:e.jsx(Ma,{className:"h-4 w-4"})}),!m&&r&&e.jsx("button",{onClick:()=>r(s),className:"p-1 text-gray-400 hover:text-gray-500",children:e.jsx(de,{className:"h-4 w-4"})}),!m&&v(s.status)]})]}),a&&e.jsxs("div",{className:"mt-4 ml-7 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-900",children:s.description}),e.jsxs("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{children:["Type: ",s.task_type]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Category: ",s.category]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Estimated: ",s.estimated_hours,"h"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Due: ",new Date(s.due_date).toLocaleDateString()]})]})]}),((P=s.implementation_tips)==null?void 0:P.length)>0&&e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>l("tips"),className:"flex items-center text-sm font-medium text-gray-900",children:[e.jsx(Ze,{className:"h-4 w-4 mr-2"}),"Implementation Tips",o.tips?e.jsx(ce,{className:"h-4 w-4 ml-2"}):e.jsx(Z,{className:"h-4 w-4 ml-2"})]}),o.tips&&e.jsx("ul",{className:"mt-2 space-y-1 ml-6",children:s.implementation_tips.map((A,D)=>e.jsxs("li",{className:"text-sm text-gray-600",children:["• ",A]},D))})]}),((C=s.resources)==null?void 0:C.length)>0&&e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>l("resources"),className:"flex items-center text-sm font-medium text-gray-900",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Helpful Resources",o.resources?e.jsx(ce,{className:"h-4 w-4 ml-2"}):e.jsx(Z,{className:"h-4 w-4 ml-2"})]}),o.resources&&e.jsx("div",{className:"mt-2 space-y-2 ml-6",children:s.resources.map((A,D)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[_(A.type),e.jsx("span",{className:"ml-2",children:A.title}),e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:A.description})]},D))})]}),((k=s.learning_resources)==null?void 0:k.length)>0&&e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>l("learning"),className:"flex items-center text-sm font-medium text-gray-900",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Learning Resources",o.learning?e.jsx(ce,{className:"h-4 w-4 ml-2"}):e.jsx(Z,{className:"h-4 w-4 ml-2"})]}),o.learning&&e.jsx("div",{className:"mt-2 space-y-3 ml-6",children:s.learning_resources.map((A,D)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[_(A.type),e.jsx("span",{className:"ml-2",children:A.title}),e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsxs("p",{className:"text-xs text-gray-500 ml-6",children:[A.platform," • ",A.description]})]},D))})]}),((E=s.tools)==null?void 0:E.length)>0&&e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>l("tools"),className:"flex items-center text-sm font-medium text-gray-900",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Recommended Tools",o.tools?e.jsx(ce,{className:"h-4 w-4 ml-2"}):e.jsx(Z,{className:"h-4 w-4 ml-2"})]}),o.tools&&e.jsx("div",{className:"mt-2 space-y-3 ml-6",children:s.tools.map((A,D)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-indigo-600 hover:text-indigo-900",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),A.name,e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",A.category,")"]}),e.jsx(Q,{className:"h-3 w-3 ml-1"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:A.description})]},D))})]}),!m&&t&&e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("select",{value:s.status,onChange:A=>t(s.id,{status:A.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"})]})})]})]})})})},Ra=({tasks:s,onUpdateTask:t,onAddTask:r,onRemoveTask:n,suggestedTasks:a=!1})=>{const[i,o]=h.useState({}),[l,m]=h.useState({}),c=u=>{o(p=>({...p,[u]:!p[u]}))},g=(u,p)=>{m(d=>{var y;return{...d,[u]:{...d[u]||{},[p]:!((y=d[u])!=null&&y[p])}}})};return e.jsx("div",{className:"space-y-4",children:s.map(u=>e.jsx(lh,{task:u,onUpdateTask:t,onRemoveTask:n,onAddTask:r,isExpanded:i[u.id]||!1,onToggleExpand:()=>c(u.id),expandedSections:l[u.id]||{},onToggleSection:p=>g(u.id,p),suggestedTask:a},u.id))})};function Ta(){const s=Ue(),t=en(),{user:r}=X(),[n,a]=h.useState([]),[i,o]=h.useState([]),[l,m]=h.useState(!1),[c,g]=h.useState(!1),[u,p]=h.useState("");h.useEffect(()=>{var _;(_=t.state)!=null&&_.standupEntry?y():s("/dashboard")},[]);const d=()=>{const _=new Date;for(_.setDate(_.getDate()+1);_.getDay()===0||_.getDay()===6;)_.setDate(_.getDate()+1);return _.toISOString().split("T")[0]},y=async()=>{var _;if(!(!r||!((_=t.state)!=null&&_.standupEntry))){m(!0),p("");try{const{tasks:j}=await as(t.state.standupEntry,r.id),f=j.map(S=>({...S,due_date:d(),implementation_tips:S.implementation_tips||[],potential_challenges:S.potential_challenges||[],success_metrics:S.success_metrics||[],resources:S.resources||[],learning_resources:S.learning_resources||[],tools:S.tools||[]}));a(f)}catch(j){console.error("Error generating tasks:",j),p(j.message)}finally{m(!1)}}},b=_=>{o([...i,_]),a(n.filter(j=>j.id!==_.id))},x=_=>{o(i.filter(j=>j.id!==_.id)),a([...n,_])},v=async(_,j)=>{const S=(i.find(N=>N.id===_)?i:n).map(N=>N.id===_?{...N,...j}:N);i.find(N=>N.id===_)?o(S):a(S)},w=async()=>{if(!(!r||i.length===0)){g(!0),p("");try{const{data:_}=await R.from("standup_entries").select("id").eq("user_id",r.id).order("created_at",{ascending:!1}).limit(1).single();if(!_)throw new Error("No standup entry found. Please create a daily update first.");const{error:j}=await R.from("standup_tasks").insert(i.map(f=>({standup_entry_id:_.id,...f,assigned_to:r.id})));if(j)throw j;s("/dashboard")}catch(_){console.error("Error saving tasks:",_),p(_.message)}finally{g(!1)}}};return e.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Create Tasks"}),e.jsx("button",{onClick:w,disabled:c||i.length===0,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:c?e.jsxs(e.Fragment,{children:[e.jsx(Vt,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Save Tasks"]})})]}),u&&e.jsx("div",{className:"mb-8 rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"text-sm text-red-700",children:u})}),e.jsxs("div",{className:"space-y-6",children:[i.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Selected Tasks"}),e.jsx(Ra,{tasks:i,onRemoveTask:x,onUpdateTask:v})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"AI-Generated Task Suggestions"}),e.jsx("button",{onClick:y,disabled:l,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:l?e.jsxs(e.Fragment,{children:[e.jsx(Vt,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Regenerate"]})})]}),l?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Generating task suggestions..."})]}):n.length>0?e.jsx(Ra,{tasks:n,onAddTask:b,onUpdateTask:v,suggestedTasks:!0}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg border-2 border-dashed border-gray-300",children:[e.jsx(Ve,{className:"h-8 w-8 text-gray-400 mx-auto"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No task suggestions"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Click the regenerate button to get new task suggestions"})]})]})]})]})}function ch(){const s=en();return h.useEffect(()=>{const t=new URLSearchParams(s.search),r=t.get("code"),n=t.get("error");window.opener&&!window.opener.closed&&window.opener.postMessage({type:"oauth_callback",provider:"google",code:r,error:n},window.location.origin),setTimeout(()=>window.close(),1e3)},[s]),e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsx("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-sm text-gray-500",children:"Completing authentication..."}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"This window will close automatically."})]})})})})}function Da({children:s,adminOnly:t=!1,superAdminOnly:r=!1}){const{user:n,isAdmin:a,isSuperAdmin:i}=X();return n?t&&!a?e.jsx(As,{to:"/dashboard"}):r&&!i?e.jsx(As,{to:"/dashboard"}):s:e.jsx(As,{to:"/login"})}function dh(){const{setUser:s,fetchProfile:t}=X();return Qe.useEffect(()=>{R.auth.getSession().then(({data:{session:n}})=>{n!=null&&n.user&&(s(n.user),t(n.user.id))});const{data:{subscription:r}}=R.auth.onAuthStateChange(async(n,a)=>{a!=null&&a.user?(s(a.user),t(a.user.id)):s(null)});return()=>r.unsubscribe()},[]),e.jsx(rl,{children:e.jsxs(nl,{children:[e.jsx(V,{path:"/login",element:e.jsx(_c,{})}),e.jsx(V,{path:"/auth/google/callback",element:e.jsx(ch,{})}),e.jsxs(V,{path:"/",element:e.jsx(Da,{children:e.jsx(oh,{})}),children:[e.jsx(V,{index:!0,element:e.jsx(As,{to:"/dashboard"})}),e.jsx(V,{path:"dashboard",element:e.jsx(Td,{})}),e.jsx(V,{path:"profile",element:e.jsx(Md,{})}),e.jsx(V,{path:"directory",element:e.jsx($d,{})}),e.jsx(V,{path:"messages",element:e.jsx(mm,{})}),e.jsx(V,{path:"community",element:e.jsx(om,{})}),e.jsx(V,{path:"community/:slug",element:e.jsx(lm,{})}),e.jsx(V,{path:"community/post/:id",element:e.jsx(cm,{})}),e.jsx(V,{path:"community/new-post",element:e.jsx(dm,{})}),e.jsx(V,{path:"idea-hub",element:e.jsx(Jd,{})}),e.jsx(V,{path:"idea-hub/ai-discussion",element:e.jsx(Xd,{})}),e.jsx(V,{path:"idea-hub/canvas",element:e.jsx(Yd,{})}),e.jsx(V,{path:"idea-hub/market-research",element:e.jsx(Kd,{})}),e.jsx(V,{path:"idea-hub/business-model",element:e.jsx(Qd,{})}),e.jsx(V,{path:"idea-hub/pitch-deck",element:e.jsx(em,{})}),e.jsx(V,{path:"idea-hub/resources",element:e.jsx(tm,{})}),e.jsx(V,{path:"idea-hub/cofounder-bot",element:e.jsx(nm,{})}),e.jsx(V,{path:"idea-hub/flow",element:e.jsx(am,{})}),e.jsx(V,{path:"tasks/new",element:e.jsx(Ta,{})}),e.jsx(V,{path:"tasks/new/company",element:e.jsx(Ta,{isCompanyView:!0})}),e.jsxs(V,{path:"company",children:[e.jsx(V,{path:"setup",element:e.jsx(qd,{})}),e.jsx(V,{path:"dashboard",element:e.jsx(zd,{})}),e.jsx(V,{path:"settings",element:e.jsx(Vd,{})})]}),e.jsx(V,{path:"admin",element:e.jsx(Da,{adminOnly:!0,children:e.jsx(Bd,{})})})]})]})})}Ga(document.getElementById("root")).render(e.jsx(h.StrictMode,{children:e.jsx(dh,{})}));
